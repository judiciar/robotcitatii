<Activity mc:Ignorable="sap sap2010" x:Class="Main" mva:VisualBasic.Settings="{x:Null}" sap:VirtualizedContainerService.HintSize="220,283" sap2010:WorkflowViewState.IdRef="Main_1" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Diagnostics;assembly=System" xmlns:sd1="clr-namespace:System.Data;assembly=System.Data" xmlns:si="clr-namespace:System.IO;assembly=mscorlib" xmlns:snm="clr-namespace:System.Net.Mail;assembly=System" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="28">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Security</x:String>
      <x:String>UiPath.Database</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>System.Net</x:String>
      <x:String>System.Text.RegularExpressions</x:String>
      <x:String>System.Net.NetworkInformation</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="27">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>UiPath.IntelligentOCR</AssemblyReference>
      <AssemblyReference>Microsoft.VisualStudio.Services.Common</AssemblyReference>
      <AssemblyReference>UiPath.Database</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
      <AssemblyReference>UiPath.Studio.Plugin.Workflow</AssemblyReference>
      <AssemblyReference>System.Collections.Immutable</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.PDF</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <sap:WorkflowViewStateService.ViewState>
    <scg:Dictionary x:TypeArguments="x:String, x:Object">
      <x:Boolean x:Key="ShouldCollapseAll">True</x:Boolean>
    </scg:Dictionary>
  </sap:WorkflowViewStateService.ViewState>
  <Flowchart sap2010:Annotation.AnnotationText="RobotCitatii - robot urcare dovezi de citare si comunicare (denumite in continuare citatii) in Ecris. Activitatile sau secventele sunt comentate, de regula, numai la prima lor aparitie dupa Start." DisplayName="Main Flowchart" sap:VirtualizedContainerService.HintSize="634,728" sap2010:WorkflowViewState.IdRef="Flowchart_1">
    <Flowchart.Variables>
      <Variable x:TypeArguments="x:String" Name="NrDosar" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, x:String)[]" Name="ConfigInstante" />
      <Variable x:TypeArguments="sd1:DataTable" Name="TabeldinDB" />
      <Variable x:TypeArguments="x:String" Name="NumeFisierPDF" />
      <Variable x:TypeArguments="x:String" Name="idDosar" />
      <Variable x:TypeArguments="x:String" Name="idDocument" />
      <Variable x:TypeArguments="s:String[]" Name="filesList" />
      <Variable x:TypeArguments="scg:Dictionary(x:String, x:String)" Name="ConfigGenerale" />
    </Flowchart.Variables>
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
        <av:Size x:Key="ShapeSize">60,75</av:Size>
        <av:PointCollection x:Key="ConnectorLocation">330,40 451,40 451,145.04</av:PointCollection>
        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
        <x:Double x:Key="Height">650.04</x:Double>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <Flowchart.StartNode>
      <x:Reference>__ReferenceID63</x:Reference>
    </Flowchart.StartNode>
    <FlowStep x:Name="__ReferenceID60" sap2010:WorkflowViewState.IdRef="FlowStep_1132">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">351,346.04</av:Point>
          <av:Size x:Key="ShapeSize">200,93</av:Size>
          <av:PointCollection x:Key="ConnectorLocation">451,439.04 451,548.5 390,548.5</av:PointCollection>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <ui:ForEach x:TypeArguments="scg:Dictionary(x:String, x:String)" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Urca fisierele in Ecris pentru fiecare instanta la rand" DisplayName="For Each instanta" sap:VirtualizedContainerService.HintSize="200,93" sap2010:WorkflowViewState.IdRef="ForEach`1_97" Values="[ConfigInstante]">
        <ui:ForEach.Body>
          <ActivityAction x:TypeArguments="scg:Dictionary(x:String, x:String)">
            <ActivityAction.Argument>
              <DelegateInArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" Name="instanta" />
            </ActivityAction.Argument>
            <Flowchart DisplayName="Proceseaza instanta" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Flowchart_76">
              <Flowchart.Variables>
                <Variable x:TypeArguments="x:Boolean" Name="fileLocked" />
                <Variable x:TypeArguments="x:String" Name="FisierTxtcaSir" />
                <Variable x:TypeArguments="x:String" Name="NrDosar3" />
                <Variable x:TypeArguments="x:String" Name="NrDosar1" />
                <Variable x:TypeArguments="x:String" Name="NrDosar2" />
                <Variable x:TypeArguments="ui:GenericValue" Name="pozsfarsit" />
                <Variable x:TypeArguments="ui:GenericValue" Name="pozinceput" />
                <Variable x:TypeArguments="si:FileStream" Name="fs" />
                <Variable x:TypeArguments="x:String" Name="fisierEroare" />
                <Variable x:TypeArguments="x:String" Name="httpmessage" />
                <Variable x:TypeArguments="x:Int32" Name="contor" />
              </Flowchart.Variables>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <av:Point x:Key="ShapeLocation">260,2.5</av:Point>
                  <av:Size x:Key="ShapeSize">60,75</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">290,77.5 290,107.5 292,107.5 292,124.5</av:PointCollection>
                  <x:Double x:Key="Height">662.04</x:Double>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <Flowchart.StartNode>
                <x:Reference>__ReferenceID59</x:Reference>
              </Flowchart.StartNode>
              <FlowStep x:Name="__ReferenceID59">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <av:Point x:Key="ShapeLocation">192,124.5</av:Point>
                    <av:Size x:Key="ShapeSize">200,198</av:Size>
                    <av:PointCollection x:Key="ConnectorLocation">292,322.5 292,364.5</av:PointCollection>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <If sap2010:Annotation.AnnotationText="Daca instanta a dat eroare, robotul sare instanta timp de 5 minute, pentru a-i da posibilitatea sa revina online si a evita intarzierile provocate de timeout-uri. Pentru a tine minte eroarea, in variabila instanta(&quot;Offline&quot;) se scrie data si ora erorii" Condition="[instanta(&quot;Offline&quot;).StartsWith(&quot;da&quot;) AND (DateTime.Now - Convert.ToDateTime(instanta(&quot;Offline&quot;).Split(&quot;=&quot;c)(1))).TotalMinutes &lt;= 5]" DisplayName="Sari 5' daca instanta e offline" sap:VirtualizedContainerService.HintSize="200,198" sap2010:WorkflowViewState.IdRef="If_777">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <If.Then>
                    <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_1" />
                  </If.Then>
                </If>
                <FlowStep.Next>
                  <FlowStep x:Name="__ReferenceID58">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <av:Point x:Key="ShapeLocation">192,364.5</av:Point>
                        <av:Size x:Key="ShapeSize">200,123</av:Size>
                        <av:PointCollection x:Key="ConnectorLocation">292,487.5 292,534.5</av:PointCollection>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <TryCatch sap2010:Annotation.AnnotationText="Imparte fisierul PDF ce contine teancul de citatii scanate in fisiere individuale cu cate o citatie fiecare" DisplayName="Split fisier PDF cu citatii" sap:VirtualizedContainerService.HintSize="438,335" sap2010:WorkflowViewState.IdRef="TryCatch_448">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <TryCatch.Try>
                        <Sequence DisplayName="Split fisier PDF cu citatii" sap:VirtualizedContainerService.HintSize="382,2076" sap2010:WorkflowViewState.IdRef="Sequence_2401">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Assign sap2010:Annotation.AnnotationText="Reseteaza variabila pentru a fi folosita in loguri si emailuri daca la prelucrarea fisierului curent apare o eroare." sap:VirtualizedContainerService.HintSize="340,117" sap2010:WorkflowViewState.IdRef="Assign_1684">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[fisierEroare]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">
                                <Literal x:TypeArguments="x:String" Value="" />
                              </InArgument>
                            </Assign.Value>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </Assign>
                          <Assign DisplayName="Initializare" sap:VirtualizedContainerService.HintSize="340,60" sap2010:WorkflowViewState.IdRef="Assign_1685">
                            <Assign.To>
                              <OutArgument x:TypeArguments="s:String[]">[filesList]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="s:String[]">[new string(){}]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <Assign sap2010:Annotation.AnnotationText="Listeaza intr-un vector (array) continutul (fisierele) directorului FolderPDFscanate, unde sunt scanate teancurile de citatii sosite la instanta" sap:VirtualizedContainerService.HintSize="340,132" sap2010:WorkflowViewState.IdRef="Assign_1686">
                            <Assign.To>
                              <OutArgument x:TypeArguments="s:String[]">[filesList]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="s:String[]">[Directory.GetFiles(instanta("FolderPDFscanate"), "*.pdf")]</InArgument>
                            </Assign.Value>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </Assign>
                          <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For each" sap:VirtualizedContainerService.HintSize="340,1555" sap2010:WorkflowViewState.IdRef="ForEach`1_125" Values="[filesList]">
                            <ui:ForEach.Body>
                              <ActivityAction x:TypeArguments="x:String">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="x:String" Name="file" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="304,1421" sap2010:WorkflowViewState.IdRef="Sequence_2400">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1687">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:String">[fisierEroare]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:String">[file]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1833">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:Int32">[contor]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                  <Sequence DisplayName="Verifica ca PDF-ul e inchis de scanner" sap:VirtualizedContainerService.HintSize="242,1306" sap2010:WorkflowViewState.IdRef="Sequence_2391">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If sap2010:Annotation.AnnotationText="RTIV de la Panasonic nu tine un handle deschis pe fisierul PDF si atunci este posibil ca robotul sa il urce in Ecris inainte ca grefierul sa fi terminat de scanat. De aceea, robotul ia in analiza un fisier dupa un anumit numar de secunde (stabilit pentru fiecare instanta) de la ultima scriere in el (DateModified), presupunand ca grefierul a terminat scanarea in acest timp" Condition="[(DateTime.Now - new System.IO.FileInfo(file).LastWriteTime).TotalSeconds &lt;= Convert.ToInt32(instanta(&quot;TimpAsteptareDoc&quot;))]" DisplayName="Verifica ca PDF-ul e mai vechi de x secunde" sap:VirtualizedContainerService.HintSize="200,273" sap2010:WorkflowViewState.IdRef="If_778">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_2" />
                                      </If.Then>
                                    </If>
                                    <TryCatch sap2010:Annotation.AnnotationText="Fisierul PDF poate fi deschis de alt program decat RTIV, program care tine handle deschis pe fisier (ex. Acrobat Reader). Robotul incearca sa deschida fisierul si, daca fisierul este deschis de alt program, OS va da eroare. Robotul va captura eroarea si va sari peste fisier, asteptand o deblocare ulterioara " DisplayName="Verifica daca PDF-ul e deschis de alt program" sap:VirtualizedContainerService.HintSize="200,228" sap2010:WorkflowViewState.IdRef="TryCatch_442">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <TryCatch.Try>
                                        <Sequence DisplayName="Verifica daca PDF-ul poate fi accesat" sap:VirtualizedContainerService.HintSize="304,324" sap2010:WorkflowViewState.IdRef="Sequence_2390">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Assign DisplayName="Create FileStream" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1688">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="si:FileStream">[fs]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="si:FileStream">[System.IO.File.Open(file, FileMode.Open, FileAccess.Read, FileShare.None)]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <InvokeMethod DisplayName="Invoke method" sap:VirtualizedContainerService.HintSize="262,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_80" MethodName="Close">
                                            <InvokeMethod.TargetObject>
                                              <InArgument x:TypeArguments="si:FileStream">[fs]</InArgument>
                                            </InvokeMethod.TargetObject>
                                          </InvokeMethod>
                                        </Sequence>
                                      </TryCatch.Try>
                                      <TryCatch.Catches>
                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_452">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ActivityAction x:TypeArguments="s:Exception">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                            </ActivityAction.Argument>
                                            <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_3" />
                                          </ActivityAction>
                                        </Catch>
                                      </TryCatch.Catches>
                                    </TryCatch>
                                    <If sap2010:Annotation.AnnotationText="Daca este activata optiunea, robotul intreaba prin HTTP serverul cu reteaua neur(on)ala CitNet daca fisierul este citatie sau document.&#xA;Pentru instantele la care arhiva scaneaza documentele si citatiile in acelasi folder, robotul face diferenta intre cele 2 categorii dupa cum numele fiserului respecta un pattern (RegEx) de tipul (1+cifre)-(1+cifre)-(1+cifre). In loc de -, se poate scrie _. Atentie, unele instante salveaza fisierele citatii sub forma 11-10-2019.pdf si atunci robotul foloseste regex lookahead pentru a evita sa le considere documente. Practica trebuie eliminata in randul grefierilor, deoarece poate da erori (de ex. la dosarele de la instantele cu indicativul 10, 11 sau 12).&#xA;Daca fisierul are regex de document, robotul il ignora. Daca nu are regex de document, atunci robotul procedeaza diferit in functie de raspunsul CitNet. Daca fisierul este citatie atunci il prelucreaza (splitare), iar daca este document inseamna ca este vorba de o eroare a angajatilor care au scris gresit numele fisierului, iar fisierul este mutat in FolderErori." Condition="[ConfigGenerale(&quot;FolosesteReteaneurala&quot;) = &quot;da&quot;]" DisplayName="Reteaua neurala CitNet" sap:VirtualizedContainerService.HintSize="671,1180" sap2010:WorkflowViewState.IdRef="If_872">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <Sequence DisplayName="Reteaua neurala CitNet" sap:VirtualizedContainerService.HintSize="526,855" sap2010:WorkflowViewState.IdRef="Sequence_2531">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Assign sap:VirtualizedContainerService.HintSize="484,60" sap2010:WorkflowViewState.IdRef="Assign_1826">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[httpmessage]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">[file]</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                          <ui:HttpClient Body="{x:Null}" ConsumerKey="{x:Null}" ConsumerSecret="{x:Null}" OAuth1Token="{x:Null}" OAuth1TokenSecret="{x:Null}" OAuth2Token="{x:Null}" Password="{x:Null}" ResourcePath="{x:Null}" ResponseHeaders="{x:Null}" StatusCode="{x:Null}" Username="{x:Null}" AcceptFormat="ANY" BodyFormat="application/xml" ClientCertificate="[Nothing]" ClientCertificatePassword="[Nothing]" ContinueOnError="True" DisplayName="Verifica cu CitNet prin HTTP Request" EndPoint="[&quot;http://&quot;+ConfigGenerale(&quot;IPreteaneurala&quot;)+&quot;:&quot;+ConfigGenerale(&quot;Portreteaneurala&quot;)+&quot;/query&quot;]" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="HttpClient_4" Method="GET" Result="[httpmessage]" TimeoutMS="20000">
                                            <ui:HttpClient.Attachments>
                                              <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                            </ui:HttpClient.Attachments>
                                            <ui:HttpClient.Cookies>
                                              <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                            </ui:HttpClient.Cookies>
                                            <ui:HttpClient.Headers>
                                              <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                            </ui:HttpClient.Headers>
                                            <ui:HttpClient.Parameters>
                                              <InArgument x:TypeArguments="x:String" x:Key="robot">[ConfigGenerale("IDptreteaneurala")]</InArgument>
                                              <InArgument x:TypeArguments="x:String" x:Key="idinstanta">[instanta("id")]</InArgument>
                                              <InArgument x:TypeArguments="x:String" x:Key="pathfile">[httpmessage]</InArgument>
                                            </ui:HttpClient.Parameters>
                                            <ui:HttpClient.UrlSegments>
                                              <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                            </ui:HttpClient.UrlSegments>
                                          </ui:HttpClient>
                                          <If Condition="[System.Text.RegularExpressions.Regex.Match(file.Replace(&quot; &quot;, &quot;&quot;), &quot;\d+(-|_)(?!1([0-2])-)[1-9]\d*(-|_).+&quot;).Success Or (httpmessage &lt;&gt; &quot;documente&quot; And httpmessage &lt;&gt; &quot;citatii&quot;)]" DisplayName="Reteaua neurala CitNet - verifica daca e document cu numar dosar" sap:VirtualizedContainerService.HintSize="484,208" sap2010:WorkflowViewState.IdRef="If_859">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_18" />
                                            </If.Then>
                                          </If>
                                          <If Condition="[httpmessage = &quot;documente&quot; And Not System.Text.RegularExpressions.Regex.Match(file.Replace(&quot; &quot;, &quot;&quot;), &quot;\d+(-|_)(?!1([0-2])-)[1-9]\d*(-|_).+&quot;).Success And Not Path.GetFileName(file).StartsWith(&quot;cit&quot;) And Not Path.GetFileName(file).StartsWith(&quot;doc&quot;)]" DisplayName="Verifica daca PDF-ul e document fara numar dosar" sap:VirtualizedContainerService.HintSize="484,353" sap2010:WorkflowViewState.IdRef="If_856">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <Sequence sap:VirtualizedContainerService.HintSize="242,205" sap2010:WorkflowViewState.IdRef="Sequence_2547">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If Condition="[System.IO.File.Exists(instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileName(file))]" DisplayName="Move PDF to Erori" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_861">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(file)+&quot;_mutat_ora_&quot;+DateTime.Now.ToString(&quot;HH-mm&quot;)+Path.GetExtension(file)]" DisplayName="Move PDF to Erori redenumit" sap:VirtualizedContainerService.HintSize="384,157" sap2010:WorkflowViewState.IdRef="MoveFile_140" Overwrite="True" Path="[file]" />
                                                  </If.Then>
                                                  <If.Else>
                                                    <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileName(file)]" DisplayName="Move PDF to Erori" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="MoveFile_141" Overwrite="True" Path="[file]" />
                                                  </If.Else>
                                                </If>
                                                <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_19" />
                                              </Sequence>
                                            </If.Then>
                                          </If>
                                        </Sequence>
                                      </If.Then>
                                    </If>
                                  </Sequence>
                                  <ui:StartProcess WorkingDirectory="{x:Null}" sap2010:Annotation.AnnotationText="Fisierele din FolderPDFscanate sunt impartite in citatii individuale (de cate 2 pagini) cu ajutorul aplicatiei cpdf.exe. Pentru a evita suprascrieri, se adauga o terminatie aleatorie de 3 caractere si apoi 5 cifre corespunzatoare numarului de ordine al fisierului rezultat (numefisierinitial_wqx_00003.pdf)." Arguments="[&quot; -split &quot;&quot;&quot;+file+&quot;&quot;&quot; 1 -chunk 2 -o &quot;&quot;&quot;+instanta(&quot;FolderPentruOCR&quot;)+&quot;\@F_&quot;+Left(Path.GetRandomFileName(),3)+&quot;_%%%%%.pdf&quot;&quot;&quot;]" DisplayName="Split PDF cu aplicatia &quot;cpdf&quot;" FileName="[ConfigGenerale(&quot;CaleCPDF&quot;)]" sap:VirtualizedContainerService.HintSize="262,243" sap2010:WorkflowViewState.IdRef="StartProcess_1">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:StartProcess>
                                  <ui:ForEach x:TypeArguments="sd:Process" CurrentIndex="{x:Null}" DisplayName="Asteapta inchidere &quot;cpdf&quot;" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="ForEach`1_124" Values="[System.Diagnostics.Process.GetProcessesByName(&quot;cpdf&quot;)]">
                                    <ui:ForEach.Body>
                                      <ActivityAction x:TypeArguments="sd:Process">
                                        <ActivityAction.Argument>
                                          <DelegateInArgument x:TypeArguments="sd:Process" Name="process" />
                                        </ActivityAction.Argument>
                                        <InvokeMethod DisplayName="Invoke Method" sap:VirtualizedContainerService.HintSize="238,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_81" MethodName="WaitForExit">
                                          <InvokeMethod.TargetObject>
                                            <InArgument x:TypeArguments="sd:Process">[process]</InArgument>
                                          </InvokeMethod.TargetObject>
                                        </InvokeMethod>
                                      </ActivityAction>
                                    </ui:ForEach.Body>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:ForEach>
                                  <Sequence sap2010:Annotation.AnnotationText="Verifica daca fisierul nu a ramas blocat de cpdf sau deschis de alt program. Robotul incearca sa il acceseze si captureaza eventualele erori. Pentru a evita bucle infinite, dupa 100 accesari (aprox. 100 sec), trece mai departe" DisplayName="Do While - Verifica ca documentul este inchis" sap:VirtualizedContainerService.HintSize="262,213" sap2010:WorkflowViewState.IdRef="Sequence_2553">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1844">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:Int32">[contor]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <DoWhile DisplayName="Do While - Verifica ca documentul este inchis" sap:VirtualizedContainerService.HintSize="484,222" sap2010:WorkflowViewState.IdRef="DoWhile_5">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <DoWhile.Condition>[fileLocked = True And contor &lt; 100]</DoWhile.Condition>
                                      <TryCatch DisplayName="Verifica daca documentul e deschis de alt program" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_477">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <TryCatch.Try>
                                          <Sequence DisplayName="Verifica daca documentul poate fi accesat" sap:VirtualizedContainerService.HintSize="304,524" sap2010:WorkflowViewState.IdRef="Sequence_2551">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1845">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:Boolean">[fileLocked]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1846">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:Int32">[contor]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:Int32">[contor + 1]</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                            <Assign DisplayName="Create FileStream" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1847">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="si:FileStream">[fs]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="si:FileStream">[System.IO.File.Open(file, FileMode.Open, FileAccess.Read, FileShare.None)]</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                            <InvokeMethod DisplayName="Invoke method" sap:VirtualizedContainerService.HintSize="262,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_87" MethodName="Close">
                                              <InvokeMethod.TargetObject>
                                                <InArgument x:TypeArguments="si:FileStream">[fs]</InArgument>
                                              </InvokeMethod.TargetObject>
                                            </InvokeMethod>
                                          </Sequence>
                                        </TryCatch.Try>
                                        <TryCatch.Catches>
                                          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_487">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ActivityAction x:TypeArguments="s:Exception">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Daca e folosit de alt proces" sap:VirtualizedContainerService.HintSize="526,359" sap2010:WorkflowViewState.IdRef="Sequence_2552">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If Condition="[exception.Message.Contains(&quot;being used by another process&quot;)]" DisplayName="Daca e folosit de alt proces" sap:VirtualizedContainerService.HintSize="484,208" sap2010:WorkflowViewState.IdRef="If_871">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1848">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:Boolean">[fileLocked]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                  </If.Then>
                                                </If>
                                                <Delay Duration="00:00:01" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="Delay_78" />
                                              </Sequence>
                                            </ActivityAction>
                                          </Catch>
                                        </TryCatch.Catches>
                                      </TryCatch>
                                    </DoWhile>
                                  </Sequence>
                                  <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_483">
                                    <TryCatch.Try>
                                      <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_53" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '', '', '', 12, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                        <ui:ExecuteNonQuery.Parameters>
                                          <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                        </ui:ExecuteNonQuery.Parameters>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:ExecuteNonQuery>
                                    </TryCatch.Try>
                                    <TryCatch.Catches>
                                      <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_493">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ActivityAction x:TypeArguments="s:Exception">
                                          <ActivityAction.Argument>
                                            <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                          </ActivityAction.Argument>
                                        </ActivityAction>
                                      </Catch>
                                    </TryCatch.Catches>
                                  </TryCatch>
                                  <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="AppendLine_305" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ file + &quot; - splitat in PDF-uri cu citatii individuale cu ajutorul aplicatiei cpdf&quot;]">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:AppendLine>
                                  <TryCatch sap2010:Annotation.AnnotationText="Face refresh la pagina Chrome cu jurnalul pentru a se vedea pe ecran ultima intrare introdusa" DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="262,123" sap2010:WorkflowViewState.IdRef="TryCatch_443">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <TryCatch.Try>
                                      <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_448" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                        <ui:BrowserScope.Body>
                                          <ActivityAction x:TypeArguments="x:Object">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                            </ActivityAction.Argument>
                                            <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2394">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_102" />
                                              <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1057" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                <ui:TypeInto.Target>
                                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                </ui:TypeInto.Target>
                                              </ui:TypeInto>
                                            </Sequence>
                                          </ActivityAction>
                                        </ui:BrowserScope.Body>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:BrowserScope>
                                    </TryCatch.Try>
                                    <TryCatch.Catches>
                                      <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_453">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ActivityAction x:TypeArguments="s:Exception">
                                          <ActivityAction.Argument>
                                            <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                          </ActivityAction.Argument>
                                          <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_429" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                            <ui:OpenBrowser.Body>
                                              <ActivityAction x:TypeArguments="x:Object">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                </ActivityAction.Argument>
                                                <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2395">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1058" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                    <ui:TypeInto.Target>
                                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                    </ui:TypeInto.Target>
                                                  </ui:TypeInto>
                                                </Sequence>
                                              </ActivityAction>
                                            </ui:OpenBrowser.Body>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:OpenBrowser>
                                        </ActivityAction>
                                      </Catch>
                                    </TryCatch.Catches>
                                  </TryCatch>
                                  <TryCatch DisplayName="Move file PDF to Prelucrate" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_474">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <TryCatch.Try>
                                      <Sequence DisplayName="Move file PDF to Prelucrate" sap:VirtualizedContainerService.HintSize="242,518" sap2010:WorkflowViewState.IdRef="Sequence_2535">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If sap2010:Annotation.AnnotationText="Muta fisierul in FolderPrelucrate, redenumit cu _mutat_ora_hh_mm, daca exista deja un fisier cu acelasi nume, pentru a evita suprascrierea" Condition="[System.IO.File.Exists(instanta(&quot;FolderPrelucrate&quot;)+&quot;\&quot;+Path.GetFileName(file))]" DisplayName="Move file PDF to Prelucrate" sap:VirtualizedContainerService.HintSize="200,153" sap2010:WorkflowViewState.IdRef="If_780">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Then>
                                            <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderPrelucrate&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(file)+&quot;_mutat_ora_&quot;+DateTime.Now.ToString(&quot;HH-mm&quot;)+Path.GetExtension(file)]" DisplayName="Move PDF to Prelucrate redenumit" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_116" Overwrite="True" Path="[file]" />
                                          </If.Then>
                                          <If.Else>
                                            <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderPrelucrate&quot;)]" DisplayName="Move PDF to Prelucrate" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_117" Overwrite="True" Path="[file]" />
                                          </If.Else>
                                        </If>
                                        <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="434,266" sap2010:WorkflowViewState.IdRef="TryCatch_484">
                                          <TryCatch.Try>
                                            <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_54" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '', '', '', 17, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                              <ui:ExecuteNonQuery.Parameters>
                                                <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                              </ui:ExecuteNonQuery.Parameters>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:ExecuteNonQuery>
                                          </TryCatch.Try>
                                          <TryCatch.Catches>
                                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_494">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ActivityAction x:TypeArguments="s:Exception">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                </ActivityAction.Argument>
                                              </ActivityAction>
                                            </Catch>
                                          </TryCatch.Catches>
                                        </TryCatch>
                                        <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_306" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ file + &quot; - mutat in &quot; + instanta(&quot;FolderPrelucrate&quot;)]">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:AppendLine>
                                        <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_445">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <TryCatch.Try>
                                            <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_449" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                              <ui:BrowserScope.Body>
                                                <ActivityAction x:TypeArguments="x:Object">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                  </ActivityAction.Argument>
                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2398">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_103" />
                                                    <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1059" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                      <ui:TypeInto.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                      </ui:TypeInto.Target>
                                                    </ui:TypeInto>
                                                  </Sequence>
                                                </ActivityAction>
                                              </ui:BrowserScope.Body>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:BrowserScope>
                                          </TryCatch.Try>
                                          <TryCatch.Catches>
                                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_455">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ActivityAction x:TypeArguments="s:Exception">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                </ActivityAction.Argument>
                                                <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_430" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                  <ui:OpenBrowser.Body>
                                                    <ActivityAction x:TypeArguments="x:Object">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                      </ActivityAction.Argument>
                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2399">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1060" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                          <ui:TypeInto.Target>
                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                          </ui:TypeInto.Target>
                                                        </ui:TypeInto>
                                                      </Sequence>
                                                    </ActivityAction>
                                                  </ui:OpenBrowser.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:OpenBrowser>
                                              </ActivityAction>
                                            </Catch>
                                          </TryCatch.Catches>
                                        </TryCatch>
                                      </Sequence>
                                    </TryCatch.Try>
                                    <TryCatch.Catches>
                                      <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="530,21" sap2010:WorkflowViewState.IdRef="Catch`1_484">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ActivityAction x:TypeArguments="s:Exception">
                                          <ActivityAction.Argument>
                                            <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                          </ActivityAction.Argument>
                                          <Sequence DisplayName="Noteaza eroarea" sap:VirtualizedContainerService.HintSize="242,325" sap2010:WorkflowViewState.IdRef="Sequence_2542">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_329" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot; +fisierEroare+&quot; - Eroare in procedura Splitare PDF. Exception message: &quot;+exception.Message+&quot; at Source: &quot;+exception.Source]">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:AppendLine>
                                            <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_475">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <TryCatch.Try>
                                                <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_474" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                  <ui:BrowserScope.Body>
                                                    <ActivityAction x:TypeArguments="x:Object">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                      </ActivityAction.Argument>
                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2540">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_121" />
                                                        <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1113" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                          <ui:TypeInto.Target>
                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                          </ui:TypeInto.Target>
                                                        </ui:TypeInto>
                                                      </Sequence>
                                                    </ActivityAction>
                                                  </ui:BrowserScope.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:BrowserScope>
                                              </TryCatch.Try>
                                              <TryCatch.Catches>
                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_485">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                    </ActivityAction.Argument>
                                                    <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_453" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                      <ui:OpenBrowser.Body>
                                                        <ActivityAction x:TypeArguments="x:Object">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2541">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1114" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                              <ui:TypeInto.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                              </ui:TypeInto.Target>
                                                            </ui:TypeInto>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:OpenBrowser.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:OpenBrowser>
                                                  </ActivityAction>
                                                </Catch>
                                              </TryCatch.Catches>
                                            </TryCatch>
                                            <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_76" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+fisierEroare.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '', '', '', 15, 'Eroare in procedura Splitare PDF. Exception message: &quot;+exception.Message.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot; at Source: &quot;+exception.Source.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                              <ui:ExecuteNonQuery.Parameters>
                                                <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                              </ui:ExecuteNonQuery.Parameters>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:ExecuteNonQuery>
                                          </Sequence>
                                        </ActivityAction>
                                      </Catch>
                                    </TryCatch.Catches>
                                  </TryCatch>
                                </Sequence>
                              </ActivityAction>
                            </ui:ForEach.Body>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:ForEach>
                        </Sequence>
                      </TryCatch.Try>
                      <TryCatch.Catches>
                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_458">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ActivityAction x:TypeArguments="s:Exception">
                            <ActivityAction.Argument>
                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                            </ActivityAction.Argument>
                            <Sequence DisplayName="Logheaza eroarea" sap:VirtualizedContainerService.HintSize="304,402" sap2010:WorkflowViewState.IdRef="Sequence_2406">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <If sap2010:Annotation.AnnotationText="Robotul noteaza eroarea in log si trimite email cu eroarea numai daca au trecut cel putin 12 ore de la ultimul email trimis, pentru a nu deranja" Condition="[instanta(&quot;Offline&quot;).StartsWith(&quot;nu&quot;) OR (instanta(&quot;Offline&quot;).StartsWith(&quot;da&quot;) AND (DateTime.Now - Convert.ToDateTime(instanta(&quot;OraUltimulEmail&quot;))).TotalHours &gt;= 12)]" DisplayName="Noteaza eroarea o data la x ore" sap:VirtualizedContainerService.HintSize="484,256" sap2010:WorkflowViewState.IdRef="If_782">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <If.Then>
                                  <Sequence sap:VirtualizedContainerService.HintSize="304,630" sap2010:WorkflowViewState.IdRef="Sequence_2405">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="AppendLine_307" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot; +fisierEroare+&quot; - Eroare in procedura Splitare PDF. Exception message: &quot;+exception.Message+&quot; at Source: &quot;+exception.Source]">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </ui:AppendLine>
                                    <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_446">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <TryCatch.Try>
                                        <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_450" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                          <ui:BrowserScope.Body>
                                            <ActivityAction x:TypeArguments="x:Object">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2402">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_104" />
                                                <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1061" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                  <ui:TypeInto.Target>
                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                  </ui:TypeInto.Target>
                                                </ui:TypeInto>
                                              </Sequence>
                                            </ActivityAction>
                                          </ui:BrowserScope.Body>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:BrowserScope>
                                      </TryCatch.Try>
                                      <TryCatch.Catches>
                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_456">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ActivityAction x:TypeArguments="s:Exception">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                            </ActivityAction.Argument>
                                            <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_431" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                              <ui:OpenBrowser.Body>
                                                <ActivityAction x:TypeArguments="x:Object">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                  </ActivityAction.Argument>
                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2403">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1062" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                      <ui:TypeInto.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                      </ui:TypeInto.Target>
                                                    </ui:TypeInto>
                                                  </Sequence>
                                                </ActivityAction>
                                              </ui:OpenBrowser.Body>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:OpenBrowser>
                                          </ActivityAction>
                                        </Catch>
                                      </TryCatch.Catches>
                                    </TryCatch>
                                    <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_485">
                                      <TryCatch.Try>
                                        <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_55" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+fisierEroare.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '', '', '', 15, 'Eroare in procedura Splitare PDF. Exception message: &quot;+exception.Message.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot; at Source: &quot;+exception.Source.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                          <ui:ExecuteNonQuery.Parameters>
                                            <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                          </ui:ExecuteNonQuery.Parameters>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ExecuteNonQuery>
                                      </TryCatch.Try>
                                      <TryCatch.Catches>
                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_495">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ActivityAction x:TypeArguments="s:Exception">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                            </ActivityAction.Argument>
                                          </ActivityAction>
                                        </Catch>
                                      </TryCatch.Catches>
                                    </TryCatch>
                                    <If sap2010:Annotation.AnnotationText="Robotul trimite email cu eroarea administratorului numai in intervalul L-V 7:30-16" Condition="[DateTime.Now.DayOfWeek = DayOfWeek.Saturday OR DateTime.Now.DayOfWeek = DayOfWeek.Sunday OR DateTime.Now.TimeOfDay &lt; New TimeSpan(7, 30, 0) OR DateTime.Now.TimeOfDay &gt; New TimeSpan(16, 0, 0)]" DisplayName="Trimite email cu eroarea in zilele lucratoare" sap:VirtualizedContainerService.HintSize="262,123" sap2010:WorkflowViewState.IdRef="If_781">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Else>
                                        <TryCatch DisplayName="Trimite email cu eroarea" sap:VirtualizedContainerService.HintSize="434,297" sap2010:WorkflowViewState.IdRef="TryCatch_447">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <TryCatch.Try>
                                            <ui:SendMail Bcc="{x:Null}" Cc="{x:Null}" Email="{x:Null}" MailMessage="{x:Null}" Password="{x:Null}" sap2010:Annotation.AnnotationText="Trimite email cu detaliile exceptiei, inclusiv mesajul exceptiei" Body="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot;] Robot UiPath - Eroare in procedura Split fisier PDF cu citatii. Exception message: &quot;+exception.Message+&quot; at Source: &quot;+exception.Source]" DisplayName="Send SMTP Mail Message" EnableSSL="True" From="[instanta(&quot;EmailSenderRobot&quot;)]" sap:VirtualizedContainerService.HintSize="200,108" sap2010:WorkflowViewState.IdRef="SendMail_6" IsBodyHtml="False" Name="[instanta(&quot;EmailSenderRobot&quot;)]" Port="[cint(instanta(&quot;PortSmtp&quot;))]" SecureConnection="None" Server="[instanta(&quot;IPsmtp&quot;)]" Subject="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot;] Robotul UiPath a intalnit o eroare&quot;]" TimeoutMS="3000" To="[instanta(&quot;DestinatariEmailEroare&quot;)]">
                                              <ui:SendMail.Files>
                                                <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                                              </ui:SendMail.Files>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:SendMail>
                                          </TryCatch.Try>
                                          <TryCatch.Catches>
                                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,135" sap2010:WorkflowViewState.IdRef="Catch`1_457">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ActivityAction x:TypeArguments="s:Exception">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                </ActivityAction.Argument>
                                                <Sequence sap:VirtualizedContainerService.HintSize="242,234" sap2010:WorkflowViewState.IdRef="Sequence_2404">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_308" Text="Nu am putut trimite e-mail cu eroarea" />
                                                  <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="434,266" sap2010:WorkflowViewState.IdRef="TryCatch_486">
                                                    <TryCatch.Try>
                                                      <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_56" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '', '', '', '', 13, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                        <ui:ExecuteNonQuery.Parameters>
                                                          <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                        </ui:ExecuteNonQuery.Parameters>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:ExecuteNonQuery>
                                                    </TryCatch.Try>
                                                    <TryCatch.Catches>
                                                      <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_496">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ActivityAction x:TypeArguments="s:Exception">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                          </ActivityAction.Argument>
                                                        </ActivityAction>
                                                      </Catch>
                                                    </TryCatch.Catches>
                                                  </TryCatch>
                                                </Sequence>
                                              </ActivityAction>
                                            </Catch>
                                          </TryCatch.Catches>
                                        </TryCatch>
                                      </If.Else>
                                    </If>
                                    <Assign sap2010:Annotation.AnnotationText="Noteaza in dictionar data si ora ultimului email trimis pentru instanta respectiva" DisplayName="Marcheaza ora ultimului email" sap:VirtualizedContainerService.HintSize="262,102" sap2010:WorkflowViewState.IdRef="Assign_1694">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("OraUltimulEmail")]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString]</InArgument>
                                      </Assign.Value>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </Assign>
                                  </Sequence>
                                </If.Then>
                              </If>
                              <Assign sap2010:Annotation.AnnotationText="Pentru a sari 5 min instanta, in variabila instanta(&quot;Offline&quot;) se noteaza data si ora erorii" DisplayName="Marcheaza ora instanta offline" sap:VirtualizedContainerService.HintSize="262,117" sap2010:WorkflowViewState.IdRef="Assign_1695">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("Offline")]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">["da=" + DateTime.Now.ToString]</InArgument>
                                </Assign.Value>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </Assign>
                            </Sequence>
                          </ActivityAction>
                        </Catch>
                      </TryCatch.Catches>
                    </TryCatch>
                    <FlowStep.Next>
                      <FlowStep x:Name="__ReferenceID57">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <av:Point x:Key="ShapeLocation">192,534.5</av:Point>
                            <av:Size x:Key="ShapeSize">200,108</av:Size>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <TryCatch sap2010:Annotation.AnnotationText="Urca in Ecris citatiile individuale pentru instanta respectiva" DisplayName="Citatii in Ecris" sap:VirtualizedContainerService.HintSize="200,108" sap2010:WorkflowViewState.IdRef="TryCatch_470">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <TryCatch.Try>
                            <Sequence DisplayName="Citatii in Ecris" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2517">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign sap2010:Annotation.AnnotationText="Reseteaza variabila pentru a fi folosita in loguri si emailuri daca la prelucrarea fisierului curent apare o eroare." sap:VirtualizedContainerService.HintSize="340,117" sap2010:WorkflowViewState.IdRef="Assign_1696">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[fisierEroare]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <Literal x:TypeArguments="x:String" Value="" />
                                  </InArgument>
                                </Assign.Value>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </Assign>
                              <Assign DisplayName="Initializare" sap:VirtualizedContainerService.HintSize="340,60" sap2010:WorkflowViewState.IdRef="Assign_1697">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="s:String[]">[filesList]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="s:String[]">[new string(){}]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <Assign sap2010:Annotation.AnnotationText="Listeaza intr-un vector (array) 15 fisiere din directorul FolderTXT, ce contine rezultatul recunoasterii OCR a citatiilor individuale. Se iau numai 15 fisiere, pentru ca robotul sa nu stea prea mult la o singura instanta" sap:VirtualizedContainerService.HintSize="340,162" sap2010:WorkflowViewState.IdRef="Assign_1698">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="s:String[]">[filesList]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="s:String[]">[Directory.EnumerateFiles(instanta("FolderTXT"), "*.txt").Take(15).ToArray()]</InArgument>
                                </Assign.Value>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </Assign>
                              <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For each" sap:VirtualizedContainerService.HintSize="340,2846" sap2010:WorkflowViewState.IdRef="ForEach`1_130" Values="[filesList]">
                                <ui:ForEach.Body>
                                  <ActivityAction x:TypeArguments="x:String">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="x:String" Name="file" />
                                    </ActivityAction.Argument>
                                    <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="476,2712" sap2010:WorkflowViewState.IdRef="Sequence_2516">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If sap2010:Annotation.AnnotationText="Este posibil ca, cat timp robotul este ocupat cu alte fisiere, sa fie sters un fisier TXT care asteapta la rand. In acest caz, numele fisierului ramane in fileList si ar putea da eroare file not found." Condition="[System.IO.File.Exists(file)]" DisplayName="Verifica daca mai exista fisierul TXT" sap:VirtualizedContainerService.HintSize="434,168" sap2010:WorkflowViewState.IdRef="If_783">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Else>
                                          <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_4" />
                                        </If.Else>
                                      </If>
                                      <Assign sap2010:Annotation.AnnotationText="Identifica numele fisierului PDF din FolderPDFSplitate (citatia) care corespunde fisierului TXT curent" sap:VirtualizedContainerService.HintSize="434,117" sap2010:WorkflowViewState.IdRef="Assign_1699">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[NumeFisierPDF]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">[instanta("FolderPDFsplitate")+"\"+Path.GetFileNameWithoutExtension(file)+".pdf"]</InArgument>
                                        </Assign.Value>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </Assign>
                                      <Assign sap:VirtualizedContainerService.HintSize="434,60" sap2010:WorkflowViewState.IdRef="Assign_1700">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[fisierEroare]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">[NumeFisierPDF]</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                      <If sap2010:Annotation.AnnotationText="Este posibil ca, cat timp robotul este ocupat cu alte fisiere, sa fie sters un fisier PDF din FolderPDFsplitate (citatie) care asteapta la rand. In acest caz, accesarea fisierului PDF ar putea da eroare file not found." Condition="[System.IO.File.Exists(NumeFisierPDF)]" DisplayName="Verifica Exista Fisier PDF" sap:VirtualizedContainerService.HintSize="434,183" sap2010:WorkflowViewState.IdRef="If_785">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Else>
                                          <If sap2010:Annotation.AnnotationText="Daca nu reuseste sa gaseasca un NrDosar existent in Ecris, robotul muta fisierul pentru repetarea OCR de pana la 5 ori cu setari diferite. Pentru aceasta, robotul adauga la numele fisierului PDF terminatia _TRY2, _TRY3 s.a.m.d. pentru incercarile 2-5 , nume care este preluat automat si de fisierul TXT cu rezultatul OCR. Este posibil totusi ca, din cauza unor erori din ciclurile anterioare, fisierul TXT sa contina terminatia _TRYx, in timp ce fisierul PDF sa nu contina aceasta terminatie. De aceea, robotul verifica daca nu se afla in aceasta situatie. Daca nu este gasit niciun fisier PDF, fisierul TXT fara echivalent PDF este mutat in FolderErori." Condition="[System.IO.File.Exists(NumeFisierPDF.Split({&quot;_TRY&quot;}, StringSplitOptions.None)(0)+Path.GetExtension(NumeFisierPDF))]" sap:VirtualizedContainerService.HintSize="591,743" sap2010:WorkflowViewState.IdRef="If_784">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <Sequence DisplayName="Sequence" sap:VirtualizedContainerService.HintSize="304,252" sap2010:WorkflowViewState.IdRef="Sequence_2407">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1701">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[NumeFisierPDF]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[NumeFisierPDF.Split({"_TRY"}, StringSplitOptions.None)(0)+Path.GetExtension(NumeFisierPDF)]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1702">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[fisierEroare]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[NumeFisierPDF]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                            </If.Then>
                                            <If.Else>
                                              <Sequence sap:VirtualizedContainerService.HintSize="242,478" sap2010:WorkflowViewState.IdRef="Sequence_2410">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_309" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Nu am gasit fisierul PDF corespunzator cu numele &quot; + NumeFisierPDF + &quot; care contine citatia. EROARE&quot;]">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:AppendLine>
                                                <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_449">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <TryCatch.Try>
                                                    <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_451" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                      <ui:BrowserScope.Body>
                                                        <ActivityAction x:TypeArguments="x:Object">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2408">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_105" />
                                                            <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1063" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                              <ui:TypeInto.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                              </ui:TypeInto.Target>
                                                            </ui:TypeInto>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:BrowserScope.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:BrowserScope>
                                                  </TryCatch.Try>
                                                  <TryCatch.Catches>
                                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_459">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                        </ActivityAction.Argument>
                                                        <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_432" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                          <ui:OpenBrowser.Body>
                                                            <ActivityAction x:TypeArguments="x:Object">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                              </ActivityAction.Argument>
                                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2409">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1064" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                  <ui:TypeInto.Target>
                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                  </ui:TypeInto.Target>
                                                                </ui:TypeInto>
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </ui:OpenBrowser.Body>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:OpenBrowser>
                                                      </ActivityAction>
                                                    </Catch>
                                                  </TryCatch.Catches>
                                                </TryCatch>
                                                <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_487">
                                                  <TryCatch.Try>
                                                    <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_57" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+file.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '', '', '', 14, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                      <ui:ExecuteNonQuery.Parameters>
                                                        <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                      </ui:ExecuteNonQuery.Parameters>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:ExecuteNonQuery>
                                                  </TryCatch.Try>
                                                  <TryCatch.Catches>
                                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_497">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                        </ActivityAction.Argument>
                                                      </ActivityAction>
                                                    </Catch>
                                                  </TryCatch.Catches>
                                                </TryCatch>
                                                <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)]" DisplayName="Move file TXT to Erori" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="MoveFile_118" Overwrite="True" Path="[file]" />
                                                <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_5" />
                                              </Sequence>
                                            </If.Else>
                                          </If>
                                        </If.Else>
                                      </If>
                                      <Flowchart sap2010:Annotation.AnnotationText="Afla NrDosar - numarul de dosar al citatiei, care exista in Ecris-ul instantei" DisplayName="Cauta nr dosar pt citatie" sap:VirtualizedContainerService.HintSize="434,108" sap2010:WorkflowViewState.IdRef="Flowchart_77">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <av:Point x:Key="ShapeLocation">280,2.5</av:Point>
                                            <av:Size x:Key="ShapeSize">60,75</av:Size>
                                            <av:PointCollection x:Key="ConnectorLocation">310,77.5 310,117.5</av:PointCollection>
                                            <x:Double x:Key="Width">1046</x:Double>
                                            <x:Double x:Key="Height">2832</x:Double>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <Flowchart.StartNode>
                                          <x:Reference>__ReferenceID20</x:Reference>
                                        </Flowchart.StartNode>
                                        <FlowStep x:Name="__ReferenceID2">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <av:Point x:Key="ShapeLocation">179,660</av:Point>
                                              <av:Size x:Key="ShapeSize">262,117</av:Size>
                                              <av:PointCollection x:Key="ConnectorLocation">310,777 310,820</av:PointCollection>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Assign sap2010:Annotation.AnnotationText="Cauta pozitia in string-ul FisierTxtcaSir de dupa expresia &quot;sar nr.&quot; (din &quot;Dosar nr.&quot;), de aici incepand numarul dosarului" DisplayName="Cauta &quot;sar nr&quot; - Assign" sap:VirtualizedContainerService.HintSize="262,117" sap2010:WorkflowViewState.IdRef="Assign_1709">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="ui:GenericValue">[pozinceput]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="ui:GenericValue">[FisierTxtcaSir.IndexOf("sar nr")+7]</InArgument>
                                            </Assign.Value>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </Assign>
                                          <FlowStep.Next>
                                            <FlowStep x:Name="__ReferenceID1">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">210,820</av:Point>
                                                  <av:Size x:Key="ShapeSize">200,108</av:Size>
                                                  <av:PointCollection x:Key="ConnectorLocation">310,928 310,966.5</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Sequence sap2010:Annotation.AnnotationText="Cauta pozitia de sfarsit a numarului dosarului" DisplayName="Pozitie sfarsit" sap:VirtualizedContainerService.HintSize="200,108" sap2010:WorkflowViewState.IdRef="Sequence_2412">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If sap2010:Annotation.AnnotationText="Daca nu a gasit deloc expresia &quot;sar nr.&quot; (pozinceput este 6, adica -1 pentru ca nu a gasit nimic, la care se adauga 7, care este lungimea &quot;sar nr.&quot;), atunci face si pozitia sfarsit sa fie -1, pentru a iesi din procedura cu NrDosar = &quot;nuamgasit&quot;. In caz contrar, afla pozitia de sfarsit a numarului de dosar cu RegEx (se cauta alt caracter decat cifre, * sau /)" Condition="[pozinceput = 6 OR pozinceput &gt;= FisierTxtcaSir.Length]" sap:VirtualizedContainerService.HintSize="569,280" sap2010:WorkflowViewState.IdRef="If_786">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1710">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="ui:GenericValue">[pozsfarsit]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="ui:GenericValue">[-1]</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                  </If.Then>
                                                  <If.Else>
                                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1711">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="ui:GenericValue">[pozsfarsit]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="ui:GenericValue">[System.Text.RegularExpressions.Regex.Match(FisierTxtcaSir.Substring(pozinceput+2), "\.[^0-9/\*]").Index + pozinceput + 2]</InArgument>
                                                      </Assign.Value>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </Assign>
                                                  </If.Else>
                                                </If>
                                              </Sequence>
                                              <FlowStep.Next>
                                                <FlowDecision x:Name="__ReferenceID19" Condition="[pozinceput &lt;&gt; 6 AND pozsfarsit &lt;&gt; -1]" DisplayName="Flow Decision" sap:VirtualizedContainerService.HintSize="79,87" sap2010:WorkflowViewState.IdRef="FlowDecision_24">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <av:Point x:Key="ShapeLocation">270.5,966.5</av:Point>
                                                      <av:Size x:Key="ShapeSize">79,87</av:Size>
                                                      <av:PointCollection x:Key="TrueConnector">270.5,1010 131,1010 131,1151 161,1151</av:PointCollection>
                                                      <av:PointCollection x:Key="FalseConnector">349.5,1010 441,1010</av:PointCollection>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <FlowDecision.True>
                                                    <FlowStep x:Name="__ReferenceID17">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">161,1100</av:Point>
                                                          <av:Size x:Key="ShapeSize">262,102</av:Size>
                                                          <av:PointCollection x:Key="ConnectorLocation">292,1202 292,1256</av:PointCollection>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap2010:Annotation.AnnotationText="Inlatura posibile erori OCR din numarul de dosar identificat" sap:VirtualizedContainerService.HintSize="262,102" sap2010:WorkflowViewState.IdRef="Assign_1806">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[NrDosar1]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">[FisierTxtcaSir.Substring(pozinceput, pozsfarsit-pozinceput).Replace(" ", "").Replace("""", "*").Replace("'", "*").Replace("..", ".").Replace("l", "1").Replace("i", "1").Trim("."c)]</InArgument>
                                                        </Assign.Value>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </Assign>
                                                      <FlowStep.Next>
                                                        <FlowStep x:Name="__ReferenceID16">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">192,1256</av:Point>
                                                              <av:Size x:Key="ShapeSize">200,138</av:Size>
                                                              <av:PointCollection x:Key="ConnectorLocation">292,1394 292,1450</av:PointCollection>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Sequence sap2010:Annotation.AnnotationText="Verifica daca exista in Ecris numarul de dosar identificat. Daca nu, NrDosar1 devine &quot;nuamgasit&quot;" DisplayName="Verifica in DB Ecris" sap:VirtualizedContainerService.HintSize="200,138" sap2010:WorkflowViewState.IdRef="Sequence_2524">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="231,61" sap2010:WorkflowViewState.IdRef="WriteLine_21" Text="[&quot;sar nr: NrDosar1 &quot;+NrDosar1]" />
                                                            <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query" sap:VirtualizedContainerService.HintSize="231,51" sap2010:WorkflowViewState.IdRef="ExecuteQuery_15" ProviderName="System.Data.SqlClient" Sql="SELECT COUNT(numar_national) FROM Dosar WHERE numar_national=@NrDosar1" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                                              <ui:ExecuteQuery.Parameters>
                                                                <InArgument x:TypeArguments="x:String" x:Key="NrDosar1">[NrDosar1]</InArgument>
                                                              </ui:ExecuteQuery.Parameters>
                                                            </ui:ExecuteQuery>
                                                            <If Condition="[TabeldinDB.Rows.Item(0).Item(0).ToString &lt;&gt; &quot;1&quot;]" sap:VirtualizedContainerService.HintSize="231,51" sap2010:WorkflowViewState.IdRef="If_849">
                                                              <If.Then>
                                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1807">
                                                                  <Assign.To>
                                                                    <OutArgument x:TypeArguments="x:String">[NrDosar1]</OutArgument>
                                                                  </Assign.To>
                                                                  <Assign.Value>
                                                                    <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                                  </Assign.Value>
                                                                </Assign>
                                                              </If.Then>
                                                            </If>
                                                            <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="231,61" sap2010:WorkflowViewState.IdRef="WriteLine_22" Text="[&quot;NrDosar1 dupa verif. &quot;+NrDosar1]" />
                                                          </Sequence>
                                                          <FlowStep.Next>
                                                            <FlowStep x:Name="__ReferenceID15">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <av:Point x:Key="ShapeLocation">161,1450</av:Point>
                                                                  <av:Size x:Key="ShapeSize">262,102</av:Size>
                                                                  <av:PointCollection x:Key="ConnectorLocation">292,1552 292,1596</av:PointCollection>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <Assign sap2010:Annotation.AnnotationText="Repeta aceeasi procedura pentru al doilea numar dosar gasit (daca exista)" DisplayName="Cauta &quot;sar nr&quot; - Assign" sap:VirtualizedContainerService.HintSize="262,102" sap2010:WorkflowViewState.IdRef="Assign_1808">
                                                                <Assign.To>
                                                                  <OutArgument x:TypeArguments="ui:GenericValue">[pozinceput]</OutArgument>
                                                                </Assign.To>
                                                                <Assign.Value>
                                                                  <InArgument x:TypeArguments="ui:GenericValue">[FisierTxtcaSir.IndexOf("sar nr", pozsfarsit)+7]</InArgument>
                                                                </Assign.Value>
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                              </Assign>
                                                              <FlowStep.Next>
                                                                <FlowStep x:Name="__ReferenceID14">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <av:Point x:Key="ShapeLocation">192,1596</av:Point>
                                                                      <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                                      <av:PointCollection x:Key="ConnectorLocation">292,1662 292,1692 290,1692 290,1726.5</av:PointCollection>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <Sequence DisplayName="Pozitie sfarsit" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2525">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <If Condition="[pozinceput = 6 OR pozinceput &gt;= FisierTxtcaSir.Length]" sap:VirtualizedContainerService.HintSize="509,208" sap2010:WorkflowViewState.IdRef="If_850">
                                                                      <If.Then>
                                                                        <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1809">
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="ui:GenericValue">[pozsfarsit]</OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="ui:GenericValue">[-1]</InArgument>
                                                                          </Assign.Value>
                                                                        </Assign>
                                                                      </If.Then>
                                                                      <If.Else>
                                                                        <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1810">
                                                                          <Assign.To>
                                                                            <OutArgument x:TypeArguments="ui:GenericValue">[pozsfarsit]</OutArgument>
                                                                          </Assign.To>
                                                                          <Assign.Value>
                                                                            <InArgument x:TypeArguments="ui:GenericValue">[System.Text.RegularExpressions.Regex.Match(FisierTxtcaSir.Substring(pozinceput+2), "\.[^0-9/\*]").Index + pozinceput + 2]</InArgument>
                                                                          </Assign.Value>
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                        </Assign>
                                                                      </If.Else>
                                                                    </If>
                                                                  </Sequence>
                                                                  <FlowStep.Next>
                                                                    <FlowDecision x:Name="__ReferenceID13" Condition="[pozinceput &lt;&gt; 6 AND pozsfarsit &lt;&gt; -1]" DisplayName="Flow Decision" sap:VirtualizedContainerService.HintSize="79,87" sap2010:WorkflowViewState.IdRef="FlowDecision_23">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          <av:Point x:Key="ShapeLocation">250.5,1726.5</av:Point>
                                                                          <av:Size x:Key="ShapeSize">79,87</av:Size>
                                                                          <av:PointCollection x:Key="TrueConnector">250.5,1770 141,1770 141,1880 171,1880</av:PointCollection>
                                                                          <av:PointCollection x:Key="FalseConnector">329.5,1770 600.5,1770 600.5,2688.02 570.5,2688.02</av:PointCollection>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <FlowDecision.True>
                                                                        <FlowStep x:Name="__ReferenceID12">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <av:Point x:Key="ShapeLocation">171,1850</av:Point>
                                                                              <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                                              <av:PointCollection x:Key="ConnectorLocation">302,1910 302,1946</av:PointCollection>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1811">
                                                                            <Assign.To>
                                                                              <OutArgument x:TypeArguments="x:String">[NrDosar2]</OutArgument>
                                                                            </Assign.To>
                                                                            <Assign.Value>
                                                                              <InArgument x:TypeArguments="x:String">[FisierTxtcaSir.Substring(pozinceput, pozsfarsit-pozinceput).Replace(" ", "").Replace("""", "*").Replace("'", "*").Replace("..", ".").Replace("l", "1").Replace("i", "1").Trim("."c)]</InArgument>
                                                                            </Assign.Value>
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                          </Assign>
                                                                          <FlowStep.Next>
                                                                            <FlowStep x:Name="__ReferenceID11">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <av:Point x:Key="ShapeLocation">202,1946</av:Point>
                                                                                  <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                                                  <av:PointCollection x:Key="ConnectorLocation">302,2012 302,2050</av:PointCollection>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <Sequence DisplayName="Verifica in DB Ecris" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2527">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="231,61" sap2010:WorkflowViewState.IdRef="WriteLine_23" Text="[&quot;sar nr: NrDosar2 &quot;+NrDosar2]" />
                                                                                <Sequence DisplayName="Query DB" sap:VirtualizedContainerService.HintSize="242,234" sap2010:WorkflowViewState.IdRef="Sequence_2526">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteQuery_16" ProviderName="System.Data.SqlClient" Sql="SELECT COUNT(numar_national) FROM Dosar WHERE numar_national=@NrDosar2" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                                                                    <ui:ExecuteQuery.Parameters>
                                                                                      <InArgument x:TypeArguments="x:String" x:Key="NrDosar2">[NrDosar2]</InArgument>
                                                                                    </ui:ExecuteQuery.Parameters>
                                                                                  </ui:ExecuteQuery>
                                                                                  <If Condition="[TabeldinDB.Rows.Item(0).Item(0).ToString &lt;&gt; &quot;1&quot;]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_851">
                                                                                    <If.Then>
                                                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1813">
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="x:String">[NrDosar2]</OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                                                        </Assign.Value>
                                                                                      </Assign>
                                                                                    </If.Then>
                                                                                  </If>
                                                                                </Sequence>
                                                                                <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="231,61" sap2010:WorkflowViewState.IdRef="WriteLine_24" Text="[&quot;NrDosar2 dupa verif. &quot;+NrDosar2]" />
                                                                              </Sequence>
                                                                              <FlowStep.Next>
                                                                                <FlowStep x:Name="__ReferenceID10">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <av:Point x:Key="ShapeLocation">171,2050</av:Point>
                                                                                      <av:Size x:Key="ShapeSize">262,102</av:Size>
                                                                                      <av:PointCollection x:Key="ConnectorLocation">302,2152 302,2196</av:PointCollection>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <Assign sap2010:Annotation.AnnotationText="Repeta aceeasi procedura pentru al treilea numar dosar gasit (daca exista)" DisplayName="Cauta &quot;sar nr&quot; - Assign" sap:VirtualizedContainerService.HintSize="262,102" sap2010:WorkflowViewState.IdRef="Assign_1814">
                                                                                    <Assign.To>
                                                                                      <OutArgument x:TypeArguments="ui:GenericValue">[pozinceput]</OutArgument>
                                                                                    </Assign.To>
                                                                                    <Assign.Value>
                                                                                      <InArgument x:TypeArguments="ui:GenericValue">[FisierTxtcaSir.IndexOf("sar nr", pozsfarsit)+7]</InArgument>
                                                                                    </Assign.Value>
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                  </Assign>
                                                                                  <FlowStep.Next>
                                                                                    <FlowStep x:Name="__ReferenceID9">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <av:Point x:Key="ShapeLocation">202,2196</av:Point>
                                                                                          <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                                                          <av:PointCollection x:Key="ConnectorLocation">302,2262 302,2292 300,2292 300,2296.5</av:PointCollection>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <Sequence DisplayName="Pozitie sfarsit" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2528">
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                        <If Condition="[pozinceput = 6 OR pozinceput &gt;= FisierTxtcaSir.Length]" sap:VirtualizedContainerService.HintSize="557,208" sap2010:WorkflowViewState.IdRef="If_853">
                                                                                          <If.Then>
                                                                                            <Assign sap:VirtualizedContainerService.HintSize="258,60" sap2010:WorkflowViewState.IdRef="Assign_1815">
                                                                                              <Assign.To>
                                                                                                <OutArgument x:TypeArguments="ui:GenericValue">[pozsfarsit]</OutArgument>
                                                                                              </Assign.To>
                                                                                              <Assign.Value>
                                                                                                <InArgument x:TypeArguments="ui:GenericValue">[-1]</InArgument>
                                                                                              </Assign.Value>
                                                                                            </Assign>
                                                                                          </If.Then>
                                                                                          <If.Else>
                                                                                            <Assign sap:VirtualizedContainerService.HintSize="258,60" sap2010:WorkflowViewState.IdRef="Assign_1816">
                                                                                              <Assign.To>
                                                                                                <OutArgument x:TypeArguments="ui:GenericValue">[pozsfarsit]</OutArgument>
                                                                                              </Assign.To>
                                                                                              <Assign.Value>
                                                                                                <InArgument x:TypeArguments="ui:GenericValue">[System.Text.RegularExpressions.Regex.Match(FisierTxtcaSir.Substring(pozinceput+2), "\.[^0-9/\*]").Index + pozinceput + 2]</InArgument>
                                                                                              </Assign.Value>
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                            </Assign>
                                                                                          </If.Else>
                                                                                        </If>
                                                                                      </Sequence>
                                                                                      <FlowStep.Next>
                                                                                        <FlowDecision x:Name="__ReferenceID8" Condition="[pozinceput &lt;&gt; 6 AND pozsfarsit &lt;&gt; -1]" DisplayName="Flow Decision" sap:VirtualizedContainerService.HintSize="79,87" sap2010:WorkflowViewState.IdRef="FlowDecision_22">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              <av:Point x:Key="ShapeLocation">260.5,2296.5</av:Point>
                                                                                              <av:Size x:Key="ShapeSize">79,87</av:Size>
                                                                                              <av:PointCollection x:Key="TrueConnector">260.5,2340 131,2340 131,2440 161,2440</av:PointCollection>
                                                                                              <av:PointCollection x:Key="FalseConnector">339.5,2340 470.5,2340 470.5,2604.02</av:PointCollection>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <FlowDecision.True>
                                                                                            <FlowStep x:Name="__ReferenceID7">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <av:Point x:Key="ShapeLocation">161,2410</av:Point>
                                                                                                  <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                                                                  <av:PointCollection x:Key="ConnectorLocation">292,2470 292,2506</av:PointCollection>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1817">
                                                                                                <Assign.To>
                                                                                                  <OutArgument x:TypeArguments="x:String">[NrDosar3]</OutArgument>
                                                                                                </Assign.To>
                                                                                                <Assign.Value>
                                                                                                  <InArgument x:TypeArguments="x:String">[FisierTxtcaSir.Substring(pozinceput, pozsfarsit-pozinceput).Replace(" ", "").Replace("""", "*").Replace("'", "*").Replace("..", ".").Replace("l", "1").Replace("i", "1").Trim("."c)]</InArgument>
                                                                                                </Assign.Value>
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                              </Assign>
                                                                                              <FlowStep.Next>
                                                                                                <FlowStep x:Name="__ReferenceID6">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <av:Point x:Key="ShapeLocation">192,2506</av:Point>
                                                                                                      <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                                                                      <av:PointCollection x:Key="ConnectorLocation">292,2572 292,2688.02 370.5,2688.02</av:PointCollection>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <Sequence DisplayName="Verifica in DB Ecris" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2530">
                                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      </scg:Dictionary>
                                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                                    <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="231,61" sap2010:WorkflowViewState.IdRef="WriteLine_25" Text="[&quot;sar nr: NrDosar3 &quot;+NrDosar3]" />
                                                                                                    <Sequence DisplayName="Query DB" sap:VirtualizedContainerService.HintSize="242,234" sap2010:WorkflowViewState.IdRef="Sequence_2529">
                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                        </scg:Dictionary>
                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                      <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteQuery_17" ProviderName="System.Data.SqlClient" Sql="SELECT COUNT(numar_national) FROM Dosar WHERE numar_national=@NrDosar3" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                                                                                        <ui:ExecuteQuery.Parameters>
                                                                                                          <InArgument x:TypeArguments="x:String" x:Key="NrDosar3">[NrDosar3]</InArgument>
                                                                                                        </ui:ExecuteQuery.Parameters>
                                                                                                      </ui:ExecuteQuery>
                                                                                                      <If Condition="[TabeldinDB.Rows.Item(0).Item(0).ToString &lt;&gt; &quot;1&quot;]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_854">
                                                                                                        <If.Then>
                                                                                                          <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1819">
                                                                                                            <Assign.To>
                                                                                                              <OutArgument x:TypeArguments="x:String">[NrDosar3]</OutArgument>
                                                                                                            </Assign.To>
                                                                                                            <Assign.Value>
                                                                                                              <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                                                                            </Assign.Value>
                                                                                                          </Assign>
                                                                                                        </If.Then>
                                                                                                      </If>
                                                                                                    </Sequence>
                                                                                                    <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="231,61" sap2010:WorkflowViewState.IdRef="WriteLine_26" Text="[&quot;NrDosar3 dupa verif. &quot;+NrDosar3]" />
                                                                                                  </Sequence>
                                                                                                  <FlowStep.Next>
                                                                                                    <FlowStep x:Name="__ReferenceID0">
                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                          <av:Point x:Key="ShapeLocation">370.5,2604.02</av:Point>
                                                                                                          <av:Size x:Key="ShapeSize">200,168</av:Size>
                                                                                                        </scg:Dictionary>
                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                      <ui:InvokeCode ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Determina NrDosar in functie de cele 3 variabile NrDosar1, NrDosar2, NrDosar3. Pentru anumite situatii, robotul foloseste distanta Levenshtein (similaritatea sirurilor), pentru a determina NrDosar." Code="'Calculeaza distanta Levenshtein (similaritatea sirurilor), respectiv numarul de inserari,&#xA;'stergeri sau substituiri de caractere necesare pentru ca cele doua siruri sa devina identice.&#xA;Dim Levenshtein As Func(Of String, String, Integer) = Function(ByVal s As String, ByVal t As String) As Integer&#xA;  Dim n As Integer = s.Length&#xA;  Dim m As Integer = t.Length&#xA;  Dim d(n + 1, m + 1) As Integer&#xA;&#xA;  If n = 0 Then&#xA;      Return m&#xA;  End If&#xA;  If m = 0 Then&#xA;      Return n&#xA;  End If&#xA;&#xA;  Dim i As Integer&#xA;  Dim j As Integer&#xA;&#xA;  For i = 0 To n&#xA;      d(i, 0) = i&#xA;  Next&#xA;  For j = 0 To m&#xA;      d(0, j) = j&#xA;  Next&#xA;  For i = 1 To n&#xA;      For j = 1 To m&#xA;          Dim cost As Integer&#xA;          If t(j - 1) = s(i - 1) Then&#xA;             cost = 0&#xA;          Else&#xA;             cost = 1&#xA;          End If&#xA;          d(i, j) = Math.Min(Math.Min(d(i - 1, j) + 1, d(i, j - 1) + 1), d(i - 1, j - 1) + cost)&#xA;      Next&#xA;  Next&#xA;  Return d(n, m)&#xA;End Function&#xA;&#xA;If NrDosar1 = NrDosar2 And NrDosar2 = NrDosar3 Then    'daca toate cele 3 numere dosar sunt la fel (inclusiv &quot;nuamgasit&quot;)&#xA;&#x9;NrDosar = NrDosar1&#xA;Else        'daca am gasit un numar de dosar din 3&#xA;&#x9;If (NrDosar1 = &quot;nuamgasit&quot; And NrDosar2 = &quot;nuamgasit&quot; And NrDosar3 &lt;&gt; &quot;nuamgasit&quot;) Or (NrDosar1 = &quot;nuamgasit&quot; And NrDosar2 &lt;&gt; &quot;nuamgasit&quot; And NrDosar3 = &quot;nuamgasit&quot;) Or (NrDosar1 &lt;&gt; &quot;nuamgasit&quot; And NrDosar2 = &quot;nuamgasit&quot; And NrDosar3 = &quot;nuamgasit&quot;) Then&#xA;&#x9;&#x9;If NrDosar1 &lt;&gt; &quot;nuamgasit&quot; Then&#xA;&#x9;&#x9;&#x9;NrDosar = NrDosar1&#xA;&#x9;&#x9;Else &#xA;&#x9;&#x9;&#x9;If NrDosar2 &lt;&gt; &quot;nuamgasit&quot; Then&#xA;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar2&#xA;&#x9;&#x9;&#x9;Else&#xA;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar3&#xA;&#x9;&#x9;&#x9;End If&#xA;&#x9;&#x9;End If&#xA;&#x9;Else&#xA;&#x9;&#x9;NrDosar = &quot;nuamgasit&quot;  'acopera situatia cand am gasit 3 numere de dosar, toate diferite&#xA;&#x9;&#x9;If NrDosar1 = NrDosar2 Then   'daca am gasit 2 numere de dosar identice&#xA;&#x9;&#x9;&#x9;If NrDosar3 = &quot;nuamgasit&quot; Then &#xA;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar1&#xA;&#x9;&#x9;&#x9;Else&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;If Levenshtein(NrDosar1, NrDosar3) &lt;= 2 Then   'daca al treilea numar este similar cu primele 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar1 &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Else     &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;NrDosar = &quot;nuamgasit&quot;   'daca al treilea numar este diferit de primele 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;End If&#xA; &#x9;&#x9;&#x9;End If&#xA;&#x9;&#x9;End If&#xA;&#x9;&#x9;If NrDosar1 = NrDosar3 Then   'acelasi lucru pentru alta pereche posibila de 2 numere identice&#xA;&#x9;&#x9;&#x9;If NrDosar2 = &quot;nuamgasit&quot; Then &#xA;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar1&#xA;&#x9;&#x9;&#x9;Else&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;If Levenshtein(NrDosar1, NrDosar2) &lt;= 2 Then &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar1 &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Else &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;NrDosar = &quot;nuamgasit&quot;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;End If&#xA; &#x9;&#x9;&#x9;End If&#xA;&#x9;&#x9;End If&#xA;&#x9;&#x9;If NrDosar2 = NrDosar3 Then    'acelasi lucru pentru alta pereche posibila de 2 numere identice&#xA;&#x9;&#x9;&#x9;If NrDosar1 = &quot;nuamgasit&quot; Then &#xA;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar2&#xA;&#x9;&#x9;&#x9;Else &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;If Levenshtein(NrDosar2, NrDosar1) &lt;= 2 Then &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar2 &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Else&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;NrDosar = &quot;nuamgasit&quot;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;End If&#xA;&#x9;&#x9;&#x9;End If&#xA;&#x9;&#x9;End If&#xA;&#x9;End If&#xA;End If&#xA;" DisplayName="Determina NrDosar" sap:VirtualizedContainerService.HintSize="200,168" sap2010:WorkflowViewState.IdRef="InvokeCode_1">
                                                                                                        <ui:InvokeCode.Arguments>
                                                                                                          <InArgument x:TypeArguments="x:String" x:Key="NrDosar1">[NrDosar1]</InArgument>
                                                                                                          <InArgument x:TypeArguments="x:String" x:Key="NrDosar2">[NrDosar2]</InArgument>
                                                                                                          <InArgument x:TypeArguments="x:String" x:Key="NrDosar3">[NrDosar3]</InArgument>
                                                                                                          <OutArgument x:TypeArguments="x:String" x:Key="NrDosar">[NrDosar]</OutArgument>
                                                                                                        </ui:InvokeCode.Arguments>
                                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                                                                          </scg:Dictionary>
                                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                                      </ui:InvokeCode>
                                                                                                    </FlowStep>
                                                                                                  </FlowStep.Next>
                                                                                                </FlowStep>
                                                                                              </FlowStep.Next>
                                                                                            </FlowStep>
                                                                                          </FlowDecision.True>
                                                                                          <FlowDecision.False>
                                                                                            <x:Reference>__ReferenceID0</x:Reference>
                                                                                          </FlowDecision.False>
                                                                                        </FlowDecision>
                                                                                      </FlowStep.Next>
                                                                                    </FlowStep>
                                                                                  </FlowStep.Next>
                                                                                </FlowStep>
                                                                              </FlowStep.Next>
                                                                            </FlowStep>
                                                                          </FlowStep.Next>
                                                                        </FlowStep>
                                                                      </FlowDecision.True>
                                                                      <FlowDecision.False>
                                                                        <x:Reference>__ReferenceID0</x:Reference>
                                                                      </FlowDecision.False>
                                                                    </FlowDecision>
                                                                  </FlowStep.Next>
                                                                </FlowStep>
                                                              </FlowStep.Next>
                                                            </FlowStep>
                                                          </FlowStep.Next>
                                                        </FlowStep>
                                                      </FlowStep.Next>
                                                    </FlowStep>
                                                  </FlowDecision.True>
                                                  <FlowDecision.False>
                                                    <FlowStep x:Name="__ReferenceID18">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">441,980</av:Point>
                                                          <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1824">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:String">[NrDosar]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                        </Assign.Value>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </Assign>
                                                    </FlowStep>
                                                  </FlowDecision.False>
                                                </FlowDecision>
                                              </FlowStep.Next>
                                            </FlowStep>
                                          </FlowStep.Next>
                                        </FlowStep>
                                        <x:Reference>__ReferenceID1</x:Reference>
                                        <FlowStep x:Name="__ReferenceID3">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <av:Point x:Key="ShapeLocation">179,380</av:Point>
                                              <av:Size x:Key="ShapeSize">262,117</av:Size>
                                              <av:PointCollection x:Key="ConnectorLocation">310,497 310,550</av:PointCollection>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Assign sap2010:Annotation.AnnotationText="Inlatura erori OCR posibile si adapteaza anumite modele de citatii vechi (dosare faliment etc.)" DisplayName="Inlatura erori OCR posibile" sap:VirtualizedContainerService.HintSize="262,117" sap2010:WorkflowViewState.IdRef="Assign_1707">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[FisierTxtcaSir]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">[FisierTxtcaSir.ToLower.Replace(",", ".").Replace("^", "*").Replace("", "*").Replace("sar.", "sar ").Replace("sarnr", "sar nr").Replace("cu.", "cu ").Replace("cunr", "cu nr").Replace("rulnr", "rul nr").Replace("m.", "nr.").Replace("rul.", "rul ").Replace("civil ", "").Replace("faliment ", "").Replace("rul"+vbLf, "rul nr. ").Replace("rul"+vbCr, "rul nr. ").Replace(vbCr, "").Replace(vbLf, " ").Replace(vbTab, " ")]</InArgument>
                                            </Assign.Value>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </Assign>
                                          <FlowStep.Next>
                                            <FlowStep x:Name="__ReferenceID5">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">179,550</av:Point>
                                                  <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                  <av:PointCollection x:Key="ConnectorLocation">310,610 310,660</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Assign DisplayName="Inlatura alte erori OCR posibile (cu Regex)" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1708">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="x:String">[FisierTxtcaSir]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="x:String">[System.Text.RegularExpressions.Regex.Replace(FisierTxtcaSir, " [a-z^n][a-z^r]\.", " nr.")]</InArgument>
                                                </Assign.Value>
                                              </Assign>
                                              <FlowStep.Next>
                                                <x:Reference>__ReferenceID2</x:Reference>
                                              </FlowStep.Next>
                                            </FlowStep>
                                          </FlowStep.Next>
                                        </FlowStep>
                                        <FlowStep x:Name="__ReferenceID20">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <av:Point x:Key="ShapeLocation">210,117.5</av:Point>
                                              <av:Size x:Key="ShapeSize">200,66</av:Size>
                                              <av:PointCollection x:Key="ConnectorLocation">310,183.5 310,228.5</av:PointCollection>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <Sequence DisplayName="Initializare variabile" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2411">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1703">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[NrDosar]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">
                                                  <Literal x:TypeArguments="x:String" Value="" />
                                                </InArgument>
                                              </Assign.Value>
                                            </Assign>
                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1704">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[NrDosar1]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1705">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[NrDosar2]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1706">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[NrDosar3]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                              </Assign.Value>
                                            </Assign>
                                          </Sequence>
                                          <FlowStep.Next>
                                            <FlowStep x:Name="__ReferenceID4">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">210,228.5</av:Point>
                                                  <av:Size x:Key="ShapeSize">200,108</av:Size>
                                                  <av:PointCollection x:Key="ConnectorLocation">310,336.5 310,380</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:ReadTextFile sap2010:Annotation.AnnotationText="Citeste in variabila FisierTxtcaSir fisierul TXT cu rezultatul OCR" Content="[FisierTxtcaSir]" DisplayName="Read text file" FileName="[file]" sap:VirtualizedContainerService.HintSize="200,108" sap2010:WorkflowViewState.IdRef="ReadTextFile_1">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:ReadTextFile>
                                              <FlowStep.Next>
                                                <x:Reference>__ReferenceID3</x:Reference>
                                              </FlowStep.Next>
                                            </FlowStep>
                                          </FlowStep.Next>
                                        </FlowStep>
                                        <x:Reference>__ReferenceID4</x:Reference>
                                        <x:Reference>__ReferenceID5</x:Reference>
                                        <x:Reference>__ReferenceID6</x:Reference>
                                        <x:Reference>__ReferenceID7</x:Reference>
                                        <x:Reference>__ReferenceID8</x:Reference>
                                        <x:Reference>__ReferenceID9</x:Reference>
                                        <x:Reference>__ReferenceID10</x:Reference>
                                        <x:Reference>__ReferenceID11</x:Reference>
                                        <x:Reference>__ReferenceID12</x:Reference>
                                        <x:Reference>__ReferenceID13</x:Reference>
                                        <x:Reference>__ReferenceID14</x:Reference>
                                        <x:Reference>__ReferenceID15</x:Reference>
                                        <x:Reference>__ReferenceID16</x:Reference>
                                        <x:Reference>__ReferenceID17</x:Reference>
                                        <x:Reference>__ReferenceID18</x:Reference>
                                        <x:Reference>__ReferenceID19</x:Reference>
                                        <x:Reference>__ReferenceID0</x:Reference>
                                      </Flowchart>
                                      <If sap2010:Annotation.AnnotationText="Daca cautarea anterioara nu a avut succes, cauta NrDosar folosind alta expresie" Condition="[NrDosar = &quot;nuamgasit&quot;]" DisplayName="Cautare subsidiara nr dosar pt citatie" sap:VirtualizedContainerService.HintSize="434,108" sap2010:WorkflowViewState.IdRef="If_802">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Then>
                                          <Flowchart sap2010:Annotation.AnnotationText="Cauta dupa expresia &quot;cu nr.&quot;. Aceasta se gaseste in 0-3 locuri, in functie de tipul de dovada de citare sau comunicare, insa se afla in zone cu font mai mic, care provoaca mai multe erori la recunoasterea OCR." DisplayName="Cauta &quot;cu nr&quot; - in subsidiar" sap:VirtualizedContainerService.HintSize="974,2273" sap2010:WorkflowViewState.IdRef="Flowchart_78">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <av:Point x:Key="ShapeLocation">280,12.5</av:Point>
                                                <av:Size x:Key="ShapeSize">60,75</av:Size>
                                                <x:Double x:Key="Width">940</x:Double>
                                                <x:Double x:Key="Height">2195</x:Double>
                                                <av:PointCollection x:Key="ConnectorLocation">310,87.5 310,134</av:PointCollection>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Flowchart.StartNode>
                                              <x:Reference>__ReferenceID38</x:Reference>
                                            </Flowchart.StartNode>
                                            <FlowDecision x:Name="__ReferenceID24" Condition="[pozinceput &lt;&gt; 5 AND pozsfarsit &lt;&gt; -1]" sap:VirtualizedContainerService.HintSize="70,87" sap2010:WorkflowViewState.IdRef="FlowDecision_12">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <av:Point x:Key="ShapeLocation">275,426.5</av:Point>
                                                  <av:Size x:Key="ShapeSize">70,87</av:Size>
                                                  <av:PointCollection x:Key="TrueConnector">275,470 149,470 149,590 179,590</av:PointCollection>
                                                  <av:PointCollection x:Key="FalseConnector">345,470 405,470</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <FlowDecision.True>
                                                <FlowStep x:Name="__ReferenceID25">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">179,560</av:Point>
                                                      <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                      <av:PointCollection x:Key="ConnectorLocation">310,620 310,644.5</av:PointCollection>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1738">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:String">[NrDosar1]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:String">[FisierTxtcaSir.Substring(pozinceput, pozsfarsit-pozinceput).Replace(" ", "").Replace("""", "*").Replace("'", "*").Replace("..", ".").Replace("l", "1").Replace("i", "1").Trim("."c)]</InArgument>
                                                    </Assign.Value>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </Assign>
                                                  <FlowStep.Next>
                                                    <FlowStep x:Name="__ReferenceID30">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <av:Point x:Key="ShapeLocation">210,644.5</av:Point>
                                                          <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                          <av:PointCollection x:Key="ConnectorLocation">310,710.5 310,730</av:PointCollection>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Sequence DisplayName="Verifica in DB Ecris" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2422">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="231,61" sap2010:WorkflowViewState.IdRef="WriteLine_7" Text="[&quot;cu nr: NrDosar1 &quot;+NrDosar1]" />
                                                        <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query" sap:VirtualizedContainerService.HintSize="231,51" sap2010:WorkflowViewState.IdRef="ExecuteQuery_4" ProviderName="System.Data.SqlClient" Sql="SELECT COUNT(numar_national) FROM Dosar WHERE numar_national=@NrDosar1" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                                          <ui:ExecuteQuery.Parameters>
                                                            <InArgument x:TypeArguments="x:String" x:Key="NrDosar1">[NrDosar1]</InArgument>
                                                          </ui:ExecuteQuery.Parameters>
                                                        </ui:ExecuteQuery>
                                                        <If Condition="[TabeldinDB.Rows.Item(0).Item(0).ToString &lt;&gt; &quot;1&quot;]" sap:VirtualizedContainerService.HintSize="231,51" sap2010:WorkflowViewState.IdRef="If_795">
                                                          <If.Then>
                                                            <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1739">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:String">[NrDosar1]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                          </If.Then>
                                                        </If>
                                                        <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="231,61" sap2010:WorkflowViewState.IdRef="WriteLine_8" Text="[&quot;NrDosar1 dupa verif. &quot;+NrDosar1]" />
                                                      </Sequence>
                                                      <FlowStep.Next>
                                                        <FlowStep x:Name="__ReferenceID27">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">179,730</av:Point>
                                                              <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                              <av:PointCollection x:Key="ConnectorLocation">310,790 310,814.5</av:PointCollection>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Assign DisplayName="Cauta &quot;cu nr&quot; - Assign" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1740">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="ui:GenericValue">[pozinceput]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="ui:GenericValue">[FisierTxtcaSir.IndexOf("cu nr", pozsfarsit)+6]</InArgument>
                                                            </Assign.Value>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </Assign>
                                                          <FlowStep.Next>
                                                            <FlowStep x:Name="__ReferenceID32">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <av:Point x:Key="ShapeLocation">210,814.5</av:Point>
                                                                  <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                                  <av:PointCollection x:Key="ConnectorLocation">310,880.5 310,906.5</av:PointCollection>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <Sequence DisplayName="Pozitie sfarsit" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2423">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If Condition="[pozinceput = 5 OR pozinceput &gt;= FisierTxtcaSir.Length]" sap:VirtualizedContainerService.HintSize="509,208" sap2010:WorkflowViewState.IdRef="If_796">
                                                                  <If.Then>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1741">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="ui:GenericValue">[pozsfarsit]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="ui:GenericValue">[-1]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                  </If.Then>
                                                                  <If.Else>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1742">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="ui:GenericValue">[pozsfarsit]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="ui:GenericValue">[System.Text.RegularExpressions.Regex.Match(FisierTxtcaSir.Substring(pozinceput+2), " [^0-9/\*]").Index + pozinceput + 2]</InArgument>
                                                                      </Assign.Value>
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                    </Assign>
                                                                  </If.Else>
                                                                </If>
                                                              </Sequence>
                                                              <FlowStep.Next>
                                                                <FlowDecision x:Name="__ReferenceID22" Condition="[pozinceput &lt;&gt; 5 AND pozsfarsit &lt;&gt; -1]" sap:VirtualizedContainerService.HintSize="70,87" sap2010:WorkflowViewState.IdRef="FlowDecision_11">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <av:Point x:Key="ShapeLocation">275,906.5</av:Point>
                                                                      <av:Size x:Key="ShapeSize">70,87</av:Size>
                                                                      <av:PointCollection x:Key="TrueConnector">275,950 159,950 159,1040 189,1040</av:PointCollection>
                                                                      <av:PointCollection x:Key="FalseConnector">345,950 660,950 660,1680 630,1680</av:PointCollection>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <FlowDecision.True>
                                                                    <FlowStep x:Name="__ReferenceID26">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <av:Point x:Key="ShapeLocation">189,1010</av:Point>
                                                                          <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                                          <av:PointCollection x:Key="ConnectorLocation">320,1070 320,1094.5</av:PointCollection>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1743">
                                                                        <Assign.To>
                                                                          <OutArgument x:TypeArguments="x:String">[NrDosar2]</OutArgument>
                                                                        </Assign.To>
                                                                        <Assign.Value>
                                                                          <InArgument x:TypeArguments="x:String">[FisierTxtcaSir.Substring(pozinceput, pozsfarsit-pozinceput).Replace(" ", "").Replace("""", "*").Replace("'", "*").Replace("..", ".").Replace("l", "1").Replace("i", "1").Trim("."c)]</InArgument>
                                                                        </Assign.Value>
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                      </Assign>
                                                                      <FlowStep.Next>
                                                                        <FlowStep x:Name="__ReferenceID34">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <av:Point x:Key="ShapeLocation">220,1094.5</av:Point>
                                                                              <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                                              <av:PointCollection x:Key="ConnectorLocation">320,1160.5 320,1180</av:PointCollection>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <Sequence DisplayName="Verifica in DB Ecris" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2425">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="231,61" sap2010:WorkflowViewState.IdRef="WriteLine_9" Text="[&quot;cu nr: NrDosar2 &quot;+NrDosar2]" />
                                                                            <Sequence DisplayName="Query DB" sap:VirtualizedContainerService.HintSize="242,234" sap2010:WorkflowViewState.IdRef="Sequence_2543">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteQuery_18" ProviderName="System.Data.SqlClient" Sql="SELECT COUNT(numar_national) FROM Dosar WHERE numar_national=@NrDosar2" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                                                                <ui:ExecuteQuery.Parameters>
                                                                                  <InArgument x:TypeArguments="x:String" x:Key="NrDosar2">[NrDosar2]</InArgument>
                                                                                </ui:ExecuteQuery.Parameters>
                                                                              </ui:ExecuteQuery>
                                                                              <If Condition="[TabeldinDB.Rows.Item(0).Item(0).ToString &lt;&gt; &quot;1&quot;]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_866">
                                                                                <If.Then>
                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1835">
                                                                                    <Assign.To>
                                                                                      <OutArgument x:TypeArguments="x:String">[NrDosar2]</OutArgument>
                                                                                    </Assign.To>
                                                                                    <Assign.Value>
                                                                                      <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                                                    </Assign.Value>
                                                                                  </Assign>
                                                                                </If.Then>
                                                                              </If>
                                                                            </Sequence>
                                                                            <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="231,61" sap2010:WorkflowViewState.IdRef="WriteLine_10" Text="[&quot;NrDosar2 dupa verif. &quot;+NrDosar2]" />
                                                                          </Sequence>
                                                                          <FlowStep.Next>
                                                                            <FlowStep x:Name="__ReferenceID29">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <av:Point x:Key="ShapeLocation">189,1180</av:Point>
                                                                                  <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                                                  <av:PointCollection x:Key="ConnectorLocation">320,1240 320,1264.5</av:PointCollection>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <Assign DisplayName="Cauta &quot;cu nr&quot; - Assign" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1746">
                                                                                <Assign.To>
                                                                                  <OutArgument x:TypeArguments="ui:GenericValue">[pozinceput]</OutArgument>
                                                                                </Assign.To>
                                                                                <Assign.Value>
                                                                                  <InArgument x:TypeArguments="ui:GenericValue">[FisierTxtcaSir.IndexOf("cu nr", pozsfarsit)+6]</InArgument>
                                                                                </Assign.Value>
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                              </Assign>
                                                                              <FlowStep.Next>
                                                                                <FlowStep x:Name="__ReferenceID33">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <av:Point x:Key="ShapeLocation">220,1264.5</av:Point>
                                                                                      <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                                                      <av:PointCollection x:Key="ConnectorLocation">320,1330.5 320,1366.5</av:PointCollection>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <Sequence DisplayName="Pozitie sfarsit" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2426">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <If Condition="[pozinceput = 5 OR pozinceput &gt;= FisierTxtcaSir.Length]" sap:VirtualizedContainerService.HintSize="509,208" sap2010:WorkflowViewState.IdRef="If_799">
                                                                                      <If.Then>
                                                                                        <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1747">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="ui:GenericValue">[pozsfarsit]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="ui:GenericValue">[-1]</InArgument>
                                                                                          </Assign.Value>
                                                                                        </Assign>
                                                                                      </If.Then>
                                                                                      <If.Else>
                                                                                        <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1748">
                                                                                          <Assign.To>
                                                                                            <OutArgument x:TypeArguments="ui:GenericValue">[pozsfarsit]</OutArgument>
                                                                                          </Assign.To>
                                                                                          <Assign.Value>
                                                                                            <InArgument x:TypeArguments="ui:GenericValue">[System.Text.RegularExpressions.Regex.Match(FisierTxtcaSir.Substring(pozinceput+2), " [^0-9/\*]").Index + pozinceput + 2]</InArgument>
                                                                                          </Assign.Value>
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                        </Assign>
                                                                                      </If.Else>
                                                                                    </If>
                                                                                  </Sequence>
                                                                                  <FlowStep.Next>
                                                                                    <FlowDecision x:Name="__ReferenceID23" Condition="[pozinceput &lt;&gt; 5 AND pozsfarsit &lt;&gt; -1]" sap:VirtualizedContainerService.HintSize="70,87" sap2010:WorkflowViewState.IdRef="FlowDecision_10">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          <av:Point x:Key="ShapeLocation">285,1366.5</av:Point>
                                                                                          <av:Size x:Key="ShapeSize">70,87</av:Size>
                                                                                          <av:PointCollection x:Key="TrueConnector">285,1410 159,1410 159,1510 189,1510</av:PointCollection>
                                                                                          <av:PointCollection x:Key="FalseConnector">355,1410 530,1410 530,1654.5</av:PointCollection>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <FlowDecision.True>
                                                                                        <FlowStep x:Name="__ReferenceID28">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <av:Point x:Key="ShapeLocation">189,1480</av:Point>
                                                                                              <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                                                              <av:PointCollection x:Key="ConnectorLocation">320,1540 320,1564.5</av:PointCollection>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1749">
                                                                                            <Assign.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[NrDosar3]</OutArgument>
                                                                                            </Assign.To>
                                                                                            <Assign.Value>
                                                                                              <InArgument x:TypeArguments="x:String">[FisierTxtcaSir.Substring(pozinceput, pozsfarsit-pozinceput).Replace(" ", "").Replace("""", "*").Replace("'", "*").Replace("..", ".").Replace("l", "1").Replace("i", "1").Trim("."c)]</InArgument>
                                                                                            </Assign.Value>
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                          </Assign>
                                                                                          <FlowStep.Next>
                                                                                            <FlowStep x:Name="__ReferenceID35">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <av:Point x:Key="ShapeLocation">220,1564.5</av:Point>
                                                                                                  <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                                                                  <av:PointCollection x:Key="ConnectorLocation">320,1630.5 320,1680 430,1680</av:PointCollection>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <Sequence DisplayName="Verifica in DB Ecris" sap:VirtualizedContainerService.HintSize="273,360" sap2010:WorkflowViewState.IdRef="Sequence_2428">
                                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  </scg:Dictionary>
                                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                                <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="231,61" sap2010:WorkflowViewState.IdRef="WriteLine_11" Text="[&quot;cu nr: NrDosar3 &quot;+NrDosar3]" />
                                                                                                <Sequence DisplayName="Query DB" sap:VirtualizedContainerService.HintSize="242,234" sap2010:WorkflowViewState.IdRef="Sequence_2544">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query" sap:VirtualizedContainerService.HintSize="334,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_19" ProviderName="System.Data.SqlClient" Sql="SELECT COUNT(numar_national) FROM Dosar WHERE numar_national=@NrDosar3" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                                                                                    <ui:ExecuteQuery.Parameters>
                                                                                                      <InArgument x:TypeArguments="x:String" x:Key="NrDosar3">[NrDosar3]</InArgument>
                                                                                                    </ui:ExecuteQuery.Parameters>
                                                                                                  </ui:ExecuteQuery>
                                                                                                  <If Condition="[TabeldinDB.Rows.Item(0).Item(0).ToString &lt;&gt; &quot;1&quot;]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_867">
                                                                                                    <If.Then>
                                                                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1836">
                                                                                                        <Assign.To>
                                                                                                          <OutArgument x:TypeArguments="x:String">[NrDosar3]</OutArgument>
                                                                                                        </Assign.To>
                                                                                                        <Assign.Value>
                                                                                                          <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                                                                        </Assign.Value>
                                                                                                      </Assign>
                                                                                                    </If.Then>
                                                                                                  </If>
                                                                                                </Sequence>
                                                                                                <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="231,61" sap2010:WorkflowViewState.IdRef="WriteLine_12" Text="[&quot;NrDosar3 dupa verif. &quot;+NrDosar3]" />
                                                                                              </Sequence>
                                                                                              <FlowStep.Next>
                                                                                                <FlowStep x:Name="__ReferenceID21">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <av:Point x:Key="ShapeLocation">430,1654.5</av:Point>
                                                                                                      <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <ui:InvokeCode ContinueOnError="{x:Null}" Code="'Calculeaza distanta Levenshtein (similaritatea sirurilor), respectiv numarul de inserari,&#xA;'stergeri sau substituiri de caractere necesare pentru ca cele doua siruri sa devina identice.&#xA;Dim Levenshtein As Func(Of String, String, Integer) = Function(ByVal s As String, ByVal t As String) As Integer&#xA;  Dim n As Integer = s.Length&#xA;  Dim m As Integer = t.Length&#xA;  Dim d(n + 1, m + 1) As Integer&#xA;&#xA;  If n = 0 Then&#xA;      Return m&#xA;  End If&#xA;  If m = 0 Then&#xA;      Return n&#xA;  End If&#xA;&#xA;  Dim i As Integer&#xA;  Dim j As Integer&#xA;&#xA;  For i = 0 To n&#xA;      d(i, 0) = i&#xA;  Next&#xA;  For j = 0 To m&#xA;      d(0, j) = j&#xA;  Next&#xA;  For i = 1 To n&#xA;      For j = 1 To m&#xA;          Dim cost As Integer&#xA;          If t(j - 1) = s(i - 1) Then&#xA;             cost = 0&#xA;          Else&#xA;             cost = 1&#xA;          End If&#xA;          d(i, j) = Math.Min(Math.Min(d(i - 1, j) + 1, d(i, j - 1) + 1), d(i - 1, j - 1) + cost)&#xA;      Next&#xA;  Next&#xA;  Return d(n, m)&#xA;End Function&#xA;&#xA;If NrDosar1 = NrDosar2 And NrDosar2 = NrDosar3 Then    'daca toate cele 3 numere dosar sunt la fel (inclusiv &quot;nuamgasit&quot;)&#xA;&#x9;NrDosar = NrDosar1&#xA;Else        'daca am gasit un numar de dosar din 3&#xA;&#x9;If (NrDosar1 = &quot;nuamgasit&quot; And NrDosar2 = &quot;nuamgasit&quot; And NrDosar3 &lt;&gt; &quot;nuamgasit&quot;) Or (NrDosar1 = &quot;nuamgasit&quot; And NrDosar2 &lt;&gt; &quot;nuamgasit&quot; And NrDosar3 = &quot;nuamgasit&quot;) Or (NrDosar1 &lt;&gt; &quot;nuamgasit&quot; And NrDosar2 = &quot;nuamgasit&quot; And NrDosar3 = &quot;nuamgasit&quot;) Then&#xA;&#x9;&#x9;If NrDosar1 &lt;&gt; &quot;nuamgasit&quot; Then&#xA;&#x9;&#x9;&#x9;NrDosar = NrDosar1&#xA;&#x9;&#x9;Else &#xA;&#x9;&#x9;&#x9;If NrDosar2 &lt;&gt; &quot;nuamgasit&quot; Then&#xA;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar2&#xA;&#x9;&#x9;&#x9;Else&#xA;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar3&#xA;&#x9;&#x9;&#x9;End If&#xA;&#x9;&#x9;End If&#xA;&#x9;Else&#xA;&#x9;&#x9;NrDosar = &quot;nuamgasit&quot;  'acopera situatia cand am gasit 3 numere de dosar, toate diferite&#xA;&#x9;&#x9;If NrDosar1 = NrDosar2 Then   'daca am gasit 2 numere de dosar identice&#xA;&#x9;&#x9;&#x9;If NrDosar3 = &quot;nuamgasit&quot; Then &#xA;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar1&#xA;&#x9;&#x9;&#x9;Else&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;If Levenshtein(NrDosar1, NrDosar3) &lt;= 2 Then   'daca al treilea numar este similar cu primele 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar1 &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Else     &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;NrDosar = &quot;nuamgasit&quot;   'daca al treilea numar este diferit de primele 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;End If&#xA; &#x9;&#x9;&#x9;End If&#xA;&#x9;&#x9;End If&#xA;&#x9;&#x9;If NrDosar1 = NrDosar3 Then   'acelasi lucru pentru alta pereche posibila de 2 numere identice&#xA;&#x9;&#x9;&#x9;If NrDosar2 = &quot;nuamgasit&quot; Then &#xA;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar1&#xA;&#x9;&#x9;&#x9;Else&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;If Levenshtein(NrDosar1, NrDosar2) &lt;= 2 Then &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar1 &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Else &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;NrDosar = &quot;nuamgasit&quot;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;End If&#xA; &#x9;&#x9;&#x9;End If&#xA;&#x9;&#x9;End If&#xA;&#x9;&#x9;If NrDosar2 = NrDosar3 Then    'acelasi lucru pentru alta pereche posibila de 2 numere identice&#xA;&#x9;&#x9;&#x9;If NrDosar1 = &quot;nuamgasit&quot; Then &#xA;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar2&#xA;&#x9;&#x9;&#x9;Else &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;If Levenshtein(NrDosar2, NrDosar1) &lt;= 2 Then &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar2 &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Else&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;NrDosar = &quot;nuamgasit&quot;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;End If&#xA;&#x9;&#x9;&#x9;End If&#xA;&#x9;&#x9;End If&#xA;&#x9;End If&#xA;End If&#xA;" DisplayName="Determina NrDosar" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="InvokeCode_2">
                                                                                                    <ui:InvokeCode.Arguments>
                                                                                                      <InArgument x:TypeArguments="x:String" x:Key="NrDosar1">[NrDosar1]</InArgument>
                                                                                                      <InArgument x:TypeArguments="x:String" x:Key="NrDosar2">[NrDosar2]</InArgument>
                                                                                                      <InArgument x:TypeArguments="x:String" x:Key="NrDosar3">[NrDosar3]</InArgument>
                                                                                                      <OutArgument x:TypeArguments="x:String" x:Key="NrDosar">[NrDosar]</OutArgument>
                                                                                                    </ui:InvokeCode.Arguments>
                                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      </scg:Dictionary>
                                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                                  </ui:InvokeCode>
                                                                                                </FlowStep>
                                                                                              </FlowStep.Next>
                                                                                            </FlowStep>
                                                                                          </FlowStep.Next>
                                                                                        </FlowStep>
                                                                                      </FlowDecision.True>
                                                                                      <FlowDecision.False>
                                                                                        <x:Reference>__ReferenceID21</x:Reference>
                                                                                      </FlowDecision.False>
                                                                                    </FlowDecision>
                                                                                  </FlowStep.Next>
                                                                                </FlowStep>
                                                                              </FlowStep.Next>
                                                                            </FlowStep>
                                                                          </FlowStep.Next>
                                                                        </FlowStep>
                                                                      </FlowStep.Next>
                                                                    </FlowStep>
                                                                  </FlowDecision.True>
                                                                  <FlowDecision.False>
                                                                    <x:Reference>__ReferenceID21</x:Reference>
                                                                  </FlowDecision.False>
                                                                </FlowDecision>
                                                              </FlowStep.Next>
                                                            </FlowStep>
                                                          </FlowStep.Next>
                                                        </FlowStep>
                                                      </FlowStep.Next>
                                                    </FlowStep>
                                                  </FlowStep.Next>
                                                </FlowStep>
                                              </FlowDecision.True>
                                              <FlowDecision.False>
                                                <FlowStep x:Name="__ReferenceID36">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">405,440</av:Point>
                                                      <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1756">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:String">[NrDosar]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                    </Assign.Value>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </Assign>
                                                </FlowStep>
                                              </FlowDecision.False>
                                            </FlowDecision>
                                            <x:Reference>__ReferenceID22</x:Reference>
                                            <x:Reference>__ReferenceID23</x:Reference>
                                            <FlowStep x:Name="__ReferenceID37">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">179,230</av:Point>
                                                  <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                  <av:PointCollection x:Key="ConnectorLocation">310,290 310,334.5</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Assign DisplayName="Cauta &quot;cu nr&quot; - Assign" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1735">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="ui:GenericValue">[pozinceput]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="ui:GenericValue">[FisierTxtcaSir.IndexOf("cu nr")+6]</InArgument>
                                                </Assign.Value>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </Assign>
                                              <FlowStep.Next>
                                                <FlowStep x:Name="__ReferenceID31">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">210,334.5</av:Point>
                                                      <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                      <av:PointCollection x:Key="ConnectorLocation">310,400.5 310,426.5</av:PointCollection>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <Sequence DisplayName="Pozitie sfarsit" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2421">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If Condition="[pozinceput = 5 OR pozinceput &gt;= FisierTxtcaSir.Length]" sap:VirtualizedContainerService.HintSize="509,208" sap2010:WorkflowViewState.IdRef="If_794">
                                                      <If.Then>
                                                        <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1736">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="ui:GenericValue">[pozsfarsit]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="ui:GenericValue">[-1]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                      </If.Then>
                                                      <If.Else>
                                                        <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1737">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="ui:GenericValue">[pozsfarsit]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="ui:GenericValue">[System.Text.RegularExpressions.Regex.Match(FisierTxtcaSir.Substring(pozinceput+2), " [^0-9/\*]").Index + pozinceput + 2]</InArgument>
                                                          </Assign.Value>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </Assign>
                                                      </If.Else>
                                                    </If>
                                                  </Sequence>
                                                  <FlowStep.Next>
                                                    <x:Reference>__ReferenceID24</x:Reference>
                                                  </FlowStep.Next>
                                                </FlowStep>
                                              </FlowStep.Next>
                                            </FlowStep>
                                            <x:Reference>__ReferenceID25</x:Reference>
                                            <x:Reference>__ReferenceID26</x:Reference>
                                            <x:Reference>__ReferenceID27</x:Reference>
                                            <x:Reference>__ReferenceID28</x:Reference>
                                            <x:Reference>__ReferenceID29</x:Reference>
                                            <x:Reference>__ReferenceID30</x:Reference>
                                            <x:Reference>__ReferenceID31</x:Reference>
                                            <x:Reference>__ReferenceID32</x:Reference>
                                            <x:Reference>__ReferenceID33</x:Reference>
                                            <x:Reference>__ReferenceID34</x:Reference>
                                            <x:Reference>__ReferenceID35</x:Reference>
                                            <x:Reference>__ReferenceID36</x:Reference>
                                            <FlowStep x:Name="__ReferenceID38">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">210,134</av:Point>
                                                  <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                  <av:PointCollection x:Key="ConnectorLocation">310,200 310,230</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Sequence DisplayName="Initializare variabile" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2420">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1731">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[NrDosar]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">
                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                    </InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1732">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[NrDosar1]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1733">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[NrDosar2]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1734">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[NrDosar3]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                              <FlowStep.Next>
                                                <x:Reference>__ReferenceID37</x:Reference>
                                              </FlowStep.Next>
                                            </FlowStep>
                                            <x:Reference>__ReferenceID21</x:Reference>
                                          </Flowchart>
                                        </If.Then>
                                      </If>
                                      <If sap2010:Annotation.AnnotationText="Daca cautarile anterioare nu au avut succes, cauta NrDosar dupa alta expresie - pentru citatiile pe C.pr.civ. anterior" Condition="[NrDosar = &quot;nuamgasit&quot;]" DisplayName="Cautare subsidiara citatii VCPC" sap:VirtualizedContainerService.HintSize="434,123" sap2010:WorkflowViewState.IdRef="If_811">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Then>
                                          <Flowchart sap2010:Annotation.AnnotationText="Cauta dupa expresia &quot;rul nr.&quot; (din &quot;dosarul nr.&quot;). Cautarea gaseste si expresia &quot;dosarul xxxx/xxx/xxxx&quot; (fara &quot;nr.&quot;), deoarece, in procedura Cauta nr dosar pt citatie, &quot;dosarul\n&quot; este inlocuit cu &quot;dosarul nr.&quot;. Tot in procedura Cauta nr dosar pt citatie, sunt eliminate cuvinte intercalate de tipul &quot;dosar(ul) FALIMENT nr.&quot; sau &quot;dosar(ul) CIVIL nr.&quot;, pentru ca si aceste expresii sa fie gasite in cautare." DisplayName="Cauta in citatie VCPC" sap:VirtualizedContainerService.HintSize="200,288" sap2010:WorkflowViewState.IdRef="Flowchart_79">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <av:Point x:Key="ShapeLocation">270,10</av:Point>
                                                <av:Size x:Key="ShapeSize">60,75</av:Size>
                                                <av:PointCollection x:Key="ConnectorLocation">300,85 300,134</av:PointCollection>
                                                <x:Double x:Key="Width">811</x:Double>
                                                <x:Double x:Key="Height">2030.6599999999999</x:Double>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <Flowchart.StartNode>
                                              <x:Reference>__ReferenceID56</x:Reference>
                                            </Flowchart.StartNode>
                                            <FlowStep x:Name="__ReferenceID55">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">169,230</av:Point>
                                                  <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                  <av:PointCollection x:Key="ConnectorLocation">300,290 300,334.5</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Assign DisplayName="Cauta &quot;rul nr&quot; - Assign" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1761">
                                                <Assign.To>
                                                  <OutArgument x:TypeArguments="ui:GenericValue">[pozinceput]</OutArgument>
                                                </Assign.To>
                                                <Assign.Value>
                                                  <InArgument x:TypeArguments="ui:GenericValue">[FisierTxtcaSir.IndexOf("rul nr")+7]</InArgument>
                                                </Assign.Value>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </Assign>
                                              <FlowStep.Next>
                                                <FlowStep x:Name="__ReferenceID49">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <av:Point x:Key="ShapeLocation">200,334.5</av:Point>
                                                      <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                      <av:PointCollection x:Key="ConnectorLocation">300,400.5 300,426.5</av:PointCollection>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <Sequence DisplayName="Pozitie sfarsit" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2430">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If Condition="[pozinceput = 6 OR pozinceput &gt;= FisierTxtcaSir.Length]" sap:VirtualizedContainerService.HintSize="509,208" sap2010:WorkflowViewState.IdRef="If_803">
                                                      <If.Then>
                                                        <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1762">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="ui:GenericValue">[pozsfarsit]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="ui:GenericValue">[-1]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                      </If.Then>
                                                      <If.Else>
                                                        <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1763">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="ui:GenericValue">[pozsfarsit]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="ui:GenericValue">[System.Text.RegularExpressions.Regex.Match(FisierTxtcaSir.Substring(pozinceput+2), "[ \.][^0-9/ila\*]").Index + pozinceput + 2]</InArgument>
                                                          </Assign.Value>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </Assign>
                                                      </If.Else>
                                                    </If>
                                                  </Sequence>
                                                  <FlowStep.Next>
                                                    <FlowDecision x:Name="__ReferenceID45" Condition="[pozinceput &lt;&gt; 6 AND pozsfarsit &lt;&gt; -1]" sap:VirtualizedContainerService.HintSize="70,87" sap2010:WorkflowViewState.IdRef="FlowDecision_18">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <av:Point x:Key="ShapeLocation">265,426.5</av:Point>
                                                          <av:Size x:Key="ShapeSize">70,87</av:Size>
                                                          <av:PointCollection x:Key="TrueConnector">265,470 139,470 139,580 169,580</av:PointCollection>
                                                          <av:PointCollection x:Key="FalseConnector">335,470 439,470</av:PointCollection>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <FlowDecision.True>
                                                        <FlowStep x:Name="__ReferenceID40">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">169,550</av:Point>
                                                              <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                              <av:PointCollection x:Key="ConnectorLocation">300,610 300,634.5</av:PointCollection>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1764">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[NrDosar1]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">[FisierTxtcaSir.Substring(pozinceput, pozsfarsit-pozinceput).Replace(" ", "").Replace("""", "*").Replace("'", "*").Replace("..", ".").Replace("l", "1").Replace("i", "1").Trim("."c)]</InArgument>
                                                            </Assign.Value>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </Assign>
                                                          <FlowStep.Next>
                                                            <FlowStep x:Name="__ReferenceID48">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <av:Point x:Key="ShapeLocation">200,634.5</av:Point>
                                                                  <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                                  <av:PointCollection x:Key="ConnectorLocation">300,700.5 300,720</av:PointCollection>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <Sequence DisplayName="Verifica in DB Ecris" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2431">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="231,61" sap2010:WorkflowViewState.IdRef="WriteLine_13" Text="[&quot;rul nr: NrDosar1 &quot;+NrDosar1]" />
                                                                <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query" sap:VirtualizedContainerService.HintSize="231,51" sap2010:WorkflowViewState.IdRef="ExecuteQuery_7" ProviderName="System.Data.SqlClient" Sql="SELECT COUNT(numar_national) FROM Dosar WHERE numar_national =@NrDosar1" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                                                  <ui:ExecuteQuery.Parameters>
                                                                    <InArgument x:TypeArguments="x:String" x:Key="NrDosar1">[NrDosar1]</InArgument>
                                                                  </ui:ExecuteQuery.Parameters>
                                                                </ui:ExecuteQuery>
                                                                <If Condition="[TabeldinDB.Rows.Item(0).Item(0).ToString &lt;&gt; &quot;1&quot;]" sap:VirtualizedContainerService.HintSize="231,51" sap2010:WorkflowViewState.IdRef="If_804">
                                                                  <If.Then>
                                                                    <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1765">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[NrDosar1]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                  </If.Then>
                                                                </If>
                                                                <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="231,61" sap2010:WorkflowViewState.IdRef="WriteLine_14" Text="[&quot;NrDosar1 dupa verif. &quot;+NrDosar1]" />
                                                              </Sequence>
                                                              <FlowStep.Next>
                                                                <FlowStep x:Name="__ReferenceID42">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <av:Point x:Key="ShapeLocation">169,720</av:Point>
                                                                      <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                                      <av:PointCollection x:Key="ConnectorLocation">300,780 300,804.5</av:PointCollection>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <Assign DisplayName="Cauta &quot;rul nr&quot; - Assign" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1766">
                                                                    <Assign.To>
                                                                      <OutArgument x:TypeArguments="ui:GenericValue">[pozinceput]</OutArgument>
                                                                    </Assign.To>
                                                                    <Assign.Value>
                                                                      <InArgument x:TypeArguments="ui:GenericValue">[FisierTxtcaSir.IndexOf("rul nr", pozsfarsit)+7]</InArgument>
                                                                    </Assign.Value>
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </Assign>
                                                                  <FlowStep.Next>
                                                                    <FlowStep x:Name="__ReferenceID50">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <av:Point x:Key="ShapeLocation">200,804.5</av:Point>
                                                                          <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                                          <av:PointCollection x:Key="ConnectorLocation">300,870.5 300,896.5</av:PointCollection>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <Sequence DisplayName="Pozitie sfarsit" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2432">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <If Condition="[pozinceput = 6 OR pozinceput &gt;= FisierTxtcaSir.Length]" sap:VirtualizedContainerService.HintSize="509,208" sap2010:WorkflowViewState.IdRef="If_805">
                                                                          <If.Then>
                                                                            <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1767">
                                                                              <Assign.To>
                                                                                <OutArgument x:TypeArguments="ui:GenericValue">[pozsfarsit]</OutArgument>
                                                                              </Assign.To>
                                                                              <Assign.Value>
                                                                                <InArgument x:TypeArguments="ui:GenericValue">[-1]</InArgument>
                                                                              </Assign.Value>
                                                                            </Assign>
                                                                          </If.Then>
                                                                          <If.Else>
                                                                            <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1768">
                                                                              <Assign.To>
                                                                                <OutArgument x:TypeArguments="ui:GenericValue">[pozsfarsit]</OutArgument>
                                                                              </Assign.To>
                                                                              <Assign.Value>
                                                                                <InArgument x:TypeArguments="ui:GenericValue">[System.Text.RegularExpressions.Regex.Match(FisierTxtcaSir.Substring(pozinceput+2), "[ \.][^0-9/ila\*]").Index + pozinceput + 2]</InArgument>
                                                                              </Assign.Value>
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                            </Assign>
                                                                          </If.Else>
                                                                        </If>
                                                                      </Sequence>
                                                                      <FlowStep.Next>
                                                                        <FlowDecision x:Name="__ReferenceID46" Condition="[pozinceput &lt;&gt; 6 AND pozsfarsit &lt;&gt; -1]" sap:VirtualizedContainerService.HintSize="70,87" sap2010:WorkflowViewState.IdRef="FlowDecision_17">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              <av:Point x:Key="ShapeLocation">265,896.5</av:Point>
                                                                              <av:Size x:Key="ShapeSize">70,87</av:Size>
                                                                              <av:PointCollection x:Key="TrueConnector">265,940 139,940 139,1030 169,1030</av:PointCollection>
                                                                              <av:PointCollection x:Key="FalseConnector">335,940 630,940 630,1690 600,1690</av:PointCollection>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <FlowDecision.True>
                                                                            <FlowStep x:Name="__ReferenceID41">
                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                  <av:Point x:Key="ShapeLocation">169,1000</av:Point>
                                                                                  <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                                                  <av:PointCollection x:Key="ConnectorLocation">300,1060 300,1084.5</av:PointCollection>
                                                                                </scg:Dictionary>
                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1769">
                                                                                <Assign.To>
                                                                                  <OutArgument x:TypeArguments="x:String">[NrDosar2]</OutArgument>
                                                                                </Assign.To>
                                                                                <Assign.Value>
                                                                                  <InArgument x:TypeArguments="x:String">[FisierTxtcaSir.Substring(pozinceput, pozsfarsit-pozinceput).Replace(" ", "").Replace("""", "*").Replace("'", "*").Replace("..", ".").Replace("l", "1").Replace("i", "1").Trim("."c)]</InArgument>
                                                                                </Assign.Value>
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                              </Assign>
                                                                              <FlowStep.Next>
                                                                                <FlowStep x:Name="__ReferenceID52">
                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                      <av:Point x:Key="ShapeLocation">200,1084.5</av:Point>
                                                                                      <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                                                      <av:PointCollection x:Key="ConnectorLocation">300,1150.5 300,1180</av:PointCollection>
                                                                                    </scg:Dictionary>
                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                  <Sequence DisplayName="Verifica in DB Ecris" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2434">
                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                      </scg:Dictionary>
                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                    <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="231,61" sap2010:WorkflowViewState.IdRef="WriteLine_15" Text="[&quot;rul nr: NrDosar2 &quot;+NrDosar2]" />
                                                                                    <Sequence DisplayName="Query DB" sap:VirtualizedContainerService.HintSize="242,234" sap2010:WorkflowViewState.IdRef="Sequence_2545">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteQuery_20" ProviderName="System.Data.SqlClient" Sql="SELECT COUNT(numar_national) FROM Dosar WHERE numar_national=@NrDosar2" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                                                                        <ui:ExecuteQuery.Parameters>
                                                                                          <InArgument x:TypeArguments="x:String" x:Key="NrDosar2">[NrDosar2]</InArgument>
                                                                                        </ui:ExecuteQuery.Parameters>
                                                                                      </ui:ExecuteQuery>
                                                                                      <If Condition="[TabeldinDB.Rows.Item(0).Item(0).ToString &lt;&gt; &quot;1&quot;]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_868">
                                                                                        <If.Then>
                                                                                          <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1837">
                                                                                            <Assign.To>
                                                                                              <OutArgument x:TypeArguments="x:String">[NrDosar2]</OutArgument>
                                                                                            </Assign.To>
                                                                                            <Assign.Value>
                                                                                              <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                                                            </Assign.Value>
                                                                                          </Assign>
                                                                                        </If.Then>
                                                                                      </If>
                                                                                    </Sequence>
                                                                                    <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="231,61" sap2010:WorkflowViewState.IdRef="WriteLine_16" Text="[&quot;NrDosar2 dupa verif. &quot;+NrDosar2]" />
                                                                                  </Sequence>
                                                                                  <FlowStep.Next>
                                                                                    <FlowStep x:Name="__ReferenceID44">
                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                          <av:Point x:Key="ShapeLocation">169,1180</av:Point>
                                                                                          <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                                                          <av:PointCollection x:Key="ConnectorLocation">300,1240 300,1264.5</av:PointCollection>
                                                                                        </scg:Dictionary>
                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                      <Assign DisplayName="Cauta &quot;rul nr&quot; - Assign" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1772">
                                                                                        <Assign.To>
                                                                                          <OutArgument x:TypeArguments="ui:GenericValue">[pozinceput]</OutArgument>
                                                                                        </Assign.To>
                                                                                        <Assign.Value>
                                                                                          <InArgument x:TypeArguments="ui:GenericValue">[FisierTxtcaSir.IndexOf("rul nr", pozsfarsit)+7]</InArgument>
                                                                                        </Assign.Value>
                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                          </scg:Dictionary>
                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                      </Assign>
                                                                                      <FlowStep.Next>
                                                                                        <FlowStep x:Name="__ReferenceID51">
                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                              <av:Point x:Key="ShapeLocation">200,1264.5</av:Point>
                                                                                              <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                                                              <av:PointCollection x:Key="ConnectorLocation">300,1330.5 300,1376.5</av:PointCollection>
                                                                                            </scg:Dictionary>
                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                          <Sequence DisplayName="Pozitie sfarsit" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2435">
                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                              </scg:Dictionary>
                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                            <If Condition="[pozinceput = 6 OR pozinceput &gt;= FisierTxtcaSir.Length]" sap:VirtualizedContainerService.HintSize="509,208" sap2010:WorkflowViewState.IdRef="If_808">
                                                                                              <If.Then>
                                                                                                <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1773">
                                                                                                  <Assign.To>
                                                                                                    <OutArgument x:TypeArguments="ui:GenericValue">[pozsfarsit]</OutArgument>
                                                                                                  </Assign.To>
                                                                                                  <Assign.Value>
                                                                                                    <InArgument x:TypeArguments="ui:GenericValue">[-1]</InArgument>
                                                                                                  </Assign.Value>
                                                                                                </Assign>
                                                                                              </If.Then>
                                                                                              <If.Else>
                                                                                                <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1774">
                                                                                                  <Assign.To>
                                                                                                    <OutArgument x:TypeArguments="ui:GenericValue">[pozsfarsit]</OutArgument>
                                                                                                  </Assign.To>
                                                                                                  <Assign.Value>
                                                                                                    <InArgument x:TypeArguments="ui:GenericValue">[System.Text.RegularExpressions.Regex.Match(FisierTxtcaSir.Substring(pozinceput+2), "[ \.][^0-9/ila\*]").Index + pozinceput + 2]</InArgument>
                                                                                                  </Assign.Value>
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                </Assign>
                                                                                              </If.Else>
                                                                                            </If>
                                                                                          </Sequence>
                                                                                          <FlowStep.Next>
                                                                                            <FlowDecision x:Name="__ReferenceID47" Condition="[pozinceput &lt;&gt; 6 AND pozsfarsit &lt;&gt; -1]" sap:VirtualizedContainerService.HintSize="70,87" sap2010:WorkflowViewState.IdRef="FlowDecision_16">
                                                                                              <sap:WorkflowViewStateService.ViewState>
                                                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                  <av:Point x:Key="ShapeLocation">265,1376.5</av:Point>
                                                                                                  <av:Size x:Key="ShapeSize">70,87</av:Size>
                                                                                                  <av:PointCollection x:Key="TrueConnector">265,1420 149,1420 149,1510 179,1510</av:PointCollection>
                                                                                                  <av:PointCollection x:Key="FalseConnector">335,1420 500,1420 500,1664.5</av:PointCollection>
                                                                                                </scg:Dictionary>
                                                                                              </sap:WorkflowViewStateService.ViewState>
                                                                                              <FlowDecision.True>
                                                                                                <FlowStep x:Name="__ReferenceID43">
                                                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                      <av:Point x:Key="ShapeLocation">179,1480</av:Point>
                                                                                                      <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                                                                      <av:PointCollection x:Key="ConnectorLocation">310,1540 310,1564.5</av:PointCollection>
                                                                                                    </scg:Dictionary>
                                                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1775">
                                                                                                    <Assign.To>
                                                                                                      <OutArgument x:TypeArguments="x:String">[NrDosar3]</OutArgument>
                                                                                                    </Assign.To>
                                                                                                    <Assign.Value>
                                                                                                      <InArgument x:TypeArguments="x:String">[FisierTxtcaSir.Substring(pozinceput, pozsfarsit-pozinceput).Replace(" ", "").Replace("""", "*").Replace("'", "*").Replace("..", ".").Replace("l", "1").Replace("i", "1").Trim("."c)]</InArgument>
                                                                                                    </Assign.Value>
                                                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                      </scg:Dictionary>
                                                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                                                  </Assign>
                                                                                                  <FlowStep.Next>
                                                                                                    <FlowStep x:Name="__ReferenceID53">
                                                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                          <av:Point x:Key="ShapeLocation">210,1564.5</av:Point>
                                                                                                          <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                                                                          <av:PointCollection x:Key="ConnectorLocation">310,1630.5 310,1690 400,1690</av:PointCollection>
                                                                                                        </scg:Dictionary>
                                                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                                                      <Sequence DisplayName="Verifica in DB Ecris" sap:VirtualizedContainerService.HintSize="273,360" sap2010:WorkflowViewState.IdRef="Sequence_2437">
                                                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                          </scg:Dictionary>
                                                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                                                        <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="231,61" sap2010:WorkflowViewState.IdRef="WriteLine_17" Text="[&quot;rul nr: NrDosar3 &quot;+NrDosar3]" />
                                                                                                        <Sequence DisplayName="Query DB" sap:VirtualizedContainerService.HintSize="242,234" sap2010:WorkflowViewState.IdRef="Sequence_2546">
                                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                                                            </scg:Dictionary>
                                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                                          <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteQuery_21" ProviderName="System.Data.SqlClient" Sql="SELECT COUNT(numar_national) FROM Dosar WHERE numar_national=@NrDosar3" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                                                                                            <ui:ExecuteQuery.Parameters>
                                                                                                              <InArgument x:TypeArguments="x:String" x:Key="NrDosar3">[NrDosar3]</InArgument>
                                                                                                            </ui:ExecuteQuery.Parameters>
                                                                                                          </ui:ExecuteQuery>
                                                                                                          <If Condition="[TabeldinDB.Rows.Item(0).Item(0).ToString &lt;&gt; &quot;1&quot;]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_869">
                                                                                                            <If.Then>
                                                                                                              <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1838">
                                                                                                                <Assign.To>
                                                                                                                  <OutArgument x:TypeArguments="x:String">[NrDosar3]</OutArgument>
                                                                                                                </Assign.To>
                                                                                                                <Assign.Value>
                                                                                                                  <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                                                                                </Assign.Value>
                                                                                                              </Assign>
                                                                                                            </If.Then>
                                                                                                          </If>
                                                                                                        </Sequence>
                                                                                                        <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="231,61" sap2010:WorkflowViewState.IdRef="WriteLine_18" Text="[&quot;NrDosar3 dupa verif. &quot;+NrDosar3]" />
                                                                                                      </Sequence>
                                                                                                      <FlowStep.Next>
                                                                                                        <FlowStep x:Name="__ReferenceID39">
                                                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                              <av:Point x:Key="ShapeLocation">400,1664.5</av:Point>
                                                                                                              <av:Size x:Key="ShapeSize">200,51</av:Size>
                                                                                                            </scg:Dictionary>
                                                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                                                          <ui:InvokeCode ContinueOnError="{x:Null}" Code="'Calculeaza distanta Levenshtein (similaritatea sirurilor), respectiv numarul de inserari,&#xA;'stergeri sau substituiri de caractere necesare pentru ca cele doua siruri sa devina identice.&#xA;Dim Levenshtein As Func(Of String, String, Integer) = Function(ByVal s As String, ByVal t As String) As Integer&#xA;  Dim n As Integer = s.Length&#xA;  Dim m As Integer = t.Length&#xA;  Dim d(n + 1, m + 1) As Integer&#xA;&#xA;  If n = 0 Then&#xA;      Return m&#xA;  End If&#xA;  If m = 0 Then&#xA;      Return n&#xA;  End If&#xA;&#xA;  Dim i As Integer&#xA;  Dim j As Integer&#xA;&#xA;  For i = 0 To n&#xA;      d(i, 0) = i&#xA;  Next&#xA;  For j = 0 To m&#xA;      d(0, j) = j&#xA;  Next&#xA;  For i = 1 To n&#xA;      For j = 1 To m&#xA;          Dim cost As Integer&#xA;          If t(j - 1) = s(i - 1) Then&#xA;             cost = 0&#xA;          Else&#xA;             cost = 1&#xA;          End If&#xA;          d(i, j) = Math.Min(Math.Min(d(i - 1, j) + 1, d(i, j - 1) + 1), d(i - 1, j - 1) + cost)&#xA;      Next&#xA;  Next&#xA;  Return d(n, m)&#xA;End Function&#xA;&#xA;If NrDosar1 = NrDosar2 And NrDosar2 = NrDosar3 Then    'daca toate cele 3 numere dosar sunt la fel (inclusiv &quot;nuamgasit&quot;)&#xA;&#x9;NrDosar = NrDosar1&#xA;Else        'daca am gasit un numar de dosar din 3&#xA;&#x9;If (NrDosar1 = &quot;nuamgasit&quot; And NrDosar2 = &quot;nuamgasit&quot; And NrDosar3 &lt;&gt; &quot;nuamgasit&quot;) Or (NrDosar1 = &quot;nuamgasit&quot; And NrDosar2 &lt;&gt; &quot;nuamgasit&quot; And NrDosar3 = &quot;nuamgasit&quot;) Or (NrDosar1 &lt;&gt; &quot;nuamgasit&quot; And NrDosar2 = &quot;nuamgasit&quot; And NrDosar3 = &quot;nuamgasit&quot;) Then&#xA;&#x9;&#x9;If NrDosar1 &lt;&gt; &quot;nuamgasit&quot; Then&#xA;&#x9;&#x9;&#x9;NrDosar = NrDosar1&#xA;&#x9;&#x9;Else &#xA;&#x9;&#x9;&#x9;If NrDosar2 &lt;&gt; &quot;nuamgasit&quot; Then&#xA;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar2&#xA;&#x9;&#x9;&#x9;Else&#xA;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar3&#xA;&#x9;&#x9;&#x9;End If&#xA;&#x9;&#x9;End If&#xA;&#x9;Else&#xA;&#x9;&#x9;NrDosar = &quot;nuamgasit&quot;  'acopera situatia cand am gasit 3 numere de dosar, toate diferite&#xA;&#x9;&#x9;If NrDosar1 = NrDosar2 Then   'daca am gasit 2 numere de dosar identice&#xA;&#x9;&#x9;&#x9;If NrDosar3 = &quot;nuamgasit&quot; Then &#xA;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar1&#xA;&#x9;&#x9;&#x9;Else&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;If Levenshtein(NrDosar1, NrDosar3) &lt;= 2 Then   'daca al treilea numar este similar cu primele 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar1 &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Else     &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;NrDosar = &quot;nuamgasit&quot;   'daca al treilea numar este diferit de primele 2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;End If&#xA; &#x9;&#x9;&#x9;End If&#xA;&#x9;&#x9;End If&#xA;&#x9;&#x9;If NrDosar1 = NrDosar3 Then   'acelasi lucru pentru alta pereche posibila de 2 numere identice&#xA;&#x9;&#x9;&#x9;If NrDosar2 = &quot;nuamgasit&quot; Then &#xA;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar1&#xA;&#x9;&#x9;&#x9;Else&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;If Levenshtein(NrDosar1, NrDosar2) &lt;= 2 Then &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar1 &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Else &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;NrDosar = &quot;nuamgasit&quot;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;End If&#xA; &#x9;&#x9;&#x9;End If&#xA;&#x9;&#x9;End If&#xA;&#x9;&#x9;If NrDosar2 = NrDosar3 Then    'acelasi lucru pentru alta pereche posibila de 2 numere identice&#xA;&#x9;&#x9;&#x9;If NrDosar1 = &quot;nuamgasit&quot; Then &#xA;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar2&#xA;&#x9;&#x9;&#x9;Else &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;If Levenshtein(NrDosar2, NrDosar1) &lt;= 2 Then &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;NrDosar = NrDosar2 &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Else&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;NrDosar = &quot;nuamgasit&quot;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;End If&#xA;&#x9;&#x9;&#x9;End If&#xA;&#x9;&#x9;End If&#xA;&#x9;End If&#xA;End If&#xA;" DisplayName="Determina NrDosar" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="InvokeCode_3">
                                                                                                            <ui:InvokeCode.Arguments>
                                                                                                              <InArgument x:TypeArguments="x:String" x:Key="NrDosar1">[NrDosar1]</InArgument>
                                                                                                              <InArgument x:TypeArguments="x:String" x:Key="NrDosar2">[NrDosar2]</InArgument>
                                                                                                              <InArgument x:TypeArguments="x:String" x:Key="NrDosar3">[NrDosar3]</InArgument>
                                                                                                              <OutArgument x:TypeArguments="x:String" x:Key="NrDosar">[NrDosar]</OutArgument>
                                                                                                            </ui:InvokeCode.Arguments>
                                                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                                              </scg:Dictionary>
                                                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                                                          </ui:InvokeCode>
                                                                                                        </FlowStep>
                                                                                                      </FlowStep.Next>
                                                                                                    </FlowStep>
                                                                                                  </FlowStep.Next>
                                                                                                </FlowStep>
                                                                                              </FlowDecision.True>
                                                                                              <FlowDecision.False>
                                                                                                <x:Reference>__ReferenceID39</x:Reference>
                                                                                              </FlowDecision.False>
                                                                                            </FlowDecision>
                                                                                          </FlowStep.Next>
                                                                                        </FlowStep>
                                                                                      </FlowStep.Next>
                                                                                    </FlowStep>
                                                                                  </FlowStep.Next>
                                                                                </FlowStep>
                                                                              </FlowStep.Next>
                                                                            </FlowStep>
                                                                          </FlowDecision.True>
                                                                          <FlowDecision.False>
                                                                            <x:Reference>__ReferenceID39</x:Reference>
                                                                          </FlowDecision.False>
                                                                        </FlowDecision>
                                                                      </FlowStep.Next>
                                                                    </FlowStep>
                                                                  </FlowStep.Next>
                                                                </FlowStep>
                                                              </FlowStep.Next>
                                                            </FlowStep>
                                                          </FlowStep.Next>
                                                        </FlowStep>
                                                      </FlowDecision.True>
                                                      <FlowDecision.False>
                                                        <FlowStep x:Name="__ReferenceID54">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <av:Point x:Key="ShapeLocation">439,440</av:Point>
                                                              <av:Size x:Key="ShapeSize">262,60</av:Size>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1782">
                                                            <Assign.To>
                                                              <OutArgument x:TypeArguments="x:String">[NrDosar]</OutArgument>
                                                            </Assign.To>
                                                            <Assign.Value>
                                                              <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                            </Assign.Value>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </Assign>
                                                        </FlowStep>
                                                      </FlowDecision.False>
                                                    </FlowDecision>
                                                  </FlowStep.Next>
                                                </FlowStep>
                                              </FlowStep.Next>
                                            </FlowStep>
                                            <x:Reference>__ReferenceID40</x:Reference>
                                            <x:Reference>__ReferenceID41</x:Reference>
                                            <x:Reference>__ReferenceID42</x:Reference>
                                            <x:Reference>__ReferenceID43</x:Reference>
                                            <x:Reference>__ReferenceID44</x:Reference>
                                            <x:Reference>__ReferenceID45</x:Reference>
                                            <x:Reference>__ReferenceID46</x:Reference>
                                            <x:Reference>__ReferenceID47</x:Reference>
                                            <x:Reference>__ReferenceID48</x:Reference>
                                            <x:Reference>__ReferenceID49</x:Reference>
                                            <x:Reference>__ReferenceID50</x:Reference>
                                            <x:Reference>__ReferenceID51</x:Reference>
                                            <x:Reference>__ReferenceID52</x:Reference>
                                            <x:Reference>__ReferenceID53</x:Reference>
                                            <x:Reference>__ReferenceID54</x:Reference>
                                            <FlowStep x:Name="__ReferenceID56">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <av:Point x:Key="ShapeLocation">200,134</av:Point>
                                                  <av:Size x:Key="ShapeSize">200,66</av:Size>
                                                  <av:PointCollection x:Key="ConnectorLocation">300,200 300,230</av:PointCollection>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Sequence DisplayName="Initializare variabile" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2429">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1757">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[NrDosar]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">
                                                      <Literal x:TypeArguments="x:String" Value="" />
                                                    </InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1758">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[NrDosar1]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1759">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[NrDosar2]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1760">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[NrDosar3]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">nuamgasit</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                              </Sequence>
                                              <FlowStep.Next>
                                                <x:Reference>__ReferenceID55</x:Reference>
                                              </FlowStep.Next>
                                            </FlowStep>
                                            <x:Reference>__ReferenceID39</x:Reference>
                                          </Flowchart>
                                        </If.Then>
                                      </If>
                                      <If sap2010:Annotation.AnnotationText="Daca nu s-a gasit un NrDosar existent in Ecris, redenumeste fisierul cu _TRYx pentru o noua incercare OCR. Daca s-a ajuns la a 5-a incercare OCR fara succes, muta fisierele PDF si TXT in FolderErori." Condition="[NrDosar = &quot;nuamgasit&quot;]" DisplayName="Daca nu am gasit NrDosar" sap:VirtualizedContainerService.HintSize="434,168" sap2010:WorkflowViewState.IdRef="If_814">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Then>
                                          <If sap2010:Annotation.AnnotationText="Daca nu reuseste sa gaseasca un NrDosar existent in Ecris, robotul muta fisierul pentru repetarea OCR de pana la 5 ori cu setari diferite. Pentru aceasta, robotul adauga la numele fisierului PDF terminatia _TRY2, _TRY3 s.a.m.d. pentru incercarile 2-5 , nume care este preluat automat si de fisierul TXT cu rezultatul OCR. Daca nu s-a gasit un NrDosar existent in Ecris, redenumeste fisierul cu _TRYx. Daca s-a ajuns la a 5-a incercare, muta fisierele PDF si TXT in FolderErori." Condition="[NumeFisierPDF.Contains(&quot;_TRY5&quot;)]" DisplayName="Verifica daca s-a incercat mai OCR o data" sap:VirtualizedContainerService.HintSize="484,316" sap2010:WorkflowViewState.IdRef="If_813">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <Sequence DisplayName="Am incercat OCR de 5 ori" sap:VirtualizedContainerService.HintSize="304,871" sap2010:WorkflowViewState.IdRef="Sequence_2440">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)]" DisplayName="Move TXT to Erori" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="MoveFile_119" Overwrite="True" Path="[file]" />
                                                <If sap2010:Annotation.AnnotationText="Muta fisierul in FolderErori, redenumit cu _mutat_ora_hh_mm, daca exista deja un fisier cu acelasi nume, pentru a evita suprascrierea" Condition="[System.IO.File.Exists(instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileName(NumeFisierPDF).Replace(&quot;_TRYNEXT&quot;, &quot;&quot;))]" DisplayName="Move PDF to Erori" sap:VirtualizedContainerService.HintSize="262,153" sap2010:WorkflowViewState.IdRef="If_812">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(NumeFisierPDF).Replace(&quot;_TRY5&quot;, &quot;&quot;)+&quot;_mutat_ora_&quot;+DateTime.Now.ToString(&quot;HH-mm&quot;)+Path.GetExtension(NumeFisierPDF)]" DisplayName="Move PDF to Erori redenumit" sap:VirtualizedContainerService.HintSize="384,157" sap2010:WorkflowViewState.IdRef="MoveFile_120" Overwrite="True" Path="[NumeFisierPDF]" />
                                                  </If.Then>
                                                  <If.Else>
                                                    <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileName(NumeFisierPDF).Replace(&quot;_TRY5&quot;, &quot;&quot;)]" DisplayName="Move PDF to Erori" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="MoveFile_121" Overwrite="True" Path="[NumeFisierPDF]" />
                                                  </If.Else>
                                                </If>
                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1783">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[NumeFisierPDF]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[NumeFisierPDF.Replace("_TRY5", "")]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1784">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[fisierEroare]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[NumeFisierPDF]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="AppendLine_310" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(NumeFisierPDF) + &quot; - Esec 5 recunoastere OCR&quot;]">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:AppendLine>
                                                <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_450">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <TryCatch.Try>
                                                    <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_452" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                      <ui:BrowserScope.Body>
                                                        <ActivityAction x:TypeArguments="x:Object">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2438">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_106" />
                                                            <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1065" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                              <ui:TypeInto.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                              </ui:TypeInto.Target>
                                                            </ui:TypeInto>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:BrowserScope.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:BrowserScope>
                                                  </TryCatch.Try>
                                                  <TryCatch.Catches>
                                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_460">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                        </ActivityAction.Argument>
                                                        <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_433" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                          <ui:OpenBrowser.Body>
                                                            <ActivityAction x:TypeArguments="x:Object">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                              </ActivityAction.Argument>
                                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2439">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1066" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                  <ui:TypeInto.Target>
                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                  </ui:TypeInto.Target>
                                                                </ui:TypeInto>
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </ui:OpenBrowser.Body>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:OpenBrowser>
                                                      </ActivityAction>
                                                    </Catch>
                                                  </TryCatch.Catches>
                                                </TryCatch>
                                                <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_488">
                                                  <TryCatch.Try>
                                                    <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_58" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+NumeFisierPDF.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '', '', '', 3, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                      <ui:ExecuteNonQuery.Parameters>
                                                        <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                      </ui:ExecuteNonQuery.Parameters>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:ExecuteNonQuery>
                                                  </TryCatch.Try>
                                                  <TryCatch.Catches>
                                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_498">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                        </ActivityAction.Argument>
                                                      </ActivityAction>
                                                    </Catch>
                                                  </TryCatch.Catches>
                                                </TryCatch>
                                                <ui:Continue sap:VirtualizedContainerService.HintSize="262,22" sap2010:WorkflowViewState.IdRef="Continue_6" />
                                              </Sequence>
                                            </If.Then>
                                            <If.Else>
                                              <Sequence DisplayName="Incearca OCR inca o data cu setari best" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2443">
                                                <Sequence.Variables>
                                                  <Variable x:TypeArguments="x:Int32" Name="nrTry" />
                                                </Sequence.Variables>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If Condition="[System.Text.RegularExpressions.Regex.Match(NumeFisierPDF, &quot;_TRY[1-5]\.&quot;).Success]" DisplayName="Afla numarul incercarii nrTry" sap:VirtualizedContainerService.HintSize="484,51" sap2010:WorkflowViewState.IdRef="If_847">
                                                  <If.Then>
                                                    <Sequence sap:VirtualizedContainerService.HintSize="296,252" sap2010:WorkflowViewState.IdRef="Sequence_2523">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="258,60" sap2010:WorkflowViewState.IdRef="Assign_1801">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Int32">[nrTry]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Int32">[cint(NumeFisierPDF.Split({"_TRY"}, StringSplitOptions.None)(1).Substring(0, 1))]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <Assign sap:VirtualizedContainerService.HintSize="258,60" sap2010:WorkflowViewState.IdRef="Assign_1802">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Int32">[nrTry]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Int32">[nrTry + 1]</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                    </Sequence>
                                                  </If.Then>
                                                  <If.Else>
                                                    <Assign sap:VirtualizedContainerService.HintSize="258,60" sap2010:WorkflowViewState.IdRef="Assign_1803">
                                                      <Assign.To>
                                                        <OutArgument x:TypeArguments="x:Int32">[nrTry]</OutArgument>
                                                      </Assign.To>
                                                      <Assign.Value>
                                                        <InArgument x:TypeArguments="x:Int32">2</InArgument>
                                                      </Assign.Value>
                                                    </Assign>
                                                  </If.Else>
                                                </If>
                                                <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)]" DisplayName="Move TXT to Erori" sap:VirtualizedContainerService.HintSize="484,51" sap2010:WorkflowViewState.IdRef="MoveFile_122" Overwrite="True" Path="[file]" />
                                                <If Condition="[nrTry = 2]" DisplayName="Move &amp; rename PDF for next try" sap:VirtualizedContainerService.HintSize="484,208" sap2010:WorkflowViewState.IdRef="If_848">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderPentruOCR&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(NumeFisierPDF)+&quot;_TRY2&quot;+Path.GetExtension(NumeFisierPDF)]" DisplayName="Add TRY to PDF name" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="MoveFile_123" Overwrite="True" Path="[NumeFisierPDF]">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:MoveFile>
                                                  </If.Then>
                                                  <If.Else>
                                                    <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderPentruOCR&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(NumeFisierPDF).Split({&quot;_TRY&quot;}, StringSplitOptions.None)(0)+&quot;_TRY&quot;+nrTry.ToString+Path.GetExtension(NumeFisierPDF)]" DisplayName="Rename PDF with new TRY" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="MoveFile_139" Overwrite="True" Path="[NumeFisierPDF]" />
                                                  </If.Else>
                                                </If>
                                                <Assign sap:VirtualizedContainerService.HintSize="484,60" sap2010:WorkflowViewState.IdRef="Assign_1804">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[NumeFisierPDF]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[Path.GetFileNameWithoutExtension(NumeFisierPDF).Split({"_TRY"}, StringSplitOptions.None)(0)+Path.GetExtension(NumeFisierPDF)]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <Assign sap:VirtualizedContainerService.HintSize="484,60" sap2010:WorkflowViewState.IdRef="Assign_1805">
                                                  <Assign.To>
                                                    <OutArgument x:TypeArguments="x:String">[fisierEroare]</OutArgument>
                                                  </Assign.To>
                                                  <Assign.Value>
                                                    <InArgument x:TypeArguments="x:String">[NumeFisierPDF]</InArgument>
                                                  </Assign.Value>
                                                </Assign>
                                                <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="484,51" sap2010:WorkflowViewState.IdRef="AppendLine_311" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(NumeFisierPDF) + &quot; - Esec &quot;+(nrTry - 1).ToString+&quot; recunoastere OCR&quot;]">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:AppendLine>
                                                <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="484,51" sap2010:WorkflowViewState.IdRef="TryCatch_451">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <TryCatch.Try>
                                                    <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_453" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                      <ui:BrowserScope.Body>
                                                        <ActivityAction x:TypeArguments="x:Object">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2441">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_107" />
                                                            <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1067" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                              <ui:TypeInto.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                              </ui:TypeInto.Target>
                                                            </ui:TypeInto>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:BrowserScope.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:BrowserScope>
                                                  </TryCatch.Try>
                                                  <TryCatch.Catches>
                                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_461">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                        </ActivityAction.Argument>
                                                        <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_434" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                          <ui:OpenBrowser.Body>
                                                            <ActivityAction x:TypeArguments="x:Object">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                              </ActivityAction.Argument>
                                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2442">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1068" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                  <ui:TypeInto.Target>
                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                  </ui:TypeInto.Target>
                                                                </ui:TypeInto>
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </ui:OpenBrowser.Body>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:OpenBrowser>
                                                      </ActivityAction>
                                                    </Catch>
                                                  </TryCatch.Catches>
                                                </TryCatch>
                                                <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="484,51" sap2010:WorkflowViewState.IdRef="TryCatch_489">
                                                  <TryCatch.Try>
                                                    <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_59" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+NumeFisierPDF.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '', '', '', 2, 'Incercarea &quot;+(nrTry-1).ToString+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                      <ui:ExecuteNonQuery.Parameters>
                                                        <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                      </ui:ExecuteNonQuery.Parameters>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:ExecuteNonQuery>
                                                  </TryCatch.Try>
                                                  <TryCatch.Catches>
                                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_499">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                        </ActivityAction.Argument>
                                                      </ActivityAction>
                                                    </Catch>
                                                  </TryCatch.Catches>
                                                </TryCatch>
                                                <ui:Continue sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="Continue_7" />
                                              </Sequence>
                                            </If.Else>
                                          </If>
                                        </If.Then>
                                      </If>
                                      <Sequence sap2010:Annotation.AnnotationText="Afla idDosar din Ecris corespunzator NrDosar. Este folosit pentru a compune URL de acces paginile de creare intrare si upload in Ecris." DisplayName="Afla idDosar" sap:VirtualizedContainerService.HintSize="434,153" sap2010:WorkflowViewState.IdRef="Sequence_2444">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="ExecuteQuery_10" ProviderName="System.Data.SqlClient" Sql="SELECT id_dosar FROM Dosar WHERE numar_national =@NrDosar" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                          <ui:ExecuteQuery.Parameters>
                                            <InArgument x:TypeArguments="x:String" x:Key="NrDosar">[NrDosar]</InArgument>
                                          </ui:ExecuteQuery.Parameters>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ExecuteQuery>
                                        <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1785">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[idDosar]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[TabeldinDB.Rows.Item(0).Item(0).ToString]</InArgument>
                                          </Assign.Value>
                                        </Assign>
                                        <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="262,61" sap2010:WorkflowViewState.IdRef="WriteLine_19" Text="[&quot;NrDosar &quot;+NrDosar+&quot; idDosar &quot;+idDosar]" />
                                      </Sequence>
                                      <TryCatch sap2010:Annotation.AnnotationText="Procedura in care este operata aplicatia Ecris pentru urcare citatie (dovada de citare sau comunicare)" DisplayName="Upload citatie in Ecris" sap:VirtualizedContainerService.HintSize="434,123" sap2010:WorkflowViewState.IdRef="TryCatch_460">
                                        <TryCatch.Variables>
                                          <Variable x:TypeArguments="x:Boolean" Name="elementExists" />
                                        </TryCatch.Variables>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <TryCatch.Try>
                                          <Sequence sap2010:Annotation.AnnotationText="Robotul se conecteaza la fereastra Chrome, acceseaza URL si creeaza intrarea in Ecris, apoi se conecteaza la URL corespunzator urca fisierul PDF. Robotul foloseste injectie Javascript si metoda WindowMessages pentru butonul Alege fisierul. Robotul aloca timp suficient pentru incarcarea unor pagini mai lente si verifica daca elementele de care are nevoie din noua pagina s-au incarcat." DisplayName="Creeaza si ataseaza citatia" sap:VirtualizedContainerService.HintSize="200,303" sap2010:WorkflowViewState.IdRef="Sequence_2453">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If sap2010:Annotation.AnnotationText="Inainte de urcare, robotul redenumeste fisierul PDF inlaturand terminatia _TRYx." Condition="[NumeFisierPDF.Contains(&quot;_TRY&quot;)]" DisplayName="Rename PDF file fara TRY" sap:VirtualizedContainerService.HintSize="262,108" sap2010:WorkflowViewState.IdRef="If_815">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <If.Then>
                                                <Sequence sap2010:Annotation.AnnotationText="Inainte de urcare, robotul redenumeste fisierul PDF inlaturand terminatia _TRYx. Daca apare o eroare intre momentul redenumirii si momentul urcarii efective in Ecris, apare o diferenta intre numele fisierului TXT (care contine _TRYx) si numele fisierului PDF (care nu mai contine terminatia), eroare care este gestionata ulterior de procedura Verifica Exista Fisier PDF." DisplayName="Sequence" sap:VirtualizedContainerService.HintSize="304,446" sap2010:WorkflowViewState.IdRef="Sequence_2445">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:MoveFile ContinueOnError="{x:Null}" Destination="[NumeFisierPDF.Split({&quot;_TRY&quot;}, StringSplitOptions.None)(0)+Path.GetExtension(NumeFisierPDF)]" DisplayName="Move File" sap:VirtualizedContainerService.HintSize="262,22" sap2010:WorkflowViewState.IdRef="MoveFile_124" Overwrite="True" Path="[NumeFisierPDF]" />
                                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1786">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:String">[NumeFisierPDF]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:String">[NumeFisierPDF.Split({"_TRY"}, StringSplitOptions.None)(0)+Path.GetExtension(NumeFisierPDF)]</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1787">
                                                    <Assign.To>
                                                      <OutArgument x:TypeArguments="x:String">[fisierEroare]</OutArgument>
                                                    </Assign.To>
                                                    <Assign.Value>
                                                      <InArgument x:TypeArguments="x:String">[NumeFisierPDF]</InArgument>
                                                    </Assign.Value>
                                                  </Assign>
                                                </Sequence>
                                              </If.Then>
                                            </If>
                                            <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="Daca mai exista o citatie urcata in aceeasi zi la respectivul dosar, robotul nu mai creeaza o intrare noua in Ecris, ci urca noua citatie la aceeasi intrare, pentru a evita crearea unui exces de intrari la dosarul respectiv." CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query" sap:VirtualizedContainerService.HintSize="262,183" sap2010:WorkflowViewState.IdRef="ExecuteQuery_11" ProviderName="System.Data.SqlClient" Sql="[&quot;SELECT TOP 1 id_document FROM Document WHERE id_dosar=@idDosar AND CONVERT(VARCHAR, data, 103)='&quot;+DateTime.Now.ToString(&quot;dd/MM/yyyy&quot;)+&quot;' AND id_tipdocument=3068 ORDER BY data DESC, id_document DESC&quot;]" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                              <ui:ExecuteQuery.Parameters>
                                                <InArgument x:TypeArguments="x:String" x:Key="idDosar">[idDosar]</InArgument>
                                              </ui:ExecuteQuery.Parameters>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:ExecuteQuery>
                                            <If sap2010:Annotation.AnnotationText="Creeaza o intrare noua in Ecris, daca nu exista una deja creata la dosar in aceeasi zi" Condition="[TabeldinDB.Rows.Count = 0]" DisplayName="Creeaza intrarea in Ecris daca nu exista azi alta" sap:VirtualizedContainerService.HintSize="262,108" sap2010:WorkflowViewState.IdRef="If_816">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <If.Then>
                                                <Sequence sap:VirtualizedContainerService.HintSize="242,542" sap2010:WorkflowViewState.IdRef="Sequence_2447">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" sap2010:Annotation.AnnotationText="Robotul se conecteaza la fereastra Chrome, acceseaza URL corespunzator in Ecris si urca fisierul. Robotul foloseste injectie Javascript. Robotul aloca timp suficient pentru incarcarea unor pagini mai lente." BrowserType="Chrome" DisplayName="Creeaza citatia" sap:VirtualizedContainerService.HintSize="434,528" sap2010:WorkflowViewState.IdRef="BrowserScope_454" InformativeScreenshot="77b2f2f2315d768cf9699b70ca1182c2" Selector="&lt;html app='chrome.exe' title='ECRIS*' /&gt;" TimeoutMS="3000">
                                                    <ui:BrowserScope.Body>
                                                      <ActivityAction x:TypeArguments="x:Object">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                        </ActivityAction.Argument>
                                                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="242,325" sap2010:WorkflowViewState.IdRef="Sequence_2446">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ui:NavigateTo Browser="{x:Null}" DisplayName="Navigate to" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="NavigateTo_111" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/dosar_documente.aspx?id_dosar=&quot;+idDosar]" />
                                                          <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'LABEL'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Click_533" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                                            <ui:Click.CursorPosition>
                                                              <ui:CursorPosition OffsetX="36" OffsetY="1" Position="TopLeft" />
                                                            </ui:Click.CursorPosition>
                                                            <ui:Click.Target>
                                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="d6dc64112ae5b5cae5bd305770fa8530" Selector="&lt;html app='chrome.exe' title='ECRIS*' /&gt;&lt;webctrl aaname='Acte emise de instan' parentid='ctl00_ContentPlaceHolder1_rblDocument' tag='LABEL' /&gt;" TimeoutMS="10000" WaitForReady="INTERACTIVE" />
                                                            </ui:Click.Target>
                                                          </ui:Click>
                                                          <ui:InjectJsScript InputParameter="{x:Null}" ScriptOutput="{x:Null}" DisplayName="Inject js script 'DIV'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="InjectJsScript_1" ScriptCode="[&quot;function robotui() {document.getElementById('ctl00_ContentPlaceHolder1_lbTipDocumente').value=&quot;&quot;3068&quot;&quot;; document.getElementById('ctl00_ContentPlaceHolder1_txtDescriere').value=&quot;&quot;Dovada de citare/comunicare&quot;&quot;;document.getElementById('ctl00_ContentPlaceHolder1_btnAddDocument').click()}&quot;]">
                                                            <ui:InjectJsScript.Target>
                                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" InformativeScreenshot="46543c41f8df1657e4d145f13c1b2a6c" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                            </ui:InjectJsScript.Target>
                                                          </ui:InjectJsScript>
                                                        </Sequence>
                                                      </ActivityAction>
                                                    </ui:BrowserScope.Body>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:BrowserScope>
                                                  <Delay sap2010:Annotation.AnnotationText="Acorda un ragaz pentru ca Ecris sa termine de procesat intrarea nou-creata" Duration="00:00:02" sap:VirtualizedContainerService.HintSize="200,79" sap2010:WorkflowViewState.IdRef="Delay_70">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </Delay>
                                                  <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="Afla idDocument al intrarii nou-create in Ecris pentru citatie" CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query" sap:VirtualizedContainerService.HintSize="200,108" sap2010:WorkflowViewState.IdRef="ExecuteQuery_12" ProviderName="System.Data.SqlClient" Sql="SELECT TOP 1 id_document FROM Document WHERE id_dosar=@idDosar AND id_tipdocument=3068 ORDER BY data DESC, id_document DESC" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                                    <ui:ExecuteQuery.Parameters>
                                                      <InArgument x:TypeArguments="x:String" x:Key="idDosar">[idDosar]</InArgument>
                                                    </ui:ExecuteQuery.Parameters>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:ExecuteQuery>
                                                </Sequence>
                                              </If.Then>
                                            </If>
                                            <Assign sap2010:Annotation.AnnotationText="Afla idDocument pentru citatie, care este folosit pentru compunerea URL de upload in Ecris. idDocument (intrarea) este fie cel deja existent pentru ziua respectiva, fie cel nou creat." sap:VirtualizedContainerService.HintSize="262,147" sap2010:WorkflowViewState.IdRef="Assign_1788">
                                              <Assign.To>
                                                <OutArgument x:TypeArguments="x:String">[idDocument]</OutArgument>
                                              </Assign.To>
                                              <Assign.Value>
                                                <InArgument x:TypeArguments="x:String">[TabeldinDB.Rows.Item(0).Item(0).ToString]</InArgument>
                                              </Assign.Value>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </Assign>
                                            <WriteLine DisplayName="Write line" sap:VirtualizedContainerService.HintSize="262,61" sap2010:WorkflowViewState.IdRef="WriteLine_20" Text="[&quot; idDocument &quot;+ idDocument]" />
                                            <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" sap2010:Annotation.AnnotationText="Robotul se conecteaza la fereastra Chrome, acceseaza URL corespunzator in Ecris si urca fisierul. Robotul foloseste injectie Javascript si metoda WindowMessages pentru butonul Alege fisierul. Robotul aloca timp suficient pentru incarcarea unor pagini mai lente si verifica daca elementele de care are nevoie din noua pagina s-au incarcat." BrowserType="Chrome" DisplayName="Ataseaza citatia" sap:VirtualizedContainerService.HintSize="262,258" sap2010:WorkflowViewState.IdRef="BrowserScope_455" InformativeScreenshot="2417c3935327e2e803afec5b41f91b29" Selector="&lt;html app='chrome.exe' title='ECRIS*' /&gt;" TimeoutMS="3000">
                                              <ui:BrowserScope.Body>
                                                <ActivityAction x:TypeArguments="x:Object">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                  </ActivityAction.Argument>
                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="376,2032" sap2010:WorkflowViewState.IdRef="Sequence_2452">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:NavigateTo Browser="{x:Null}" DisplayName="Navigate to" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="NavigateTo_112" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/dosar_documente.aspx?id_dosar=&quot;+idDosar+&quot;&amp;id_document=&quot;+idDocument+&quot;&amp;page=0&quot;]">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:NavigateTo>
                                                    <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'A '" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="Click_534" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                                      <ui:Click.CursorPosition>
                                                        <ui:CursorPosition OffsetX="37" OffsetY="5" Position="TopLeft" />
                                                      </ui:Click.CursorPosition>
                                                      <ui:Click.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="adcd04930dad8c0f6bd22d21100167ed" Selector="&lt;html app='chrome.exe' title='ECRIS*' /&gt;&lt;webctrl aaname='Ataamente' parentid='aspnetForm' tag='A' /&gt;" TimeoutMS="10000" WaitForReady="INTERACTIVE" />
                                                      </ui:Click.Target>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:Click>
                                                    <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists 'INPUT  ctl00_ContentPla...'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="UiElementExists_137">
                                                      <ui:UiElementExists.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="bda8ffb5121cc6dca67dd0510f2718ba" Selector="&lt;html app='chrome.exe' title='ECRIS*' /&gt;&lt;webctrl id='ctl00_ContentPlaceHolder1_btnUpload' tag='INPUT' /&gt;&lt;nav up='1' /&gt;&lt;webctrl id='ctl00_ContentPlaceHolder1_uxFileUpload' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                                      </ui:UiElementExists.Target>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:UiElementExists>
                                                    <ui:Click DelayMS="{x:Null}" ClickType="CLICK_SINGLE" DelayBefore="500" DisplayName="Click 'INPUT  ctl00_ContentPla...'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="Click_535" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                                      <ui:Click.CursorPosition>
                                                        <ui:CursorPosition Position="Center">
                                                          <ui:CursorPosition.OffsetX>
                                                            <InArgument x:TypeArguments="x:Int32" />
                                                          </ui:CursorPosition.OffsetX>
                                                          <ui:CursorPosition.OffsetY>
                                                            <InArgument x:TypeArguments="x:Int32" />
                                                          </ui:CursorPosition.OffsetY>
                                                        </ui:CursorPosition>
                                                      </ui:Click.CursorPosition>
                                                      <ui:Click.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="bda8ffb5121cc6dca67dd0510f2718ba" Selector="&lt;html app='chrome.exe' title='ECRIS*' /&gt;&lt;webctrl id='ctl00_ContentPlaceHolder1_btnUpload' tag='INPUT' /&gt;&lt;nav up='1' /&gt;&lt;webctrl id='ctl00_ContentPlaceHolder1_uxFileUpload' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                                      </ui:Click.Target>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:Click>
                                                    <ui:UiElementExists DisplayName="Element Exists 'Explorer Pane'" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="UiElementExists_138">
                                                      <ui:UiElementExists.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="42108de8cedf275ef8779fdf5c720f93" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd aaname='Explorer Pane' cls='DirectUIHWND' /&gt;&lt;wnd ctrlid='1121' title='ShellView' /&gt;&lt;wnd aaname='Items View' cls='DirectUIHWND' /&gt;" TimeoutMS="60000" WaitForReady="COMPLETE" />
                                                      </ui:UiElementExists.Target>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:UiElementExists>
                                                    <If sap2010:Annotation.AnnotationText="Daca nu se deschide fereastra Open file, este o eroare Windows si se arunca o exceptie pentru a fi repornit browser-ul." Condition="[elementExists]" DisplayName="Daca nu se deschide fereastra Open file" sap:VirtualizedContainerService.HintSize="334,138" sap2010:WorkflowViewState.IdRef="If_817">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If.Else>
                                                        <Throw Exception="[new Exception(&quot;Nu pot deschide fereastra Open file&quot;)]" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Throw_1" />
                                                      </If.Else>
                                                    </If>
                                                    <If sap2010:Annotation.AnnotationText="Este posibil ca documentul sa fi fost sters intre timp si atunci se mai incearca o data accesarea lui, dupa care se inchide fereastra Open file." Condition="[System.IO.File.Exists(NumeFisierPDF)]" DisplayName="Verifica daca mai exista documentul" sap:VirtualizedContainerService.HintSize="334,138" sap2010:WorkflowViewState.IdRef="If_819">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If.Else>
                                                        <Sequence sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Sequence_2449">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <Delay Duration="00:00:08" sap:VirtualizedContainerService.HintSize="464,22" sap2010:WorkflowViewState.IdRef="Delay_71" />
                                                          <If Condition="[System.IO.File.Exists(NumeFisierPDF)]" DisplayName="If" sap:VirtualizedContainerService.HintSize="464,586" sap2010:WorkflowViewState.IdRef="If_818">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <If.Else>
                                                              <Sequence DisplayName="Inchide fereastra Open file" sap:VirtualizedContainerService.HintSize="336,438" sap2010:WorkflowViewState.IdRef="Sequence_2448">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_536" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                                                  <ui:Click.CursorPosition>
                                                                    <ui:CursorPosition Position="Center">
                                                                      <ui:CursorPosition.OffsetX>
                                                                        <InArgument x:TypeArguments="x:Int32" />
                                                                      </ui:CursorPosition.OffsetX>
                                                                      <ui:CursorPosition.OffsetY>
                                                                        <InArgument x:TypeArguments="x:Int32" />
                                                                      </ui:CursorPosition.OffsetY>
                                                                    </ui:CursorPosition>
                                                                  </ui:Click.CursorPosition>
                                                                  <ui:Click.Target>
                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="ee9793bc24a3b55b05f818dd72b1861c" Selector="&lt;wnd app='chrome.exe' cls='#32770' idx='1' title='Open' /&gt;&lt;wnd aaname='Open' cls='DirectUIHWND' /&gt;&lt;wnd cls='Button' title='OK' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                  </ui:Click.Target>
                                                                </ui:Click>
                                                                <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_537" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                                                  <ui:Click.CursorPosition>
                                                                    <ui:CursorPosition Position="Center">
                                                                      <ui:CursorPosition.OffsetX>
                                                                        <InArgument x:TypeArguments="x:Int32" />
                                                                      </ui:CursorPosition.OffsetX>
                                                                      <ui:CursorPosition.OffsetY>
                                                                        <InArgument x:TypeArguments="x:Int32" />
                                                                      </ui:CursorPosition.OffsetY>
                                                                    </ui:CursorPosition>
                                                                  </ui:Click.CursorPosition>
                                                                  <ui:Click.Target>
                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="bd1f48e701357a84dc55314b323bc7d9" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd ctrlid='2' title='Cancel' aaname='Cancel' cls='Button' /&gt;" TimeoutMS="5000" WaitForReady="COMPLETE" />
                                                                  </ui:Click.Target>
                                                                </ui:Click>
                                                                <ui:Continue sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="Continue_8" />
                                                              </Sequence>
                                                            </If.Else>
                                                          </If>
                                                        </Sequence>
                                                      </If.Else>
                                                    </If>
                                                    <Sequence sap2010:Annotation.AnnotationText="Verifica daca fisierul nu este deschis de alt program. Robotul incearca sa il acceseze si captureaza eventualele erori. Pentru a evita bucle infinite, dupa 100 accesari (aprox. 100 sec), trece mai departe" DisplayName="Do While - Verifica ca documentul este inchis" sap:VirtualizedContainerService.HintSize="334,198" sap2010:WorkflowViewState.IdRef="Sequence_2550">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1839">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Int32">[contor]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <DoWhile DisplayName="Do While - Verifica ca documentul este inchis" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="DoWhile_4">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <DoWhile.Condition>[fileLocked = True And contor &lt; 100]</DoWhile.Condition>
                                                        <TryCatch DisplayName="Verifica daca documentul e deschis de alt program" sap:VirtualizedContainerService.HintSize="438,293" sap2010:WorkflowViewState.IdRef="TryCatch_476">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <TryCatch.Try>
                                                            <Sequence DisplayName="Verifica daca documentul poate fi accesat" sap:VirtualizedContainerService.HintSize="304,524" sap2010:WorkflowViewState.IdRef="Sequence_2548">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1840">
                                                                <Assign.To>
                                                                  <OutArgument x:TypeArguments="x:Boolean">[fileLocked]</OutArgument>
                                                                </Assign.To>
                                                                <Assign.Value>
                                                                  <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                                                </Assign.Value>
                                                              </Assign>
                                                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1841">
                                                                <Assign.To>
                                                                  <OutArgument x:TypeArguments="x:Int32">[contor]</OutArgument>
                                                                </Assign.To>
                                                                <Assign.Value>
                                                                  <InArgument x:TypeArguments="x:Int32">[contor + 1]</InArgument>
                                                                </Assign.Value>
                                                              </Assign>
                                                              <Assign DisplayName="Create FileStream" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1842">
                                                                <Assign.To>
                                                                  <OutArgument x:TypeArguments="si:FileStream">[fs]</OutArgument>
                                                                </Assign.To>
                                                                <Assign.Value>
                                                                  <InArgument x:TypeArguments="si:FileStream">[System.IO.File.Open(NumeFisierPDF, FileMode.Open, FileAccess.Read, FileShare.None)]</InArgument>
                                                                </Assign.Value>
                                                              </Assign>
                                                              <InvokeMethod DisplayName="Invoke method" sap:VirtualizedContainerService.HintSize="262,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_86" MethodName="Close">
                                                                <InvokeMethod.TargetObject>
                                                                  <InArgument x:TypeArguments="si:FileStream">[fs]</InArgument>
                                                                </InvokeMethod.TargetObject>
                                                              </InvokeMethod>
                                                            </Sequence>
                                                          </TryCatch.Try>
                                                          <TryCatch.Catches>
                                                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_486">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <ActivityAction x:TypeArguments="s:Exception">
                                                                <ActivityAction.Argument>
                                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                </ActivityAction.Argument>
                                                                <Sequence DisplayName="Daca e folosit de alt proces" sap:VirtualizedContainerService.HintSize="526,359" sap2010:WorkflowViewState.IdRef="Sequence_2549">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <If Condition="[exception.Message.Contains(&quot;being used by another process&quot;)]" DisplayName="Daca e folosit de alt proces" sap:VirtualizedContainerService.HintSize="484,208" sap2010:WorkflowViewState.IdRef="If_870">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <If.Then>
                                                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1843">
                                                                        <Assign.To>
                                                                          <OutArgument x:TypeArguments="x:Boolean">[fileLocked]</OutArgument>
                                                                        </Assign.To>
                                                                        <Assign.Value>
                                                                          <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                                        </Assign.Value>
                                                                      </Assign>
                                                                    </If.Then>
                                                                  </If>
                                                                  <Delay Duration="00:00:01" sap:VirtualizedContainerService.HintSize="484,22" sap2010:WorkflowViewState.IdRef="Delay_77" />
                                                                </Sequence>
                                                              </ActivityAction>
                                                            </Catch>
                                                          </TryCatch.Catches>
                                                        </TryCatch>
                                                      </DoWhile>
                                                    </Sequence>
                                                    <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" DisplayName="Type into 'Edit'" EmptyField="True" sap:VirtualizedContainerService.HintSize="334,134" sap2010:WorkflowViewState.IdRef="TypeInto_1069" SendWindowMessages="False" SimulateType="True" Text="[NumeFisierPDF]">
                                                      <ui:TypeInto.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="b850919fb7620d4253b441dc0631db95" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd ctrlid='1148' aaname='File name:' cls='Edit' /&gt;" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                      </ui:TypeInto.Target>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:TypeInto>
                                                    <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="Click_538" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                                      <ui:Click.CursorPosition>
                                                        <ui:CursorPosition Position="Center">
                                                          <ui:CursorPosition.OffsetX>
                                                            <InArgument x:TypeArguments="x:Int32" />
                                                          </ui:CursorPosition.OffsetX>
                                                          <ui:CursorPosition.OffsetY>
                                                            <InArgument x:TypeArguments="x:Int32" />
                                                          </ui:CursorPosition.OffsetY>
                                                        </ui:CursorPosition>
                                                      </ui:Click.CursorPosition>
                                                      <ui:Click.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="474cce9474595b2a5db022e157af6695" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd ctrlid='1' title='&amp;amp;Open' aaname='Open' cls='Button' /&gt;" TimeoutMS="2000" WaitForReady="INTERACTIVE" />
                                                      </ui:Click.Target>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:Click>
                                                    <ui:UiElementExists DisplayName="Element Exists 'Explorer Pane'" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="UiElementExists_139">
                                                      <ui:UiElementExists.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="42108de8cedf275ef8779fdf5c720f93" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd aaname='Explorer Pane' cls='DirectUIHWND' /&gt;&lt;wnd ctrlid='1121' title='ShellView' /&gt;&lt;wnd aaname='Items View' cls='DirectUIHWND' /&gt;" TimeoutMS="300" WaitForReady="INTERACTIVE" />
                                                      </ui:UiElementExists.Target>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:UiElementExists>
                                                    <If Condition="[elementExists]" DisplayName="Daca nu s-a inchis inca fereastra Open file" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="If_820">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If.Then>
                                                        <ui:WaitUiElementVanish ContinueOnError="True" DisplayName="Wait Element Vanish" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="WaitUiElementVanish_1" WaitNotActive="False" WaitNotVisible="False">
                                                          <ui:WaitUiElementVanish.Target>
                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="42108de8cedf275ef8779fdf5c720f93" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd aaname='Explorer Pane' cls='DirectUIHWND' /&gt;&lt;wnd ctrlid='1121' title='ShellView' /&gt;&lt;wnd aaname='Items View' cls='DirectUIHWND' /&gt;" TimeoutMS="60000" WaitForReady="INTERACTIVE" />
                                                          </ui:WaitUiElementVanish.Target>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:WaitUiElementVanish>
                                                      </If.Then>
                                                    </If>
                                                    <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" DisplayName="Click 'INPUT  ctl00_ContentPla...'" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="Click_539" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                                      <ui:Click.CursorPosition>
                                                        <ui:CursorPosition OffsetX="14" OffsetY="9" Position="TopLeft" />
                                                      </ui:Click.CursorPosition>
                                                      <ui:Click.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="6cb46f98798a25ffd96c1b0ed7fe4cd3" Selector="&lt;html app='chrome.exe' title='ECRIS*' /&gt;&lt;webctrl id='ctl00_ContentPlaceHolder1_btnUpload' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                                      </ui:Click.Target>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:Click>
                                                  </Sequence>
                                                </ActivityAction>
                                              </ui:BrowserScope.Body>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:BrowserScope>
                                          </Sequence>
                                        </TryCatch.Try>
                                        <TryCatch.Catches>
                                          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,1749" sap2010:WorkflowViewState.IdRef="Catch`1_470">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ActivityAction x:TypeArguments="s:Exception">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Logheaza eroarea si redeschide Ecris" sap:VirtualizedContainerService.HintSize="242,1680" sap2010:WorkflowViewState.IdRef="Sequence_2489">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If sap2010:Annotation.AnnotationText="Daca nu se poate deschide fereastra Open file, ori sunt foarte multe instante offline, iar robotul nu reuseste maparea drive-urilor si are intarzieri mari (robotul lasa timp suficient pentru incarcarea instantelor si pentru a trece peste timeout-uri la mapari - aceasta eroare nu a mai aparut la autor de foarte mult timp), ori Chrome are probleme. Solutia este inchiderea Chrome, repornirea sa si logarea din nou in Ecris-urile tuturor instantelor." Condition="[exception.Message.Contains(&quot;Nu pot deschide fereastra Open file&quot;)]" DisplayName="Daca nu s-a putut deschide fereastra Open file" sap:VirtualizedContainerService.HintSize="200,318" sap2010:WorkflowViewState.IdRef="If_823">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <Sequence sap:VirtualizedContainerService.HintSize="242,660" sap2010:WorkflowViewState.IdRef="Sequence_2461">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_312" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(NumeFisierPDF) + &quot; - Nu pot deschide fereastra Open file in browser. Repornesc browser-ul si ma loghez din nou in Ecris-urile tuturor instantelor&quot;]">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:AppendLine>
                                                      <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_453">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <TryCatch.Try>
                                                          <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_456" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                            <ui:BrowserScope.Body>
                                                              <ActivityAction x:TypeArguments="x:Object">
                                                                <ActivityAction.Argument>
                                                                  <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                </ActivityAction.Argument>
                                                                <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2454">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_108" />
                                                                  <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1070" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                    <ui:TypeInto.Target>
                                                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                    </ui:TypeInto.Target>
                                                                  </ui:TypeInto>
                                                                </Sequence>
                                                              </ActivityAction>
                                                            </ui:BrowserScope.Body>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </ui:BrowserScope>
                                                        </TryCatch.Try>
                                                        <TryCatch.Catches>
                                                          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_463">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ActivityAction x:TypeArguments="s:Exception">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                              </ActivityAction.Argument>
                                                              <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_435" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                                <ui:OpenBrowser.Body>
                                                                  <ActivityAction x:TypeArguments="x:Object">
                                                                    <ActivityAction.Argument>
                                                                      <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                    </ActivityAction.Argument>
                                                                    <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2455">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1071" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                        <ui:TypeInto.Target>
                                                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                        </ui:TypeInto.Target>
                                                                      </ui:TypeInto>
                                                                    </Sequence>
                                                                  </ActivityAction>
                                                                </ui:OpenBrowser.Body>
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                              </ui:OpenBrowser>
                                                            </ActivityAction>
                                                          </Catch>
                                                        </TryCatch.Catches>
                                                      </TryCatch>
                                                      <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="434,266" sap2010:WorkflowViewState.IdRef="TryCatch_495">
                                                        <TryCatch.Try>
                                                          <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_60" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+NumeFisierPDF.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;', 18, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                            <ui:ExecuteNonQuery.Parameters>
                                                              <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                            </ui:ExecuteNonQuery.Parameters>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </ui:ExecuteNonQuery>
                                                        </TryCatch.Try>
                                                        <TryCatch.Catches>
                                                          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_505">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ActivityAction x:TypeArguments="s:Exception">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                              </ActivityAction.Argument>
                                                            </ActivityAction>
                                                          </Catch>
                                                        </TryCatch.Catches>
                                                      </TryCatch>
                                                      <ui:ForEach x:TypeArguments="sd:Process" CurrentIndex="{x:Null}" DisplayName="Inchide procesele Chrome" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ForEach`1_126" Values="[System.Diagnostics.Process.GetProcesses()]">
                                                        <ui:ForEach.Body>
                                                          <ActivityAction x:TypeArguments="sd:Process">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="sd:Process" Name="process" />
                                                            </ActivityAction.Argument>
                                                            <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="486,332" sap2010:WorkflowViewState.IdRef="Sequence_2456">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If Condition="[process.ProcessName.ToLower.Contains(&quot;chrome&quot;)]" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_821">
                                                                <If.Then>
                                                                  <ui:KillProcess ProcessName="{x:Null}" ContinueOnError="True" DisplayName="Kill Process" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="KillProcess_30" Process="[process]" />
                                                                </If.Then>
                                                              </If>
                                                            </Sequence>
                                                          </ActivityAction>
                                                        </ui:ForEach.Body>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:ForEach>
                                                      <ui:ForEach x:TypeArguments="scg:Dictionary(x:String, x:String)" CurrentIndex="{x:Null}" DisplayName="Login Ecris fiecare instanta" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ForEach`1_127" Values="[ConfigInstante]">
                                                        <ui:ForEach.Body>
                                                          <ActivityAction x:TypeArguments="scg:Dictionary(x:String, x:String)">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" Name="instanta" />
                                                            </ActivityAction.Argument>
                                                            <Sequence DisplayName="Login Ecris" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Sequence_2459">
                                                              <Sequence.Variables>
                                                                <Variable x:TypeArguments="x:Boolean" Name="elementExists" />
                                                              </Sequence.Variables>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <ui:UiElementExists DisplayName="Element Exists - check browser is open" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="464,106" sap2010:WorkflowViewState.IdRef="UiElementExists_140">
                                                                <ui:UiElementExists.Target>
                                                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="d2d3a449290d82e8f55c472d5b5def0c" Selector="&lt;html app='chrome.exe' /&gt;" TimeoutMS="1000" WaitForReady="INTERACTIVE" />
                                                                </ui:UiElementExists.Target>
                                                              </ui:UiElementExists>
                                                              <If Condition="[elementExists]" DisplayName="Daca browser is open" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_822">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <If.Then>
                                                                  <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Login Ecris - Attach Browser 'chrome.exe ECRIS'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_457" InformativeScreenshot="fa34b6cd81728ac7374bb60742a6a110" Selector="&lt;html app='chrome.exe' omit:title='ECRIS*' /&gt;" TimeoutMS="6000">
                                                                    <ui:BrowserScope.Body>
                                                                      <ActivityAction x:TypeArguments="x:Object">
                                                                        <ActivityAction.Argument>
                                                                          <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                        </ActivityAction.Argument>
                                                                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,823" sap2010:WorkflowViewState.IdRef="Sequence_2457">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <ui:NavigateTo Browser="{x:Null}" ContinueOnError="True" DisplayName="Navigate to" sap:VirtualizedContainerService.HintSize="314,59" sap2010:WorkflowViewState.IdRef="NavigateTo_113" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]" />
                                                                          <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists 'INPUT  utilizator''" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="UiElementExists_141">
                                                                            <ui:UiElementExists.Target>
                                                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                                                            </ui:UiElementExists.Target>
                                                                          </ui:UiElementExists>
                                                                          <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into 'INPUT  utilizator'" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_1072" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;UsernameEcris&quot;)]">
                                                                            <ui:TypeInto.Target>
                                                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                                                            </ui:TypeInto.Target>
                                                                          </ui:TypeInto>
                                                                          <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type Into" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_1073" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;PasswordEcris&quot;)]">
                                                                            <ui:TypeInto.Target>
                                                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="fca13b00c3148899b8eb6f9bb5589b8d" Selector="&lt;webctrl id='parola' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                            </ui:TypeInto.Target>
                                                                          </ui:TypeInto>
                                                                          <ui:Click DelayBefore="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayMS="2500" DisplayName="Click 'INPUT'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_540" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                                                            <ui:Click.CursorPosition>
                                                                              <ui:CursorPosition OffsetX="37" OffsetY="11" Position="TopLeft" />
                                                                            </ui:Click.CursorPosition>
                                                                            <ui:Click.Target>
                                                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="1ca5daac6a8c7a1ea0399caf19fc7557" Selector="&lt;webctrl name='Intra' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                            </ui:Click.Target>
                                                                          </ui:Click>
                                                                        </Sequence>
                                                                      </ActivityAction>
                                                                    </ui:BrowserScope.Body>
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </ui:BrowserScope>
                                                                </If.Then>
                                                                <If.Else>
                                                                  <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser Ecris" Hidden="False" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_436" NewSession="False" Private="True" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]">
                                                                    <ui:OpenBrowser.Body>
                                                                      <ActivityAction x:TypeArguments="x:Object">
                                                                        <ActivityAction.Argument>
                                                                          <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                        </ActivityAction.Argument>
                                                                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,724" sap2010:WorkflowViewState.IdRef="Sequence_2458">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                          <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists 'INPUT  utilizator''" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="UiElementExists_142">
                                                                            <ui:UiElementExists.Target>
                                                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                                                            </ui:UiElementExists.Target>
                                                                          </ui:UiElementExists>
                                                                          <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into 'INPUT  utilizator'" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_1074" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;UsernameEcris&quot;)]">
                                                                            <ui:TypeInto.Target>
                                                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                                                            </ui:TypeInto.Target>
                                                                          </ui:TypeInto>
                                                                          <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type Into" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_1075" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;PasswordEcris&quot;)]">
                                                                            <ui:TypeInto.Target>
                                                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="fca13b00c3148899b8eb6f9bb5589b8d" Selector="&lt;webctrl id='parola' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                            </ui:TypeInto.Target>
                                                                          </ui:TypeInto>
                                                                          <ui:Click DelayBefore="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayMS="2500" DisplayName="Click 'INPUT'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_541" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                                                            <ui:Click.CursorPosition>
                                                                              <ui:CursorPosition OffsetX="37" OffsetY="11" Position="TopLeft" />
                                                                            </ui:Click.CursorPosition>
                                                                            <ui:Click.Target>
                                                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="1ca5daac6a8c7a1ea0399caf19fc7557" Selector="&lt;webctrl name='Intra' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                            </ui:Click.Target>
                                                                          </ui:Click>
                                                                        </Sequence>
                                                                      </ActivityAction>
                                                                    </ui:OpenBrowser.Body>
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                  </ui:OpenBrowser>
                                                                </If.Else>
                                                              </If>
                                                            </Sequence>
                                                          </ActivityAction>
                                                        </ui:ForEach.Body>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:ForEach>
                                                      <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open log window" Hidden="False" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_437" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                        <ui:OpenBrowser.Body>
                                                          <ActivityAction x:TypeArguments="x:Object">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                            </ActivityAction.Argument>
                                                            <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2460">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1076" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                <ui:TypeInto.Target>
                                                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                </ui:TypeInto.Target>
                                                              </ui:TypeInto>
                                                            </Sequence>
                                                          </ActivityAction>
                                                        </ui:OpenBrowser.Body>
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:OpenBrowser>
                                                      <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_9" />
                                                    </Sequence>
                                                  </If.Then>
                                                </If>
                                                <Sequence sap2010:Annotation.AnnotationText="Aceasta eroare a aparut de cateva ori in cazul unor dosare foarte vechi (xxx/233/1986), iar solutia este mutarea fisierului in FolderErori pentru ca angajatii sa incerce o urcare manuala." DisplayName="Daca dosar foarte vechi si nu poate urca citatia" sap:VirtualizedContainerService.HintSize="200,183" sap2010:WorkflowViewState.IdRef="Sequence_2465">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:UiElementExists DisplayName="Element Exists 'DIV  ctl00_ContentPlace...'" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="UiElementExists_143">
                                                    <ui:UiElementExists.Target>
                                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="e9c850cbca65acd9c9cbe5d2af41bb82" Selector="&lt;html app='chrome.exe' title='ECRIS*' /&gt;&lt;webctrl css-selector='body&amp;gt;div&amp;gt;h1' tag='H1' aaname='ERROARE ' innertext='ERROARE ' class='MesajEroare' /&gt;" TimeoutMS="200" WaitForReady="INTERACTIVE" />
                                                    </ui:UiElementExists.Target>
                                                  </ui:UiElementExists>
                                                  <If Condition="[elementExists]" sap:VirtualizedContainerService.HintSize="484,214" sap2010:WorkflowViewState.IdRef="If_825">
                                                    <If.Then>
                                                      <Sequence DisplayName="Sequence" sap:VirtualizedContainerService.HintSize="242,569" sap2010:WorkflowViewState.IdRef="Sequence_2464">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)]" DisplayName="Move file TXT to Erori" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="MoveFile_125" Overwrite="True" Path="[file]" />
                                                        <If Condition="[System.IO.File.Exists(instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileName(NumeFisierPDF))]" DisplayName="Move file PDF to Erori" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_824">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <If.Then>
                                                            <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(NumeFisierPDF)+&quot;_mutat_ora_&quot;+DateTime.Now.ToString(&quot;HH-mm&quot;)+Path.GetExtension(NumeFisierPDF)]" DisplayName="Move PDF to Erori redenumit" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_126" Overwrite="True" Path="[NumeFisierPDF]" />
                                                          </If.Then>
                                                          <If.Else>
                                                            <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)]" DisplayName="Move PDF to Erori" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_127" Overwrite="True" Path="[NumeFisierPDF]" />
                                                          </If.Else>
                                                        </If>
                                                        <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_313" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Nu am reusit sa urc citatia la dosarul nr. &quot; + NrDosar + &quot;. Dosarul este probabil foarte vechi si Ecris genereaza o eroare la accesarea paginii documentului - EROARE&quot;]">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:AppendLine>
                                                        <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_454">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <TryCatch.Try>
                                                            <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_458" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                              <ui:BrowserScope.Body>
                                                                <ActivityAction x:TypeArguments="x:Object">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                  </ActivityAction.Argument>
                                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2462">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_109" />
                                                                    <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1077" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                      <ui:TypeInto.Target>
                                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                      </ui:TypeInto.Target>
                                                                    </ui:TypeInto>
                                                                  </Sequence>
                                                                </ActivityAction>
                                                              </ui:BrowserScope.Body>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:BrowserScope>
                                                          </TryCatch.Try>
                                                          <TryCatch.Catches>
                                                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_464">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <ActivityAction x:TypeArguments="s:Exception">
                                                                <ActivityAction.Argument>
                                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                </ActivityAction.Argument>
                                                                <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_438" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                                  <ui:OpenBrowser.Body>
                                                                    <ActivityAction x:TypeArguments="x:Object">
                                                                      <ActivityAction.Argument>
                                                                        <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                      </ActivityAction.Argument>
                                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2463">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1078" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                          <ui:TypeInto.Target>
                                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                          </ui:TypeInto.Target>
                                                                        </ui:TypeInto>
                                                                      </Sequence>
                                                                    </ActivityAction>
                                                                  </ui:OpenBrowser.Body>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:OpenBrowser>
                                                              </ActivityAction>
                                                            </Catch>
                                                          </TryCatch.Catches>
                                                        </TryCatch>
                                                        <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="434,266" sap2010:WorkflowViewState.IdRef="TryCatch_496">
                                                          <TryCatch.Try>
                                                            <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_61" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+NumeFisierPDF.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;', 19, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                              <ui:ExecuteNonQuery.Parameters>
                                                                <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                              </ui:ExecuteNonQuery.Parameters>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:ExecuteNonQuery>
                                                          </TryCatch.Try>
                                                          <TryCatch.Catches>
                                                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_506">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <ActivityAction x:TypeArguments="s:Exception">
                                                                <ActivityAction.Argument>
                                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                </ActivityAction.Argument>
                                                              </ActivityAction>
                                                            </Catch>
                                                          </TryCatch.Catches>
                                                        </TryCatch>
                                                        <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_10" />
                                                      </Sequence>
                                                    </If.Then>
                                                  </If>
                                                </Sequence>
                                                <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_314" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(NumeFisierPDF) + &quot; - Nu am reusit sa urc citatia in Ecris la dosarul nr. &quot; + NrDosar + &quot;. Probabil nu m-am putut conecta la Ecris. Voi incerca mai tarziu&quot;]">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:AppendLine>
                                                <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_455">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <TryCatch.Try>
                                                    <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_459" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                      <ui:BrowserScope.Body>
                                                        <ActivityAction x:TypeArguments="x:Object">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2466">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_110" />
                                                            <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1079" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                              <ui:TypeInto.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                              </ui:TypeInto.Target>
                                                            </ui:TypeInto>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:BrowserScope.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:BrowserScope>
                                                  </TryCatch.Try>
                                                  <TryCatch.Catches>
                                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_465">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                        </ActivityAction.Argument>
                                                        <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_439" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                          <ui:OpenBrowser.Body>
                                                            <ActivityAction x:TypeArguments="x:Object">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                              </ActivityAction.Argument>
                                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2467">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1080" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                  <ui:TypeInto.Target>
                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                  </ui:TypeInto.Target>
                                                                </ui:TypeInto>
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </ui:OpenBrowser.Body>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:OpenBrowser>
                                                      </ActivityAction>
                                                    </Catch>
                                                  </TryCatch.Catches>
                                                </TryCatch>
                                                <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_497">
                                                  <TryCatch.Try>
                                                    <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_62" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+NumeFisierPDF.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;', 8, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                      <ui:ExecuteNonQuery.Parameters>
                                                        <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                      </ui:ExecuteNonQuery.Parameters>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:ExecuteNonQuery>
                                                  </TryCatch.Try>
                                                  <TryCatch.Catches>
                                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_507">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                        </ActivityAction.Argument>
                                                      </ActivityAction>
                                                    </Catch>
                                                  </TryCatch.Catches>
                                                </TryCatch>
                                                <Sequence sap2010:Annotation.AnnotationText="Verifica daca Ecris nu a dat eroare 404, un mesaj de eroare specific Ecris diferit de cel al browser-ului. In caz afirmativ, repeta procedura de logare in Ecris la instanta respectiva." DisplayName="Verifica eroarea 404" sap:VirtualizedContainerService.HintSize="200,183" sap2010:WorkflowViewState.IdRef="Sequence_2472">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:UiElementExists DisplayName="Element Exists '404'" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="UiElementExists_144">
                                                    <ui:UiElementExists.Target>
                                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="&lt;html app='chrome.exe' title='*404*' /&gt;" TimeoutMS="500" WaitForReady="COMPLETE" />
                                                    </ui:UiElementExists.Target>
                                                  </ui:UiElementExists>
                                                  <If Condition="[elementExists]" DisplayName="Daca a dat eroare 404" sap:VirtualizedContainerService.HintSize="484,214" sap2010:WorkflowViewState.IdRef="If_826">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <If.Then>
                                                      <Sequence sap:VirtualizedContainerService.HintSize="242,478" sap2010:WorkflowViewState.IdRef="Sequence_2471">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_315" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(NumeFisierPDF) + &quot; - Eroarea de mai sus a fost cauzata de Ecris printr-un mesaj 404&quot;]">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:AppendLine>
                                                        <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_456">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <TryCatch.Try>
                                                            <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_460" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                              <ui:BrowserScope.Body>
                                                                <ActivityAction x:TypeArguments="x:Object">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                  </ActivityAction.Argument>
                                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2468">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_111" />
                                                                    <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1081" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                      <ui:TypeInto.Target>
                                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                      </ui:TypeInto.Target>
                                                                    </ui:TypeInto>
                                                                  </Sequence>
                                                                </ActivityAction>
                                                              </ui:BrowserScope.Body>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:BrowserScope>
                                                          </TryCatch.Try>
                                                          <TryCatch.Catches>
                                                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_466">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <ActivityAction x:TypeArguments="s:Exception">
                                                                <ActivityAction.Argument>
                                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                </ActivityAction.Argument>
                                                                <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_440" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                                  <ui:OpenBrowser.Body>
                                                                    <ActivityAction x:TypeArguments="x:Object">
                                                                      <ActivityAction.Argument>
                                                                        <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                      </ActivityAction.Argument>
                                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2469">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1082" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                          <ui:TypeInto.Target>
                                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                          </ui:TypeInto.Target>
                                                                        </ui:TypeInto>
                                                                      </Sequence>
                                                                    </ActivityAction>
                                                                  </ui:OpenBrowser.Body>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:OpenBrowser>
                                                              </ActivityAction>
                                                            </Catch>
                                                          </TryCatch.Catches>
                                                        </TryCatch>
                                                        <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="434,266" sap2010:WorkflowViewState.IdRef="TryCatch_498">
                                                          <TryCatch.Try>
                                                            <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_63" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+NumeFisierPDF.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;', 7, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                              <ui:ExecuteNonQuery.Parameters>
                                                                <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                              </ui:ExecuteNonQuery.Parameters>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:ExecuteNonQuery>
                                                          </TryCatch.Try>
                                                          <TryCatch.Catches>
                                                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_508">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <ActivityAction x:TypeArguments="s:Exception">
                                                                <ActivityAction.Argument>
                                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                </ActivityAction.Argument>
                                                              </ActivityAction>
                                                            </Catch>
                                                          </TryCatch.Catches>
                                                        </TryCatch>
                                                        <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Login Ecris - Attach Browser 'chrome.exe ECRIS'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_461" InformativeScreenshot="fa34b6cd81728ac7374bb60742a6a110" Selector="&lt;html app='chrome.exe' omit:title='ECRIS*' /&gt;" TimeoutMS="6000">
                                                          <ui:BrowserScope.Body>
                                                            <ActivityAction x:TypeArguments="x:Object">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                              </ActivityAction.Argument>
                                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,823" sap2010:WorkflowViewState.IdRef="Sequence_2470">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:NavigateTo Browser="{x:Null}" ContinueOnError="True" DisplayName="Navigate to" sap:VirtualizedContainerService.HintSize="314,59" sap2010:WorkflowViewState.IdRef="NavigateTo_114" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]" />
                                                                <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists 'INPUT  utilizator''" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="UiElementExists_145">
                                                                  <ui:UiElementExists.Target>
                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                                                  </ui:UiElementExists.Target>
                                                                </ui:UiElementExists>
                                                                <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into 'INPUT  utilizator'" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_1083" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;UsernameEcris&quot;)]">
                                                                  <ui:TypeInto.Target>
                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                                                  </ui:TypeInto.Target>
                                                                </ui:TypeInto>
                                                                <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type Into" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_1084" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;PasswordEcris&quot;)]">
                                                                  <ui:TypeInto.Target>
                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="fca13b00c3148899b8eb6f9bb5589b8d" Selector="&lt;webctrl id='parola' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                  </ui:TypeInto.Target>
                                                                </ui:TypeInto>
                                                                <ui:Click DelayBefore="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayMS="2500" DisplayName="Click 'INPUT'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_542" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                                                  <ui:Click.CursorPosition>
                                                                    <ui:CursorPosition OffsetX="37" OffsetY="11" Position="TopLeft" />
                                                                  </ui:Click.CursorPosition>
                                                                  <ui:Click.Target>
                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="1ca5daac6a8c7a1ea0399caf19fc7557" Selector="&lt;webctrl name='Intra' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                  </ui:Click.Target>
                                                                </ui:Click>
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </ui:BrowserScope.Body>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:BrowserScope>
                                                        <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_11" />
                                                      </Sequence>
                                                    </If.Then>
                                                  </If>
                                                </Sequence>
                                                <If sap2010:Annotation.AnnotationText="Dupa un timp de inactivitate, utilizatorul este automat delogat (signed out) din Ecris, caz in care robotul noteaza eroarea si incearca relogarea in Ecris-ul respectivei instante." Condition="[elementExists]" DisplayName="Verifica logged out of Ecris" sap:VirtualizedContainerService.HintSize="200,168" sap2010:WorkflowViewState.IdRef="If_828">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Else>
                                                    <Sequence DisplayName="Verifica logged out of Ecris" sap:VirtualizedContainerService.HintSize="242,325" sap2010:WorkflowViewState.IdRef="Sequence_2476">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:CloseWindow TimeoutMS="{x:Null}" UseWindow="{x:Null}" DisplayName="Close log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="CloseWindow_1" InformativeScreenshot="6aff76514b3612a61f867918adb0578f" Selector="[&quot;&lt;html app='chrome.exe' url='*&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)+&quot;*' /&gt;&quot;]" WaitForReady="COMPLETE">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                      </ui:CloseWindow>
                                                      <ui:UiElementExists DisplayName="Element Exists - check logged out of Ecris" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="UiElementExists_146">
                                                        <ui:UiElementExists.Target>
                                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="d182e6e30fa371617c7903f91a2bceb5" Selector="&lt;html app='chrome.exe' title='*' /&gt;" TimeoutMS="3000" WaitForReady="INTERACTIVE" />
                                                        </ui:UiElementExists.Target>
                                                      </ui:UiElementExists>
                                                      <If Condition="[elementExists]" DisplayName="Daca logged out of Ecris" sap:VirtualizedContainerService.HintSize="484,214" sap2010:WorkflowViewState.IdRef="If_827">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence sap:VirtualizedContainerService.HintSize="242,478" sap2010:WorkflowViewState.IdRef="Sequence_2475">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Login Ecris - Attach Browser 'chrome.exe ECRIS'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_462" InformativeScreenshot="fa34b6cd81728ac7374bb60742a6a110" Selector="&lt;html app='chrome.exe' omit:title='ECRIS*' /&gt;" TimeoutMS="6000">
                                                              <ui:BrowserScope.Body>
                                                                <ActivityAction x:TypeArguments="x:Object">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                  </ActivityAction.Argument>
                                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,823" sap2010:WorkflowViewState.IdRef="Sequence_2473">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:NavigateTo Browser="{x:Null}" ContinueOnError="True" DisplayName="Navigate to" sap:VirtualizedContainerService.HintSize="314,59" sap2010:WorkflowViewState.IdRef="NavigateTo_115" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]" />
                                                                    <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists 'INPUT  utilizator''" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="UiElementExists_147">
                                                                      <ui:UiElementExists.Target>
                                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                                                      </ui:UiElementExists.Target>
                                                                    </ui:UiElementExists>
                                                                    <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into 'INPUT  utilizator'" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_1085" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;UsernameEcris&quot;)]">
                                                                      <ui:TypeInto.Target>
                                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                                                      </ui:TypeInto.Target>
                                                                    </ui:TypeInto>
                                                                    <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type Into" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_1086" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;PasswordEcris&quot;)]">
                                                                      <ui:TypeInto.Target>
                                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="fca13b00c3148899b8eb6f9bb5589b8d" Selector="&lt;webctrl id='parola' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                      </ui:TypeInto.Target>
                                                                    </ui:TypeInto>
                                                                    <ui:Click DelayBefore="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayMS="2500" DisplayName="Click 'INPUT'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_543" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                                                      <ui:Click.CursorPosition>
                                                                        <ui:CursorPosition OffsetX="37" OffsetY="11" Position="TopLeft" />
                                                                      </ui:Click.CursorPosition>
                                                                      <ui:Click.Target>
                                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="1ca5daac6a8c7a1ea0399caf19fc7557" Selector="&lt;webctrl name='Intra' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                      </ui:Click.Target>
                                                                    </ui:Click>
                                                                  </Sequence>
                                                                </ActivityAction>
                                                              </ui:BrowserScope.Body>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:BrowserScope>
                                                            <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_316" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(NumeFisierPDF) + &quot; - Am procedat la logarea din nou in Ecris-ul acestei instante&quot;]">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:AppendLine>
                                                            <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open log window" Hidden="False" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_441" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                              <ui:OpenBrowser.Body>
                                                                <ActivityAction x:TypeArguments="x:Object">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                  </ActivityAction.Argument>
                                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2474">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1087" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                      <ui:TypeInto.Target>
                                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                      </ui:TypeInto.Target>
                                                                    </ui:TypeInto>
                                                                  </Sequence>
                                                                </ActivityAction>
                                                              </ui:OpenBrowser.Body>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:OpenBrowser>
                                                            <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="434,266" sap2010:WorkflowViewState.IdRef="TryCatch_499">
                                                              <TryCatch.Try>
                                                                <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_64" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+NumeFisierPDF.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;', 4, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                                  <ui:ExecuteNonQuery.Parameters>
                                                                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                                  </ui:ExecuteNonQuery.Parameters>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:ExecuteNonQuery>
                                                              </TryCatch.Try>
                                                              <TryCatch.Catches>
                                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_509">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                                    <ActivityAction.Argument>
                                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                    </ActivityAction.Argument>
                                                                  </ActivityAction>
                                                                </Catch>
                                                              </TryCatch.Catches>
                                                            </TryCatch>
                                                            <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_12" />
                                                          </Sequence>
                                                        </If.Then>
                                                      </If>
                                                    </Sequence>
                                                  </If.Else>
                                                </If>
                                                <If sap2010:Annotation.AnnotationText="Uneori serverul Ecris nu raspunde sau browser-ul a fost inchis de utilizator si robotul nu se poate conecta. In aceste cazuri, robotul verifica daca IP Ecris este online. In caz negativ, instanta este marcata offline pentru a fi sarita 5 minute si se trimite un email administratorului. In caz contrar, se presupune ca browser-ul este inchis, se redeschide browser-ul si se logheaza din nou in Ecris-urile tuturor instantelor." Condition="[elementExists]" DisplayName="Verifica server unreachable" sap:VirtualizedContainerService.HintSize="484,301" sap2010:WorkflowViewState.IdRef="If_833">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Else>
                                                    <Sequence DisplayName="Verifica server unreachable" sap:VirtualizedContainerService.HintSize="304,305" sap2010:WorkflowViewState.IdRef="Sequence_2488">
                                                      <Sequence.Variables>
                                                        <Variable x:TypeArguments="x:Int32" Name="statusCode" />
                                                      </Sequence.Variables>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <Assign DisplayName="Initializare variabila" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1792">
                                                        <Assign.To>
                                                          <OutArgument x:TypeArguments="x:Int32">[statusCode]</OutArgument>
                                                        </Assign.To>
                                                        <Assign.Value>
                                                          <InArgument x:TypeArguments="x:Int32">0</InArgument>
                                                        </Assign.Value>
                                                      </Assign>
                                                      <ui:HttpClient Body="{x:Null}" ClientCertificate="{x:Null}" ClientCertificatePassword="{x:Null}" ConsumerKey="{x:Null}" ConsumerSecret="{x:Null}" OAuth1Token="{x:Null}" OAuth1TokenSecret="{x:Null}" OAuth2Token="{x:Null}" Password="{x:Null}" ResourcePath="{x:Null}" ResponseHeaders="{x:Null}" Result="{x:Null}" Username="{x:Null}" AcceptFormat="ANY" BodyFormat="application/xml" ContinueOnError="True" DisplayName="Verifica server Ecris HTTP Request" EndPoint="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]" sap:VirtualizedContainerService.HintSize="262,22" sap2010:WorkflowViewState.IdRef="HttpClient_1" Method="GET" StatusCode="[statusCode]" TimeoutMS="6000">
                                                        <ui:HttpClient.Attachments>
                                                          <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                                        </ui:HttpClient.Attachments>
                                                        <ui:HttpClient.Cookies>
                                                          <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                                        </ui:HttpClient.Cookies>
                                                        <ui:HttpClient.Headers>
                                                          <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                                        </ui:HttpClient.Headers>
                                                        <ui:HttpClient.Parameters>
                                                          <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                                        </ui:HttpClient.Parameters>
                                                        <ui:HttpClient.UrlSegments>
                                                          <scg:Dictionary x:TypeArguments="x:String, InArgument(x:String)" />
                                                        </ui:HttpClient.UrlSegments>
                                                      </ui:HttpClient>
                                                      <If Condition="[statusCode &lt;&gt; HttpStatusCode.OK]" DisplayName="Fie server Ecris unreachable, fie browser-ul e inchis" sap:VirtualizedContainerService.HintSize="484,214" sap2010:WorkflowViewState.IdRef="If_832">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <If.Then>
                                                          <Sequence sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2479">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="AppendLine_317" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot;] Nu pot contacta serverul Ecris la adresa IP &quot;+instanta(&quot;IPecris&quot;)+&quot; HTTP StatusCode: &quot;+statusCode.ToString+&quot; - EROARE&quot;]">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:AppendLine>
                                                            <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_457">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <TryCatch.Try>
                                                                <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_463" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                                  <ui:BrowserScope.Body>
                                                                    <ActivityAction x:TypeArguments="x:Object">
                                                                      <ActivityAction.Argument>
                                                                        <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                      </ActivityAction.Argument>
                                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2477">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_112" />
                                                                        <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1088" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                          <ui:TypeInto.Target>
                                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                          </ui:TypeInto.Target>
                                                                        </ui:TypeInto>
                                                                      </Sequence>
                                                                    </ActivityAction>
                                                                  </ui:BrowserScope.Body>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:BrowserScope>
                                                              </TryCatch.Try>
                                                              <TryCatch.Catches>
                                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_467">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                                    <ActivityAction.Argument>
                                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                    </ActivityAction.Argument>
                                                                    <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_442" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                                      <ui:OpenBrowser.Body>
                                                                        <ActivityAction x:TypeArguments="x:Object">
                                                                          <ActivityAction.Argument>
                                                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                          </ActivityAction.Argument>
                                                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2478">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1089" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                              <ui:TypeInto.Target>
                                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                              </ui:TypeInto.Target>
                                                                            </ui:TypeInto>
                                                                          </Sequence>
                                                                        </ActivityAction>
                                                                      </ui:OpenBrowser.Body>
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                    </ui:OpenBrowser>
                                                                  </ActivityAction>
                                                                </Catch>
                                                              </TryCatch.Catches>
                                                            </TryCatch>
                                                            <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_500">
                                                              <TryCatch.Try>
                                                                <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_65" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+NumeFisierPDF.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;', 6, 'Nu pot contacta serverul Ecris la adresa IP &quot;+instanta(&quot;IPecris&quot;)+&quot; HTTP StatusCode: &quot;+statusCode.ToString+&quot; - EROARE');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                                  <ui:ExecuteNonQuery.Parameters>
                                                                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                                  </ui:ExecuteNonQuery.Parameters>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:ExecuteNonQuery>
                                                              </TryCatch.Try>
                                                              <TryCatch.Catches>
                                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_510">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                                    <ActivityAction.Argument>
                                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                    </ActivityAction.Argument>
                                                                  </ActivityAction>
                                                                </Catch>
                                                              </TryCatch.Catches>
                                                            </TryCatch>
                                                            <If Condition="[instanta(&quot;Offline&quot;).StartsWith(&quot;nu&quot;) OR (instanta(&quot;Offline&quot;).StartsWith(&quot;da&quot;) AND (DateTime.Now - Convert.ToDateTime(instanta(&quot;OraUltimulEmail&quot;))).TotalHours &gt;= 12)]" DisplayName="Trimite email cu eroarea" sap:VirtualizedContainerService.HintSize="484,208" sap2010:WorkflowViewState.IdRef="If_829">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <If.Then>
                                                                <TryCatch DisplayName="Trimite email cu eroarea" sap:VirtualizedContainerService.HintSize="434,282" sap2010:WorkflowViewState.IdRef="TryCatch_458">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <TryCatch.Try>
                                                                    <InvokeMethod DisplayName="Send email Invoke method" sap:VirtualizedContainerService.HintSize="238,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_84" MethodName="Send">
                                                                      <InvokeMethod.TargetObject>
                                                                        <InArgument x:TypeArguments="snm:SmtpClient">[new SmtpClient(instanta("IPsmtp"), Convert.ToInt32(instanta("PortSmtp")))]</InArgument>
                                                                      </InvokeMethod.TargetObject>
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <InArgument x:TypeArguments="x:String">[instanta("EmailSenderRobot")]</InArgument>
                                                                      <InArgument x:TypeArguments="x:String">[instanta("DestinatariEmailEroare")]</InArgument>
                                                                      <InArgument x:TypeArguments="x:String">["["+ instanta("NumeInstanta").ToUpper +"] Robotul UiPath a intalnit o eroare"]</InArgument>
                                                                      <InArgument x:TypeArguments="x:String">["["+ instanta("NumeInstanta").ToUpper +"] Robot UiPath - Eroare in procedura de urcare Documente scanate in Ecris. Nu pot contacta serverul Ecris la adresa IP "+instanta("IPecris")+" HTTP StatusCode: "+statusCode.ToString]</InArgument>
                                                                    </InvokeMethod>
                                                                  </TryCatch.Try>
                                                                  <TryCatch.Catches>
                                                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,120" sap2010:WorkflowViewState.IdRef="Catch`1_468">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                                        <ActivityAction.Argument>
                                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                        </ActivityAction.Argument>
                                                                        <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="334,132" sap2010:WorkflowViewState.IdRef="AppendLine_318" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot;] Nu am putut trimite e-mail cu eroarea.&quot;]">
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                        </ui:AppendLine>
                                                                      </ActivityAction>
                                                                    </Catch>
                                                                  </TryCatch.Catches>
                                                                  <TryCatch.Finally>
                                                                    <Assign DisplayName="Marcheaza ora ultimului email" sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1793">
                                                                      <Assign.To>
                                                                        <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("OraUltimulEmail")]</OutArgument>
                                                                      </Assign.To>
                                                                      <Assign.Value>
                                                                        <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString]</InArgument>
                                                                      </Assign.Value>
                                                                    </Assign>
                                                                  </TryCatch.Finally>
                                                                </TryCatch>
                                                              </If.Then>
                                                            </If>
                                                            <Assign DisplayName="Marcheaza ora instanta offline" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1794">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("Offline")]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:String">["da=" + DateTime.Now.ToString]</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <ui:Break sap:VirtualizedContainerService.HintSize="262,22" sap2010:WorkflowViewState.IdRef="Break_1" />
                                                          </Sequence>
                                                        </If.Then>
                                                        <If.Else>
                                                          <Sequence sap:VirtualizedContainerService.HintSize="242,660" sap2010:WorkflowViewState.IdRef="Sequence_2487">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_319" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Cred ca browser-ul este inchis. Il repornesc si ma loghez din nou in Ecris-urile tuturor instantelor&quot;]">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:AppendLine>
                                                            <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_459">
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                              <TryCatch.Try>
                                                                <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_464" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                                  <ui:BrowserScope.Body>
                                                                    <ActivityAction x:TypeArguments="x:Object">
                                                                      <ActivityAction.Argument>
                                                                        <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                      </ActivityAction.Argument>
                                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2480">
                                                                        <sap:WorkflowViewStateService.ViewState>
                                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          </scg:Dictionary>
                                                                        </sap:WorkflowViewStateService.ViewState>
                                                                        <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_113" />
                                                                        <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1090" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                          <ui:TypeInto.Target>
                                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                          </ui:TypeInto.Target>
                                                                        </ui:TypeInto>
                                                                      </Sequence>
                                                                    </ActivityAction>
                                                                  </ui:BrowserScope.Body>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:BrowserScope>
                                                              </TryCatch.Try>
                                                              <TryCatch.Catches>
                                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_469">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                                    <ActivityAction.Argument>
                                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                    </ActivityAction.Argument>
                                                                    <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_443" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                                      <ui:OpenBrowser.Body>
                                                                        <ActivityAction x:TypeArguments="x:Object">
                                                                          <ActivityAction.Argument>
                                                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                          </ActivityAction.Argument>
                                                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2481">
                                                                            <sap:WorkflowViewStateService.ViewState>
                                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                              </scg:Dictionary>
                                                                            </sap:WorkflowViewStateService.ViewState>
                                                                            <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1091" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                              <ui:TypeInto.Target>
                                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                              </ui:TypeInto.Target>
                                                                            </ui:TypeInto>
                                                                          </Sequence>
                                                                        </ActivityAction>
                                                                      </ui:OpenBrowser.Body>
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                    </ui:OpenBrowser>
                                                                  </ActivityAction>
                                                                </Catch>
                                                              </TryCatch.Catches>
                                                            </TryCatch>
                                                            <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_501">
                                                              <TryCatch.Try>
                                                                <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_66" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+NumeFisierPDF.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;', 5, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                                  <ui:ExecuteNonQuery.Parameters>
                                                                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                                  </ui:ExecuteNonQuery.Parameters>
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                </ui:ExecuteNonQuery>
                                                              </TryCatch.Try>
                                                              <TryCatch.Catches>
                                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_511">
                                                                  <sap:WorkflowViewStateService.ViewState>
                                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                    </scg:Dictionary>
                                                                  </sap:WorkflowViewStateService.ViewState>
                                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                                    <ActivityAction.Argument>
                                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                    </ActivityAction.Argument>
                                                                  </ActivityAction>
                                                                </Catch>
                                                              </TryCatch.Catches>
                                                            </TryCatch>
                                                            <ui:ForEach x:TypeArguments="sd:Process" CurrentIndex="{x:Null}" DisplayName="Inchide procesele Chrome" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ForEach`1_128" Values="[System.Diagnostics.Process.GetProcesses()]">
                                                              <ui:ForEach.Body>
                                                                <ActivityAction x:TypeArguments="sd:Process">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="sd:Process" Name="process" />
                                                                  </ActivityAction.Argument>
                                                                  <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="486,332" sap2010:WorkflowViewState.IdRef="Sequence_2482">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <If Condition="[process.ProcessName.ToLower.Contains(&quot;chrome&quot;)]" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_830">
                                                                      <If.Then>
                                                                        <ui:KillProcess ProcessName="{x:Null}" ContinueOnError="True" DisplayName="Kill Process" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="KillProcess_31" Process="[process]" />
                                                                      </If.Then>
                                                                    </If>
                                                                  </Sequence>
                                                                </ActivityAction>
                                                              </ui:ForEach.Body>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:ForEach>
                                                            <ui:ForEach x:TypeArguments="scg:Dictionary(x:String, x:String)" CurrentIndex="{x:Null}" DisplayName="Login Ecris fiecare instanta" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ForEach`1_129" Values="[ConfigInstante]">
                                                              <ui:ForEach.Body>
                                                                <ActivityAction x:TypeArguments="scg:Dictionary(x:String, x:String)">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" Name="instanta" />
                                                                  </ActivityAction.Argument>
                                                                  <Sequence DisplayName="Login Ecris" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="Sequence_2485">
                                                                    <Sequence.Variables>
                                                                      <Variable x:TypeArguments="x:Boolean" Name="elementExists" />
                                                                    </Sequence.Variables>
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:UiElementExists DisplayName="Element Exists - check browser is open" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="464,106" sap2010:WorkflowViewState.IdRef="UiElementExists_148">
                                                                      <ui:UiElementExists.Target>
                                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="d2d3a449290d82e8f55c472d5b5def0c" Selector="&lt;html app='chrome.exe' /&gt;" TimeoutMS="1000" WaitForReady="INTERACTIVE" />
                                                                      </ui:UiElementExists.Target>
                                                                    </ui:UiElementExists>
                                                                    <If Condition="[elementExists]" DisplayName="Daca browser is open" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_831">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <If.Then>
                                                                        <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Login Ecris - Attach Browser 'chrome.exe ECRIS'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_465" InformativeScreenshot="fa34b6cd81728ac7374bb60742a6a110" Selector="&lt;html app='chrome.exe' omit:title='ECRIS*' /&gt;" TimeoutMS="6000">
                                                                          <ui:BrowserScope.Body>
                                                                            <ActivityAction x:TypeArguments="x:Object">
                                                                              <ActivityAction.Argument>
                                                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                              </ActivityAction.Argument>
                                                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,823" sap2010:WorkflowViewState.IdRef="Sequence_2483">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <ui:NavigateTo Browser="{x:Null}" ContinueOnError="True" DisplayName="Navigate to" sap:VirtualizedContainerService.HintSize="314,59" sap2010:WorkflowViewState.IdRef="NavigateTo_116" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]" />
                                                                                <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists 'INPUT  utilizator''" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="UiElementExists_149">
                                                                                  <ui:UiElementExists.Target>
                                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                                                                  </ui:UiElementExists.Target>
                                                                                </ui:UiElementExists>
                                                                                <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into 'INPUT  utilizator'" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_1092" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;UsernameEcris&quot;)]">
                                                                                  <ui:TypeInto.Target>
                                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                                                                  </ui:TypeInto.Target>
                                                                                </ui:TypeInto>
                                                                                <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type Into" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_1093" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;PasswordEcris&quot;)]">
                                                                                  <ui:TypeInto.Target>
                                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="fca13b00c3148899b8eb6f9bb5589b8d" Selector="&lt;webctrl id='parola' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                                  </ui:TypeInto.Target>
                                                                                </ui:TypeInto>
                                                                                <ui:Click DelayBefore="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayMS="2500" DisplayName="Click 'INPUT'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_544" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                                                                  <ui:Click.CursorPosition>
                                                                                    <ui:CursorPosition OffsetX="37" OffsetY="11" Position="TopLeft" />
                                                                                  </ui:Click.CursorPosition>
                                                                                  <ui:Click.Target>
                                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="1ca5daac6a8c7a1ea0399caf19fc7557" Selector="&lt;webctrl name='Intra' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                                  </ui:Click.Target>
                                                                                </ui:Click>
                                                                              </Sequence>
                                                                            </ActivityAction>
                                                                          </ui:BrowserScope.Body>
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                        </ui:BrowserScope>
                                                                      </If.Then>
                                                                      <If.Else>
                                                                        <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser Ecris" Hidden="False" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_444" NewSession="False" Private="True" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]">
                                                                          <ui:OpenBrowser.Body>
                                                                            <ActivityAction x:TypeArguments="x:Object">
                                                                              <ActivityAction.Argument>
                                                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                              </ActivityAction.Argument>
                                                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,724" sap2010:WorkflowViewState.IdRef="Sequence_2484">
                                                                                <sap:WorkflowViewStateService.ViewState>
                                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                                  </scg:Dictionary>
                                                                                </sap:WorkflowViewStateService.ViewState>
                                                                                <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists 'INPUT  utilizator''" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="UiElementExists_150">
                                                                                  <ui:UiElementExists.Target>
                                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                                                                  </ui:UiElementExists.Target>
                                                                                </ui:UiElementExists>
                                                                                <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into 'INPUT  utilizator'" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_1094" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;UsernameEcris&quot;)]">
                                                                                  <ui:TypeInto.Target>
                                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                                                                  </ui:TypeInto.Target>
                                                                                </ui:TypeInto>
                                                                                <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type Into" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_1095" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;PasswordEcris&quot;)]">
                                                                                  <ui:TypeInto.Target>
                                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="fca13b00c3148899b8eb6f9bb5589b8d" Selector="&lt;webctrl id='parola' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                                  </ui:TypeInto.Target>
                                                                                </ui:TypeInto>
                                                                                <ui:Click DelayBefore="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayMS="2500" DisplayName="Click 'INPUT'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_545" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                                                                  <ui:Click.CursorPosition>
                                                                                    <ui:CursorPosition OffsetX="37" OffsetY="11" Position="TopLeft" />
                                                                                  </ui:Click.CursorPosition>
                                                                                  <ui:Click.Target>
                                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="1ca5daac6a8c7a1ea0399caf19fc7557" Selector="&lt;webctrl name='Intra' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                                                  </ui:Click.Target>
                                                                                </ui:Click>
                                                                              </Sequence>
                                                                            </ActivityAction>
                                                                          </ui:OpenBrowser.Body>
                                                                          <sap:WorkflowViewStateService.ViewState>
                                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                            </scg:Dictionary>
                                                                          </sap:WorkflowViewStateService.ViewState>
                                                                        </ui:OpenBrowser>
                                                                      </If.Else>
                                                                    </If>
                                                                  </Sequence>
                                                                </ActivityAction>
                                                              </ui:ForEach.Body>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:ForEach>
                                                            <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open log window" Hidden="False" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_445" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                              <ui:OpenBrowser.Body>
                                                                <ActivityAction x:TypeArguments="x:Object">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                  </ActivityAction.Argument>
                                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2486">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1096" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                      <ui:TypeInto.Target>
                                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                      </ui:TypeInto.Target>
                                                                    </ui:TypeInto>
                                                                  </Sequence>
                                                                </ActivityAction>
                                                              </ui:OpenBrowser.Body>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:OpenBrowser>
                                                            <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_13" />
                                                          </Sequence>
                                                        </If.Else>
                                                      </If>
                                                    </Sequence>
                                                  </If.Else>
                                                </If>
                                              </Sequence>
                                            </ActivityAction>
                                          </Catch>
                                        </TryCatch.Catches>
                                        <TryCatch.Finally>
                                          <Delay Duration="00:00:02" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Delay_73" />
                                        </TryCatch.Finally>
                                      </TryCatch>
                                      <Sequence sap2010:Annotation.AnnotationText="Verifica daca urcarea citatiei a avut succes" DisplayName="Verifica urcarea citatie in Ecris" sap:VirtualizedContainerService.HintSize="758,3568" sap2010:WorkflowViewState.IdRef="Sequence_2510">
                                        <Sequence.Variables>
                                          <Variable x:TypeArguments="x:Boolean" Name="elementExists" />
                                        </Sequence.Variables>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" sap2010:Annotation.AnnotationText="Afla cate atasamente sunt in Ecris la idDocument respectiv cu numele fisierului acelasi cu NumeFisierPDF. Daca raspunsul este 0, atunci inseamna ca nu s-a reusit urcarea citatiei in Ecris" CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query InterogareSQL" sap:VirtualizedContainerService.HintSize="716,160" sap2010:WorkflowViewState.IdRef="ExecuteQuery_13" ProviderName="System.Data.SqlClient" Sql="SELECT COUNT(dbo.Attachment.AttachmentId) FROM dbo.Attachment WHERE DocumentId=@idDocument AND AttachmentName=@filename" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                          <ui:ExecuteQuery.Parameters>
                                            <InArgument x:TypeArguments="x:String" x:Key="idDocument">[idDocument]</InArgument>
                                            <InArgument x:TypeArguments="x:String" x:Key="filename">[Path.GetFileName(NumeFisierPDF)]</InArgument>
                                          </ui:ExecuteQuery.Parameters>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ExecuteQuery>
                                        <If sap2010:Annotation.AnnotationText="Daca raspunsul de mai sus este 0, asteapta un pic si mai incearca o data, poate upload-ul merge greu" Condition="[TabeldinDB.Rows.Item(0).Item(0).ToString = &quot;0&quot;]" sap:VirtualizedContainerService.HintSize="716,395" sap2010:WorkflowViewState.IdRef="If_834">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Then>
                                            <Sequence sap:VirtualizedContainerService.HintSize="242,205" sap2010:WorkflowViewState.IdRef="Sequence_2490">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <Delay Duration="00:00:12" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Delay_74" />
                                              <ui:ExecuteQuery ContinueOnError="{x:Null}" ExistingDbConnection="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[TabeldinDB]" DisplayName="Execute query InterogareSQL" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteQuery_14" ProviderName="System.Data.SqlClient" Sql="SELECT COUNT(dbo.Attachment.AttachmentId) FROM dbo.Attachment WHERE DocumentId=@idDocument AND AttachmentName=@filename" ConnectionString="[&quot;Data Source=&quot;+instanta(&quot;IPSQL&quot;)+&quot;;Initial Catalog=ecris_cdms;Persist Security Info=True;User ID=&quot; + instanta(&quot;UsernameSQL&quot;) + &quot;;Password=&quot; + instanta(&quot;PasswordSQL&quot;)]">
                                                <ui:ExecuteQuery.Parameters>
                                                  <InArgument x:TypeArguments="x:String" x:Key="idDocument">[idDocument]</InArgument>
                                                  <InArgument x:TypeArguments="x:String" x:Key="filename">[Path.GetFileName(NumeFisierPDF)]</InArgument>
                                                </ui:ExecuteQuery.Parameters>
                                              </ui:ExecuteQuery>
                                            </Sequence>
                                          </If.Then>
                                        </If>
                                        <If Condition="[TabeldinDB.Rows.Item(0).Item(0).ToString = &quot;0&quot;]" sap:VirtualizedContainerService.HintSize="716,1014" sap2010:WorkflowViewState.IdRef="If_836">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Then>
                                            <Sequence sap2010:Annotation.AnnotationText="Daca raspunsul este 0, un mesaj de eroare specific Ecris diferit de cel al browser-ului. In caz afirmativ, repeta procedura de logare in Ecris la instanta respectiva. Se va reincerca intr-un ciclu ulterior urcarea citatiei." DisplayName="Verifica eroarea 404" sap:VirtualizedContainerService.HintSize="526,866" sap2010:WorkflowViewState.IdRef="Sequence_2495">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:UiElementExists DisplayName="Element Exists '404'" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="484,51" sap2010:WorkflowViewState.IdRef="UiElementExists_151">
                                                <ui:UiElementExists.Target>
                                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="&lt;html app='chrome.exe' title='*404*' /&gt;" TimeoutMS="500" WaitForReady="COMPLETE" />
                                                </ui:UiElementExists.Target>
                                              </ui:UiElementExists>
                                              <If Condition="[elementExists]" DisplayName="Daca a dat eroare 404" sap:VirtualizedContainerService.HintSize="484,626" sap2010:WorkflowViewState.IdRef="If_835">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If.Then>
                                                  <Sequence sap:VirtualizedContainerService.HintSize="242,478" sap2010:WorkflowViewState.IdRef="Sequence_2494">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_320" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(NumeFisierPDF) + &quot; - Eroarea de mai sus a fost cauzata de Ecris printr-un mesaj 404&quot;]">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:AppendLine>
                                                    <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_461">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <TryCatch.Try>
                                                        <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_466" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                          <ui:BrowserScope.Body>
                                                            <ActivityAction x:TypeArguments="x:Object">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                              </ActivityAction.Argument>
                                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2491">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_114" />
                                                                <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1097" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                  <ui:TypeInto.Target>
                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                  </ui:TypeInto.Target>
                                                                </ui:TypeInto>
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </ui:BrowserScope.Body>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:BrowserScope>
                                                      </TryCatch.Try>
                                                      <TryCatch.Catches>
                                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_471">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ActivityAction x:TypeArguments="s:Exception">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                            </ActivityAction.Argument>
                                                            <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_446" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                              <ui:OpenBrowser.Body>
                                                                <ActivityAction x:TypeArguments="x:Object">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                  </ActivityAction.Argument>
                                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2492">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1098" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                      <ui:TypeInto.Target>
                                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                      </ui:TypeInto.Target>
                                                                    </ui:TypeInto>
                                                                  </Sequence>
                                                                </ActivityAction>
                                                              </ui:OpenBrowser.Body>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:OpenBrowser>
                                                          </ActivityAction>
                                                        </Catch>
                                                      </TryCatch.Catches>
                                                    </TryCatch>
                                                    <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_502">
                                                      <TryCatch.Try>
                                                        <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_67" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+NumeFisierPDF.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;', 7, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                          <ui:ExecuteNonQuery.Parameters>
                                                            <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                          </ui:ExecuteNonQuery.Parameters>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:ExecuteNonQuery>
                                                      </TryCatch.Try>
                                                      <TryCatch.Catches>
                                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_512">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ActivityAction x:TypeArguments="s:Exception">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                            </ActivityAction.Argument>
                                                          </ActivityAction>
                                                        </Catch>
                                                      </TryCatch.Catches>
                                                    </TryCatch>
                                                    <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Login Ecris - Attach Browser 'chrome.exe ECRIS'" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="BrowserScope_467" InformativeScreenshot="fa34b6cd81728ac7374bb60742a6a110" Selector="&lt;html app='chrome.exe' omit:title='ECRIS*' /&gt;" TimeoutMS="6000">
                                                      <ui:BrowserScope.Body>
                                                        <ActivityAction x:TypeArguments="x:Object">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,823" sap2010:WorkflowViewState.IdRef="Sequence_2493">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ui:NavigateTo Browser="{x:Null}" ContinueOnError="True" DisplayName="Navigate to" sap:VirtualizedContainerService.HintSize="314,59" sap2010:WorkflowViewState.IdRef="NavigateTo_117" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]" />
                                                            <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists 'INPUT  utilizator''" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="UiElementExists_152">
                                                              <ui:UiElementExists.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                                              </ui:UiElementExists.Target>
                                                            </ui:UiElementExists>
                                                            <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into 'INPUT  utilizator'" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_1099" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;UsernameEcris&quot;)]">
                                                              <ui:TypeInto.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                                              </ui:TypeInto.Target>
                                                            </ui:TypeInto>
                                                            <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type Into" EmptyField="True" sap:VirtualizedContainerService.HintSize="314,134" sap2010:WorkflowViewState.IdRef="TypeInto_1100" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;PasswordEcris&quot;)]">
                                                              <ui:TypeInto.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="fca13b00c3148899b8eb6f9bb5589b8d" Selector="&lt;webctrl id='parola' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                              </ui:TypeInto.Target>
                                                            </ui:TypeInto>
                                                            <ui:Click DelayBefore="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayMS="2500" DisplayName="Click 'INPUT'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_546" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                                              <ui:Click.CursorPosition>
                                                                <ui:CursorPosition OffsetX="37" OffsetY="11" Position="TopLeft" />
                                                              </ui:Click.CursorPosition>
                                                              <ui:Click.Target>
                                                                <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="1ca5daac6a8c7a1ea0399caf19fc7557" Selector="&lt;webctrl name='Intra' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                              </ui:Click.Target>
                                                            </ui:Click>
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </ui:BrowserScope.Body>
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:BrowserScope>
                                                    <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_14" />
                                                  </Sequence>
                                                </If.Then>
                                              </If>
                                            </Sequence>
                                          </If.Then>
                                        </If>
                                        <If Condition="[TabeldinDB.Rows.Item(0).Item(0).ToString = &quot;0&quot;]" sap:VirtualizedContainerService.HintSize="716,509" sap2010:WorkflowViewState.IdRef="If_838">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Then>
                                            <Sequence sap2010:Annotation.AnnotationText="Daca raspunsul este 0, verifica daca in Ecris nu a aparut o eroare fisier de tip inexistent sau gresit. in acest caz, incearca sa inchida fereastra Open file, daca e deschisa. Se va reincerca intr-un ciclu ulterior urcarea citatiei." sap:VirtualizedContainerService.HintSize="376,361" sap2010:WorkflowViewState.IdRef="Sequence_2500">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:UiElementExists DisplayName="Element Exists 'DIV  ctl00_ContentPlace...'" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="334,106" sap2010:WorkflowViewState.IdRef="UiElementExists_153">
                                                <ui:UiElementExists.Target>
                                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="58ecdcf05f8edead5eb252a41c25ec7f" Selector="&lt;html app='chrome.exe' title='ECRIS 2007 Courts [European Dynamics]' /&gt;&lt;webctrl id='ctl00_ContentPlaceHolder1_divError' tag='DIV' innertext='Se pot ataa doar fiiere de tipul*' /&gt;" TimeoutMS="200" WaitForReady="INTERACTIVE" />
                                                </ui:UiElementExists.Target>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:UiElementExists>
                                              <If Condition="[elementExists]" sap:VirtualizedContainerService.HintSize="334,51" sap2010:WorkflowViewState.IdRef="If_837">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If.Then>
                                                  <Sequence DisplayName="Daca mesaj fisier inexistent" sap:VirtualizedContainerService.HintSize="242,493" sap2010:WorkflowViewState.IdRef="Sequence_2499">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <Sequence DisplayName="Inchide fereastra Open file" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2496">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_547" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                                        <ui:Click.CursorPosition>
                                                          <ui:CursorPosition Position="Center">
                                                            <ui:CursorPosition.OffsetX>
                                                              <InArgument x:TypeArguments="x:Int32" />
                                                            </ui:CursorPosition.OffsetX>
                                                            <ui:CursorPosition.OffsetY>
                                                              <InArgument x:TypeArguments="x:Int32" />
                                                            </ui:CursorPosition.OffsetY>
                                                          </ui:CursorPosition>
                                                        </ui:Click.CursorPosition>
                                                        <ui:Click.Target>
                                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="ee9793bc24a3b55b05f818dd72b1861c" Selector="&lt;wnd app='chrome.exe' cls='#32770' idx='1' title='Open' /&gt;&lt;wnd aaname='Open' cls='DirectUIHWND' /&gt;&lt;wnd cls='Button' title='OK' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                        </ui:Click.Target>
                                                      </ui:Click>
                                                      <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_548" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                                        <ui:Click.CursorPosition>
                                                          <ui:CursorPosition Position="Center">
                                                            <ui:CursorPosition.OffsetX>
                                                              <InArgument x:TypeArguments="x:Int32" />
                                                            </ui:CursorPosition.OffsetX>
                                                            <ui:CursorPosition.OffsetY>
                                                              <InArgument x:TypeArguments="x:Int32" />
                                                            </ui:CursorPosition.OffsetY>
                                                          </ui:CursorPosition>
                                                        </ui:Click.CursorPosition>
                                                        <ui:Click.Target>
                                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="bd1f48e701357a84dc55314b323bc7d9" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd ctrlid='2' title='Cancel' aaname='Cancel' cls='Button' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                        </ui:Click.Target>
                                                      </ui:Click>
                                                    </Sequence>
                                                    <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_321" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Eroare fisier lipsa sau tip gresit fisier. Nu am reusit sa urc citatia la dosarul nr. &quot; + NrDosar + &quot;. Voi incerca mai tarziu&quot;]">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:AppendLine>
                                                    <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_462">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <TryCatch.Try>
                                                        <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_468" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                          <ui:BrowserScope.Body>
                                                            <ActivityAction x:TypeArguments="x:Object">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                              </ActivityAction.Argument>
                                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2497">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_115" />
                                                                <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1101" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                  <ui:TypeInto.Target>
                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                  </ui:TypeInto.Target>
                                                                </ui:TypeInto>
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </ui:BrowserScope.Body>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:BrowserScope>
                                                      </TryCatch.Try>
                                                      <TryCatch.Catches>
                                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_472">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ActivityAction x:TypeArguments="s:Exception">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                            </ActivityAction.Argument>
                                                            <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_447" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                              <ui:OpenBrowser.Body>
                                                                <ActivityAction x:TypeArguments="x:Object">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                  </ActivityAction.Argument>
                                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2498">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1102" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                      <ui:TypeInto.Target>
                                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                      </ui:TypeInto.Target>
                                                                    </ui:TypeInto>
                                                                  </Sequence>
                                                                </ActivityAction>
                                                              </ui:OpenBrowser.Body>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:OpenBrowser>
                                                          </ActivityAction>
                                                        </Catch>
                                                      </TryCatch.Catches>
                                                    </TryCatch>
                                                    <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="434,266" sap2010:WorkflowViewState.IdRef="TryCatch_503">
                                                      <TryCatch.Try>
                                                        <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_68" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+NumeFisierPDF.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;', 9, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                          <ui:ExecuteNonQuery.Parameters>
                                                            <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                          </ui:ExecuteNonQuery.Parameters>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:ExecuteNonQuery>
                                                      </TryCatch.Try>
                                                      <TryCatch.Catches>
                                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_513">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ActivityAction x:TypeArguments="s:Exception">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                            </ActivityAction.Argument>
                                                          </ActivityAction>
                                                        </Catch>
                                                      </TryCatch.Catches>
                                                    </TryCatch>
                                                    <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_15" />
                                                  </Sequence>
                                                </If.Then>
                                              </If>
                                            </Sequence>
                                          </If.Then>
                                        </If>
                                        <If Condition="[TabeldinDB.Rows.Item(0).Item(0).ToString = &quot;0&quot;]" sap:VirtualizedContainerService.HintSize="716,1211" sap2010:WorkflowViewState.IdRef="If_842">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Then>
                                            <Sequence sap2010:Annotation.AnnotationText="Daca raspunsul este 0, se verifica daca Ecris nu a dat eroare dimensiune invalida fisier. Pe ramura Else se inregistreaza orice alta posibil eroare. In ambele cazuri, eroarea se noteaza corespunzator in log, se inchide fereastra Open file si se muta fisierele PDF si TXT in FolderErori." sap:VirtualizedContainerService.HintSize="571,1063" sap2010:WorkflowViewState.IdRef="Sequence_2509">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ui:UiElementExists DisplayName="Element Exists 'DIV  ctl00_ContentPlace...'" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="529,51" sap2010:WorkflowViewState.IdRef="UiElementExists_154">
                                                <ui:UiElementExists.Target>
                                                  <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="93dd0a492797f1557da92c8eb208a6bc" Selector="&lt;html app='chrome.exe' title='ECRIS 2007 Courts [European Dynamics]' /&gt;&lt;webctrl id='ctl00_ContentPlaceHolder1_divError' tag='DIV' innertext='Dimensiunea fiierului nu este valid*' /&gt;" TimeoutMS="200" WaitForReady="INTERACTIVE" />
                                                </ui:UiElementExists.Target>
                                              </ui:UiElementExists>
                                              <If Condition="[elementExists]" sap:VirtualizedContainerService.HintSize="529,823" sap2010:WorkflowViewState.IdRef="If_841">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <If.Then>
                                                  <Sequence DisplayName="Daca mesaj depasire dimensiune upload" sap:VirtualizedContainerService.HintSize="242,675" sap2010:WorkflowViewState.IdRef="Sequence_2504">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <Sequence DisplayName="Inchide fereastra Open file" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2501">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_549" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                                        <ui:Click.CursorPosition>
                                                          <ui:CursorPosition Position="Center">
                                                            <ui:CursorPosition.OffsetX>
                                                              <InArgument x:TypeArguments="x:Int32" />
                                                            </ui:CursorPosition.OffsetX>
                                                            <ui:CursorPosition.OffsetY>
                                                              <InArgument x:TypeArguments="x:Int32" />
                                                            </ui:CursorPosition.OffsetY>
                                                          </ui:CursorPosition>
                                                        </ui:Click.CursorPosition>
                                                        <ui:Click.Target>
                                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="ee9793bc24a3b55b05f818dd72b1861c" Selector="&lt;wnd app='chrome.exe' cls='#32770' idx='1' title='Open' /&gt;&lt;wnd aaname='Open' cls='DirectUIHWND' /&gt;&lt;wnd cls='Button' title='OK' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                        </ui:Click.Target>
                                                      </ui:Click>
                                                      <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_550" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                                        <ui:Click.CursorPosition>
                                                          <ui:CursorPosition Position="Center">
                                                            <ui:CursorPosition.OffsetX>
                                                              <InArgument x:TypeArguments="x:Int32" />
                                                            </ui:CursorPosition.OffsetX>
                                                            <ui:CursorPosition.OffsetY>
                                                              <InArgument x:TypeArguments="x:Int32" />
                                                            </ui:CursorPosition.OffsetY>
                                                          </ui:CursorPosition>
                                                        </ui:Click.CursorPosition>
                                                        <ui:Click.Target>
                                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="bd1f48e701357a84dc55314b323bc7d9" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd ctrlid='2' title='Cancel' aaname='Cancel' cls='Button' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                        </ui:Click.Target>
                                                      </ui:Click>
                                                    </Sequence>
                                                    <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)]" DisplayName="Move file TXT to Erori" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="MoveFile_128" Overwrite="True" Path="[file]" />
                                                    <If Condition="[System.IO.File.Exists(instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileName(NumeFisierPDF))]" DisplayName="Move file PDF to Erori" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_839">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If.Then>
                                                        <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(NumeFisierPDF)+&quot;_mutat_ora_&quot;+DateTime.Now.ToString(&quot;HH-mm&quot;)+Path.GetExtension(NumeFisierPDF)]" DisplayName="Move PDF to Erori redenumit" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_129" Overwrite="True" Path="[NumeFisierPDF]" />
                                                      </If.Then>
                                                      <If.Else>
                                                        <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)]" DisplayName="Move PDF to Erori" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_130" Overwrite="True" Path="[NumeFisierPDF]" />
                                                      </If.Else>
                                                    </If>
                                                    <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_322" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Nu am reusit sa urc citatia la dosarul nr. &quot; + NrDosar + &quot;. Fisierul este mai mare decat limita maxima pentru upload permisa de Ecris - EROARE&quot;]">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:AppendLine>
                                                    <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_463">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <TryCatch.Try>
                                                        <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_469" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                          <ui:BrowserScope.Body>
                                                            <ActivityAction x:TypeArguments="x:Object">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                              </ActivityAction.Argument>
                                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2502">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_116" />
                                                                <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1103" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                  <ui:TypeInto.Target>
                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                  </ui:TypeInto.Target>
                                                                </ui:TypeInto>
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </ui:BrowserScope.Body>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:BrowserScope>
                                                      </TryCatch.Try>
                                                      <TryCatch.Catches>
                                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_473">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ActivityAction x:TypeArguments="s:Exception">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                            </ActivityAction.Argument>
                                                            <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_448" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                              <ui:OpenBrowser.Body>
                                                                <ActivityAction x:TypeArguments="x:Object">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                  </ActivityAction.Argument>
                                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2503">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1104" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                      <ui:TypeInto.Target>
                                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                      </ui:TypeInto.Target>
                                                                    </ui:TypeInto>
                                                                  </Sequence>
                                                                </ActivityAction>
                                                              </ui:OpenBrowser.Body>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:OpenBrowser>
                                                          </ActivityAction>
                                                        </Catch>
                                                      </TryCatch.Catches>
                                                    </TryCatch>
                                                    <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_504">
                                                      <TryCatch.Try>
                                                        <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_69" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+NumeFisierPDF.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;', 10, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                          <ui:ExecuteNonQuery.Parameters>
                                                            <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                          </ui:ExecuteNonQuery.Parameters>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:ExecuteNonQuery>
                                                      </TryCatch.Try>
                                                      <TryCatch.Catches>
                                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_514">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ActivityAction x:TypeArguments="s:Exception">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                            </ActivityAction.Argument>
                                                          </ActivityAction>
                                                        </Catch>
                                                      </TryCatch.Catches>
                                                    </TryCatch>
                                                    <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_16" />
                                                  </Sequence>
                                                </If.Then>
                                                <If.Else>
                                                  <Sequence DisplayName="Daca alt mesaj de eroare" sap:VirtualizedContainerService.HintSize="242,675" sap2010:WorkflowViewState.IdRef="Sequence_2508">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <Sequence DisplayName="Inchide fereastra Open file" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2505">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_551" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                                        <ui:Click.CursorPosition>
                                                          <ui:CursorPosition Position="Center">
                                                            <ui:CursorPosition.OffsetX>
                                                              <InArgument x:TypeArguments="x:Int32" />
                                                            </ui:CursorPosition.OffsetX>
                                                            <ui:CursorPosition.OffsetY>
                                                              <InArgument x:TypeArguments="x:Int32" />
                                                            </ui:CursorPosition.OffsetY>
                                                          </ui:CursorPosition>
                                                        </ui:Click.CursorPosition>
                                                        <ui:Click.Target>
                                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="ee9793bc24a3b55b05f818dd72b1861c" Selector="&lt;wnd app='chrome.exe' cls='#32770' idx='1' title='Open' /&gt;&lt;wnd aaname='Open' cls='DirectUIHWND' /&gt;&lt;wnd cls='Button' title='OK' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                        </ui:Click.Target>
                                                      </ui:Click>
                                                      <ui:Click DelayBefore="{x:Null}" DelayMS="{x:Null}" ClickType="CLICK_SINGLE" ContinueOnError="True" DisplayName="Click 'Button'" sap:VirtualizedContainerService.HintSize="314,106" sap2010:WorkflowViewState.IdRef="Click_552" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="True" SimulateClick="False">
                                                        <ui:Click.CursorPosition>
                                                          <ui:CursorPosition Position="Center">
                                                            <ui:CursorPosition.OffsetX>
                                                              <InArgument x:TypeArguments="x:Int32" />
                                                            </ui:CursorPosition.OffsetX>
                                                            <ui:CursorPosition.OffsetY>
                                                              <InArgument x:TypeArguments="x:Int32" />
                                                            </ui:CursorPosition.OffsetY>
                                                          </ui:CursorPosition>
                                                        </ui:Click.CursorPosition>
                                                        <ui:Click.Target>
                                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="bd1f48e701357a84dc55314b323bc7d9" Selector="&lt;wnd app='chrome.exe' cls='#32770' title='Open' /&gt;&lt;wnd ctrlid='2' title='Cancel' aaname='Cancel' cls='Button' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                                        </ui:Click.Target>
                                                      </ui:Click>
                                                    </Sequence>
                                                    <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)]" DisplayName="Move file TXT to Erori" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="MoveFile_131" Overwrite="True" Path="[file]" />
                                                    <If Condition="[System.IO.File.Exists(instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileName(NumeFisierPDF))]" DisplayName="Move file PDF to Erori" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="If_840">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <If.Then>
                                                        <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(NumeFisierPDF)+&quot;_mutat_ora_&quot;+DateTime.Now.ToString(&quot;HH-mm&quot;)+Path.GetExtension(NumeFisierPDF)]" DisplayName="Move PDF to Erori redenumit" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_132" Overwrite="True" Path="[NumeFisierPDF]" />
                                                      </If.Then>
                                                      <If.Else>
                                                        <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderErori&quot;)]" DisplayName="Move PDF to Erori" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_133" Overwrite="True" Path="[NumeFisierPDF]" />
                                                      </If.Else>
                                                    </If>
                                                    <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_323" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(file) + &quot; - Nu am reusit sa urc citatia la dosarul nr. &quot; + NrDosar + &quot;. A aparut o eroare la operarea Ecris - EROARE&quot;]">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                    </ui:AppendLine>
                                                    <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_464">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <TryCatch.Try>
                                                        <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_470" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                          <ui:BrowserScope.Body>
                                                            <ActivityAction x:TypeArguments="x:Object">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                              </ActivityAction.Argument>
                                                              <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2506">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_117" />
                                                                <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1105" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                  <ui:TypeInto.Target>
                                                                    <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                  </ui:TypeInto.Target>
                                                                </ui:TypeInto>
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </ui:BrowserScope.Body>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:BrowserScope>
                                                      </TryCatch.Try>
                                                      <TryCatch.Catches>
                                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_474">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ActivityAction x:TypeArguments="s:Exception">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                            </ActivityAction.Argument>
                                                            <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_449" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                              <ui:OpenBrowser.Body>
                                                                <ActivityAction x:TypeArguments="x:Object">
                                                                  <ActivityAction.Argument>
                                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                                  </ActivityAction.Argument>
                                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2507">
                                                                    <sap:WorkflowViewStateService.ViewState>
                                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                      </scg:Dictionary>
                                                                    </sap:WorkflowViewStateService.ViewState>
                                                                    <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1106" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                                      <ui:TypeInto.Target>
                                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                                      </ui:TypeInto.Target>
                                                                    </ui:TypeInto>
                                                                  </Sequence>
                                                                </ActivityAction>
                                                              </ui:OpenBrowser.Body>
                                                              <sap:WorkflowViewStateService.ViewState>
                                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                </scg:Dictionary>
                                                              </sap:WorkflowViewStateService.ViewState>
                                                            </ui:OpenBrowser>
                                                          </ActivityAction>
                                                        </Catch>
                                                      </TryCatch.Catches>
                                                    </TryCatch>
                                                    <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="434,266" sap2010:WorkflowViewState.IdRef="TryCatch_505">
                                                      <TryCatch.Try>
                                                        <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_70" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+NumeFisierPDF.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;', 11, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                          <ui:ExecuteNonQuery.Parameters>
                                                            <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                          </ui:ExecuteNonQuery.Parameters>
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                        </ui:ExecuteNonQuery>
                                                      </TryCatch.Try>
                                                      <TryCatch.Catches>
                                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_515">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ActivityAction x:TypeArguments="s:Exception">
                                                            <ActivityAction.Argument>
                                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                            </ActivityAction.Argument>
                                                          </ActivityAction>
                                                        </Catch>
                                                      </TryCatch.Catches>
                                                    </TryCatch>
                                                    <ui:Continue sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Continue_17" />
                                                  </Sequence>
                                                </If.Else>
                                              </If>
                                            </Sequence>
                                          </If.Then>
                                        </If>
                                      </Sequence>
                                      <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderPrelucrate&quot;)]" DisplayName="Move file TXT to Prelucrate" sap:VirtualizedContainerService.HintSize="434,51" sap2010:WorkflowViewState.IdRef="MoveFile_134" Overwrite="True" Path="[file]" />
                                      <TryCatch sap2010:Annotation.AnnotationText="Muta fisierul in FolderErori, redenumit cu _mutat_ora_hh_mm, daca exista deja un fisier cu acelasi nume, pentru a evita suprascrierea" DisplayName="Move file PDF to Prelucrate" sap:VirtualizedContainerService.HintSize="434,153" sap2010:WorkflowViewState.IdRef="TryCatch_466">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <TryCatch.Try>
                                          <If Condition="[System.IO.File.Exists(instanta(&quot;FolderPrelucrate&quot;)+&quot;\&quot;+Path.GetFileName(NumeFisierPDF))]" DisplayName="Move file PDF to Prelucrate" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_843">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Then>
                                              <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderPrelucrate&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(NumeFisierPDF)+&quot;_mutat_ora_&quot;+DateTime.Now.ToString(&quot;HH-mm&quot;)+Path.GetExtension(NumeFisierPDF)]" DisplayName="Move PDF to Prelucrate redenumit" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_135" Overwrite="True" Path="[NumeFisierPDF]" />
                                            </If.Then>
                                            <If.Else>
                                              <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderPrelucrate&quot;)]" DisplayName="Move PDF to Prelucrate" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_136" Overwrite="True" Path="[NumeFisierPDF]" />
                                            </If.Else>
                                          </If>
                                        </TryCatch.Try>
                                        <TryCatch.Catches>
                                          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_476">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ActivityAction x:TypeArguments="s:Exception">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                              </ActivityAction.Argument>
                                              <Sequence DisplayName="Wait and move file PDF to Prelucrate" sap:VirtualizedContainerService.HintSize="486,1171" sap2010:WorkflowViewState.IdRef="Sequence_2513">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <DoWhile DisplayName="Do While - Verifica ca documentul este inchis" sap:VirtualizedContainerService.HintSize="464,51" sap2010:WorkflowViewState.IdRef="DoWhile_3">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <DoWhile.Condition>[fileLocked = True]</DoWhile.Condition>
                                                  <TryCatch DisplayName="Verifica daca documentul e deschis de alt program" sap:VirtualizedContainerService.HintSize="418,683" sap2010:WorkflowViewState.IdRef="TryCatch_465">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <TryCatch.Try>
                                                      <Sequence DisplayName="Verifica daca documentul poate fi accesat" sap:VirtualizedContainerService.HintSize="264,456" sap2010:WorkflowViewState.IdRef="Sequence_2511">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1795">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="x:Boolean">[fileLocked]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="x:Boolean">False</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                        <Assign DisplayName="Create FileStream" sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1796">
                                                          <Assign.To>
                                                            <OutArgument x:TypeArguments="si:FileStream">[fs]</OutArgument>
                                                          </Assign.To>
                                                          <Assign.Value>
                                                            <InArgument x:TypeArguments="si:FileStream">[System.IO.File.Open(NumeFisierPDF, FileMode.Open, FileAccess.Read, FileShare.None)]</InArgument>
                                                          </Assign.Value>
                                                        </Assign>
                                                        <InvokeMethod DisplayName="Invoke method" sap:VirtualizedContainerService.HintSize="242,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_85" MethodName="Close">
                                                          <InvokeMethod.TargetObject>
                                                            <InArgument x:TypeArguments="si:FileStream">[fs]</InArgument>
                                                          </InvokeMethod.TargetObject>
                                                        </InvokeMethod>
                                                      </Sequence>
                                                    </TryCatch.Try>
                                                    <TryCatch.Catches>
                                                      <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_475">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ActivityAction x:TypeArguments="s:Exception">
                                                          <ActivityAction.Argument>
                                                            <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                          </ActivityAction.Argument>
                                                          <Sequence DisplayName="Daca nu poate fi accesat" sap:VirtualizedContainerService.HintSize="264,246" sap2010:WorkflowViewState.IdRef="Sequence_2512">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <Assign sap:VirtualizedContainerService.HintSize="242,60" sap2010:WorkflowViewState.IdRef="Assign_1797">
                                                              <Assign.To>
                                                                <OutArgument x:TypeArguments="x:Boolean">[fileLocked]</OutArgument>
                                                              </Assign.To>
                                                              <Assign.Value>
                                                                <InArgument x:TypeArguments="x:Boolean">True</InArgument>
                                                              </Assign.Value>
                                                            </Assign>
                                                            <Delay Duration="00:00:01" sap:VirtualizedContainerService.HintSize="242,22" sap2010:WorkflowViewState.IdRef="Delay_75" />
                                                          </Sequence>
                                                        </ActivityAction>
                                                      </Catch>
                                                    </TryCatch.Catches>
                                                  </TryCatch>
                                                </DoWhile>
                                                <If Condition="[System.IO.File.Exists(instanta(&quot;FolderPrelucrate&quot;)+&quot;\&quot;+Path.GetFileName(NumeFisierPDF))]" DisplayName="Move file PDF to Prelucrate" sap:VirtualizedContainerService.HintSize="464,51" sap2010:WorkflowViewState.IdRef="If_844">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <If.Then>
                                                    <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderPrelucrate&quot;)+&quot;\&quot;+Path.GetFileNameWithoutExtension(NumeFisierPDF)+&quot;_mutat_ora_&quot;+DateTime.Now.ToString(&quot;HH-mm&quot;)+Path.GetExtension(NumeFisierPDF)]" DisplayName="Move PDF to Prelucrate redenumit" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_137" Overwrite="True" Path="[NumeFisierPDF]" />
                                                  </If.Then>
                                                  <If.Else>
                                                    <ui:MoveFile ContinueOnError="{x:Null}" Destination="[instanta(&quot;FolderPrelucrate&quot;)]" DisplayName="Move PDF to Prelucrate" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="MoveFile_138" Overwrite="True" Path="[NumeFisierPDF]" />
                                                  </If.Else>
                                                </If>
                                              </Sequence>
                                            </ActivityAction>
                                          </Catch>
                                        </TryCatch.Catches>
                                      </TryCatch>
                                      <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="434,51" sap2010:WorkflowViewState.IdRef="AppendLine_324" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+ Path.GetFileName(NumeFisierPDF) +&quot; - Citatie urcata in Ecris la dosarul nr. &quot; + NrDosar + &quot; - Succes.&quot;]">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </ui:AppendLine>
                                      <TryCatch sap2010:Annotation.AnnotationText="Face refresh la pagina Chrome cu jurnalul pentru a se vedea pe ecran ultima intrare introdusa" DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="434,123" sap2010:WorkflowViewState.IdRef="TryCatch_467">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <TryCatch.Try>
                                          <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_471" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                            <ui:BrowserScope.Body>
                                              <ActivityAction x:TypeArguments="x:Object">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                </ActivityAction.Argument>
                                                <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2514">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_118" />
                                                  <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1107" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                    <ui:TypeInto.Target>
                                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                    </ui:TypeInto.Target>
                                                  </ui:TypeInto>
                                                </Sequence>
                                              </ActivityAction>
                                            </ui:BrowserScope.Body>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:BrowserScope>
                                        </TryCatch.Try>
                                        <TryCatch.Catches>
                                          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_477">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ActivityAction x:TypeArguments="s:Exception">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                              </ActivityAction.Argument>
                                              <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_450" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                <ui:OpenBrowser.Body>
                                                  <ActivityAction x:TypeArguments="x:Object">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                    </ActivityAction.Argument>
                                                    <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2515">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1108" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                        <ui:TypeInto.Target>
                                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                        </ui:TypeInto.Target>
                                                      </ui:TypeInto>
                                                    </Sequence>
                                                  </ActivityAction>
                                                </ui:OpenBrowser.Body>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:OpenBrowser>
                                            </ActivityAction>
                                          </Catch>
                                        </TryCatch.Catches>
                                      </TryCatch>
                                      <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="434,51" sap2010:WorkflowViewState.IdRef="TryCatch_490">
                                        <TryCatch.Try>
                                          <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_71" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+NumeFisierPDF.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '&quot;+NrDosar+&quot;', '&quot;+idDosar+&quot;', '&quot;+idDocument+&quot;', 1, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                            <ui:ExecuteNonQuery.Parameters>
                                              <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                            </ui:ExecuteNonQuery.Parameters>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:ExecuteNonQuery>
                                        </TryCatch.Try>
                                        <TryCatch.Catches>
                                          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_500">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <ActivityAction x:TypeArguments="s:Exception">
                                              <ActivityAction.Argument>
                                                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                              </ActivityAction.Argument>
                                            </ActivityAction>
                                          </Catch>
                                        </TryCatch.Catches>
                                      </TryCatch>
                                      <Assign sap2010:Annotation.AnnotationText="Daca robotul a avut succes si instanta fusese marcata offline inainte, acum robotul o va marca online, deoarece si-a revenit" DisplayName="Marcheaza instanta ca online" sap:VirtualizedContainerService.HintSize="434,132" sap2010:WorkflowViewState.IdRef="Assign_1798">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("Offline")]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">["nu="+DateTime.Now.ToString]</InArgument>
                                        </Assign.Value>
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                      </Assign>
                                    </Sequence>
                                  </ActivityAction>
                                </ui:ForEach.Body>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:ForEach>
                            </Sequence>
                          </TryCatch.Try>
                          <TryCatch.Catches>
                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_480">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ActivityAction x:TypeArguments="s:Exception">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="Logheaza eroarea" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2522">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <If sap2010:Annotation.AnnotationText="Robotul noteaza eroarea in log si trimite email cu eroarea numai daca au trecut cel putin 12 ore de la ultimul email trimis, pentru a nu deranja" Condition="[instanta(&quot;Offline&quot;).StartsWith(&quot;nu&quot;) OR (instanta(&quot;Offline&quot;).StartsWith(&quot;da&quot;) AND (DateTime.Now - Convert.ToDateTime(instanta(&quot;OraUltimulEmail&quot;))).TotalHours &gt;= 12)]" DisplayName="Noteaza eroarea o data la x ore" sap:VirtualizedContainerService.HintSize="484,256" sap2010:WorkflowViewState.IdRef="If_846">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If.Then>
                                      <Sequence sap:VirtualizedContainerService.HintSize="304,630" sap2010:WorkflowViewState.IdRef="Sequence_2521">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="AppendLine_325" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] &quot;+fisierEroare+&quot; - Eroare in procedura de urcare Citatii in Ecris. Exception message: &quot;+exception.Message+&quot; at Source: &quot;+exception.Source]">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:AppendLine>
                                        <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_468">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <TryCatch.Try>
                                            <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_472" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                              <ui:BrowserScope.Body>
                                                <ActivityAction x:TypeArguments="x:Object">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                  </ActivityAction.Argument>
                                                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2518">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_119" />
                                                    <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1109" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                      <ui:TypeInto.Target>
                                                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                      </ui:TypeInto.Target>
                                                    </ui:TypeInto>
                                                  </Sequence>
                                                </ActivityAction>
                                              </ui:BrowserScope.Body>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:BrowserScope>
                                          </TryCatch.Try>
                                          <TryCatch.Catches>
                                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_478">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ActivityAction x:TypeArguments="s:Exception">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                </ActivityAction.Argument>
                                                <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_451" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                  <ui:OpenBrowser.Body>
                                                    <ActivityAction x:TypeArguments="x:Object">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                      </ActivityAction.Argument>
                                                      <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2519">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1110" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                          <ui:TypeInto.Target>
                                                            <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                          </ui:TypeInto.Target>
                                                        </ui:TypeInto>
                                                      </Sequence>
                                                    </ActivityAction>
                                                  </ui:OpenBrowser.Body>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:OpenBrowser>
                                              </ActivityAction>
                                            </Catch>
                                          </TryCatch.Catches>
                                        </TryCatch>
                                        <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_491">
                                          <TryCatch.Try>
                                            <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_72" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '&quot;+fisierEroare.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;', '', '', '', 15, 'Eroare in procedura de urcare Citatii in Ecris. Exception message: &quot;+exception.Message.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot; at Source: &quot;+exception.Source.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                              <ui:ExecuteNonQuery.Parameters>
                                                <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                              </ui:ExecuteNonQuery.Parameters>
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                            </ui:ExecuteNonQuery>
                                          </TryCatch.Try>
                                          <TryCatch.Catches>
                                            <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_501">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <ActivityAction x:TypeArguments="s:Exception">
                                                <ActivityAction.Argument>
                                                  <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                </ActivityAction.Argument>
                                              </ActivityAction>
                                            </Catch>
                                          </TryCatch.Catches>
                                        </TryCatch>
                                        <If sap2010:Annotation.AnnotationText="Robotul trimite email cu eroarea administratorului numai in intervalul L-V 7:30-16" Condition="[DateTime.Now.DayOfWeek = DayOfWeek.Saturday OR DateTime.Now.DayOfWeek = DayOfWeek.Sunday OR DateTime.Now.TimeOfDay &lt; New TimeSpan(7, 30, 0) OR DateTime.Now.TimeOfDay &gt; New TimeSpan(16, 0, 0)]" DisplayName="Trimite email cu eroarea in zilele lucratoare" sap:VirtualizedContainerService.HintSize="262,123" sap2010:WorkflowViewState.IdRef="If_845">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <If.Else>
                                            <TryCatch DisplayName="Trimite email cu eroarea" sap:VirtualizedContainerService.HintSize="434,297" sap2010:WorkflowViewState.IdRef="TryCatch_469">
                                              <sap:WorkflowViewStateService.ViewState>
                                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                </scg:Dictionary>
                                              </sap:WorkflowViewStateService.ViewState>
                                              <TryCatch.Try>
                                                <ui:SendMail Bcc="{x:Null}" Cc="{x:Null}" Email="{x:Null}" MailMessage="{x:Null}" Password="{x:Null}" sap2010:Annotation.AnnotationText="Trimite email cu detaliile exceptiei, inclusiv mesajul exceptiei" Body="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot;] Robot UiPath - Eroare in procedura urcare Citatii in Ecris. Exception message: &quot;+exception.Message+&quot; at Source: &quot;+exception.Source]" DisplayName="Send SMTP Mail Message" EnableSSL="True" From="[instanta(&quot;EmailSenderRobot&quot;)]" sap:VirtualizedContainerService.HintSize="200,108" sap2010:WorkflowViewState.IdRef="SendMail_7" IsBodyHtml="False" Name="[instanta(&quot;EmailSenderRobot&quot;)]" Port="[cint(instanta(&quot;PortSmtp&quot;))]" SecureConnection="None" Server="[instanta(&quot;IPsmtp&quot;)]" Subject="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot;] Robotul UiPath a intalnit o eroare&quot;]" TimeoutMS="3000" To="[instanta(&quot;DestinatariEmailEroare&quot;)]">
                                                  <ui:SendMail.Files>
                                                    <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                                                  </ui:SendMail.Files>
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                </ui:SendMail>
                                              </TryCatch.Try>
                                              <TryCatch.Catches>
                                                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,135" sap2010:WorkflowViewState.IdRef="Catch`1_479">
                                                  <sap:WorkflowViewStateService.ViewState>
                                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                    </scg:Dictionary>
                                                  </sap:WorkflowViewStateService.ViewState>
                                                  <ActivityAction x:TypeArguments="s:Exception">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                    </ActivityAction.Argument>
                                                    <Sequence sap:VirtualizedContainerService.HintSize="242,234" sap2010:WorkflowViewState.IdRef="Sequence_2520">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_326" Text="Nu am putut trimite e-mail cu eroarea" />
                                                      <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="434,266" sap2010:WorkflowViewState.IdRef="TryCatch_492">
                                                        <TryCatch.Try>
                                                          <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_73" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '', '', '', '', 13, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                            <ui:ExecuteNonQuery.Parameters>
                                                              <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                            </ui:ExecuteNonQuery.Parameters>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                          </ui:ExecuteNonQuery>
                                                        </TryCatch.Try>
                                                        <TryCatch.Catches>
                                                          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_502">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ActivityAction x:TypeArguments="s:Exception">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                              </ActivityAction.Argument>
                                                            </ActivityAction>
                                                          </Catch>
                                                        </TryCatch.Catches>
                                                      </TryCatch>
                                                    </Sequence>
                                                  </ActivityAction>
                                                </Catch>
                                              </TryCatch.Catches>
                                            </TryCatch>
                                          </If.Else>
                                        </If>
                                        <Assign sap2010:Annotation.AnnotationText="Noteaza in dictionar data si ora ultimului email trimis pentru instanta respectiva" DisplayName="Marcheaza ora ultimului email" sap:VirtualizedContainerService.HintSize="262,102" sap2010:WorkflowViewState.IdRef="Assign_1799">
                                          <Assign.To>
                                            <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("OraUltimulEmail")]</OutArgument>
                                          </Assign.To>
                                          <Assign.Value>
                                            <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString]</InArgument>
                                          </Assign.Value>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </Assign>
                                      </Sequence>
                                    </If.Then>
                                  </If>
                                  <Assign sap2010:Annotation.AnnotationText="Pentru a sari 5 min instanta, in variabila instanta(&quot;Offline&quot;) se noteaza data si ora erorii" DisplayName="Marcheaza ora instanta offline" sap:VirtualizedContainerService.HintSize="262,117" sap2010:WorkflowViewState.IdRef="Assign_1800">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("Offline")]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:String">["da=" + DateTime.Now.ToString]</InArgument>
                                    </Assign.Value>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </Assign>
                                </Sequence>
                              </ActivityAction>
                            </Catch>
                          </TryCatch.Catches>
                        </TryCatch>
                      </FlowStep>
                    </FlowStep.Next>
                  </FlowStep>
                </FlowStep.Next>
              </FlowStep>
              <x:Reference>__ReferenceID57</x:Reference>
              <x:Reference>__ReferenceID58</x:Reference>
            </Flowchart>
          </ActivityAction>
        </ui:ForEach.Body>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </ui:ForEach>
      <FlowStep.Next>
        <FlowStep x:Name="__ReferenceID62" sap2010:WorkflowViewState.IdRef="FlowStep_1137">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <av:Point x:Key="ShapeLocation">190,509</av:Point>
              <av:Size x:Key="ShapeSize">200,79</av:Size>
              <av:PointCollection x:Key="ConnectorLocation">190,548.5 141,548.5 141,469.04</av:PointCollection>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <Delay sap2010:Annotation.AnnotationText="Asteapta 30 sec pentru a nu accesa prea mult harddisk-urile" Duration="00:00:15" sap:VirtualizedContainerService.HintSize="200,79" sap2010:WorkflowViewState.IdRef="Delay_68">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
          </Delay>
          <FlowStep.Next>
            <FlowStep x:Name="__ReferenceID61" sap2010:WorkflowViewState.IdRef="FlowStep_1136">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <av:Point x:Key="ShapeLocation">41,316.04</av:Point>
                  <av:Size x:Key="ShapeSize">200,153</av:Size>
                  <av:PointCollection x:Key="ConnectorLocation">241,392.54 351,392.54</av:PointCollection>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <If sap2010:Annotation.AnnotationText="Sterge dimineata din share-uri fisierele mai vechi de un numar de zile si creeaza un fisier jurnal nou daca cel vechi este mai mare de 512 KB" Condition="[DateTime.Now.TimeOfDay &gt; New TimeSpan(7, 35, 0) AND DateTime.Now.TimeOfDay &lt;= New TimeSpan(7, 40, 0)]" DisplayName="Sterge fisiere vechi" sap:VirtualizedContainerService.HintSize="200,153" sap2010:WorkflowViewState.IdRef="If_498">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <If.Then>
                  <Sequence sap:VirtualizedContainerService.HintSize="242,234" sap2010:WorkflowViewState.IdRef="Sequence_1538">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:ForEach x:TypeArguments="scg:Dictionary(x:String, x:String)" CurrentIndex="{x:Null}" DisplayName="Sterge fisierele mai vechi de un nr. de zile - FolderErori" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ForEach`1_105" Values="[ConfigInstante]">
                      <ui:ForEach.Body>
                        <ActivityAction x:TypeArguments="scg:Dictionary(x:String, x:String)">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" Name="instanta" />
                          </ActivityAction.Argument>
                          <TryCatch DisplayName="Sterge fisierele vechi la instanta - FolderErori" sap:VirtualizedContainerService.HintSize="434,183" sap2010:WorkflowViewState.IdRef="TryCatch_258">
                            <TryCatch.Try>
                              <ui:ForEach x:TypeArguments="si:FileSystemInfo" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Sterge fisierele vechi din FolderPrelucrate si din FolderErori" DisplayName="For each file" sap:VirtualizedContainerService.HintSize="200,108" sap2010:WorkflowViewState.IdRef="ForEach`1_104" Values="[(New DirectoryInfo(instanta(&quot;FolderPrelucrate&quot;)).GetFileSystemInfos()).Concat(New DirectoryInfo(instanta(&quot;FolderErori&quot;)).GetFileSystemInfos())]">
                                <ui:ForEach.Body>
                                  <ActivityAction x:TypeArguments="si:FileSystemInfo">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="si:FileSystemInfo" Name="file" />
                                    </ActivityAction.Argument>
                                    <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="526,300" sap2010:WorkflowViewState.IdRef="Sequence_1531">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If Condition="[(DateTime.Now - file.CreationTime).TotalDays &gt; Convert.ToInt32(instanta(&quot;ZilePastrare&quot;))]" sap:VirtualizedContainerService.HintSize="484,208" sap2010:WorkflowViewState.IdRef="If_495">
                                        <sap:WorkflowViewStateService.ViewState>
                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                          </scg:Dictionary>
                                        </sap:WorkflowViewStateService.ViewState>
                                        <If.Then>
                                          <ui:Delete ContinueOnError="True" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Delete_19" Path="[file.FullName]" />
                                        </If.Then>
                                      </If>
                                    </Sequence>
                                  </ActivityAction>
                                </ui:ForEach.Body>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:ForEach>
                            </TryCatch.Try>
                            <TryCatch.Catches>
                              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,21" sap2010:WorkflowViewState.IdRef="Catch`1_267">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ActivityAction x:TypeArguments="s:Exception">
                                  <ActivityAction.Argument>
                                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                  </ActivityAction.Argument>
                                  <Sequence DisplayName="Logheaza eroarea" sap:VirtualizedContainerService.HintSize="526,1069" sap2010:WorkflowViewState.IdRef="Sequence_1535">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <If sap2010:Annotation.AnnotationText="Robotul noteaza eroarea in log si trimite email cu eroarea numai daca au trecut cel putin 12 ore de la ultimul email trimis, pentru a nu deranja" Condition="[instanta(&quot;Offline&quot;).StartsWith(&quot;nu&quot;) OR (instanta(&quot;Offline&quot;).StartsWith(&quot;da&quot;) AND (DateTime.Now - Convert.ToDateTime(instanta(&quot;OraUltimulEmail&quot;))).TotalHours &gt;= 12)]" DisplayName="Noteaza eroarea o data la x ore" sap:VirtualizedContainerService.HintSize="484,820" sap2010:WorkflowViewState.IdRef="If_735">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <If.Then>
                                        <Sequence sap:VirtualizedContainerService.HintSize="304,630" sap2010:WorkflowViewState.IdRef="Sequence_2220">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="AppendLine_209" Text="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot;] Eroare in procedura de Stergere fisiere vechi. Exception message: &quot;+exception.Message+&quot; at Source: &quot;+exception.Source]">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </ui:AppendLine>
                                          <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_441">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <TryCatch.Try>
                                              <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_447" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                                                <ui:BrowserScope.Body>
                                                  <ActivityAction x:TypeArguments="x:Object">
                                                    <ActivityAction.Argument>
                                                      <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                    </ActivityAction.Argument>
                                                    <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2388">
                                                      <sap:WorkflowViewStateService.ViewState>
                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        </scg:Dictionary>
                                                      </sap:WorkflowViewStateService.ViewState>
                                                      <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_101" />
                                                      <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1055" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                        <ui:TypeInto.Target>
                                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                        </ui:TypeInto.Target>
                                                      </ui:TypeInto>
                                                    </Sequence>
                                                  </ActivityAction>
                                                </ui:BrowserScope.Body>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:BrowserScope>
                                            </TryCatch.Try>
                                            <TryCatch.Catches>
                                              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_451">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ActivityAction x:TypeArguments="s:Exception">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                  </ActivityAction.Argument>
                                                  <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_428" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                                    <ui:OpenBrowser.Body>
                                                      <ActivityAction x:TypeArguments="x:Object">
                                                        <ActivityAction.Argument>
                                                          <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                                        </ActivityAction.Argument>
                                                        <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2389">
                                                          <sap:WorkflowViewStateService.ViewState>
                                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                            </scg:Dictionary>
                                                          </sap:WorkflowViewStateService.ViewState>
                                                          <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1056" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                                            <ui:TypeInto.Target>
                                                              <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                                            </ui:TypeInto.Target>
                                                          </ui:TypeInto>
                                                        </Sequence>
                                                      </ActivityAction>
                                                    </ui:OpenBrowser.Body>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:OpenBrowser>
                                                </ActivityAction>
                                              </Catch>
                                            </TryCatch.Catches>
                                          </TryCatch>
                                          <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="262,51" sap2010:WorkflowViewState.IdRef="TryCatch_493">
                                            <TryCatch.Try>
                                              <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_41" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '', '', '', '', 15, 'Eroare in procedura Stergere fisiere vechi. Exception message: &quot;+exception.Message.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot; at Source: &quot;+exception.Source.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                <ui:ExecuteNonQuery.Parameters>
                                                  <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                </ui:ExecuteNonQuery.Parameters>
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                              </ui:ExecuteNonQuery>
                                            </TryCatch.Try>
                                            <TryCatch.Catches>
                                              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_503">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <ActivityAction x:TypeArguments="s:Exception">
                                                  <ActivityAction.Argument>
                                                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                  </ActivityAction.Argument>
                                                </ActivityAction>
                                              </Catch>
                                            </TryCatch.Catches>
                                          </TryCatch>
                                          <If sap2010:Annotation.AnnotationText="Robotul trimite email cu eroarea administratorului numai in intervalul L-V 7:30-16" Condition="[DateTime.Now.DayOfWeek = DayOfWeek.Saturday OR DateTime.Now.DayOfWeek = DayOfWeek.Sunday OR DateTime.Now.TimeOfDay &lt; New TimeSpan(7, 30, 0) OR DateTime.Now.TimeOfDay &gt; New TimeSpan(16, 0, 0)]" DisplayName="Trimite email cu eroarea in zilele lucratoare" sap:VirtualizedContainerService.HintSize="262,123" sap2010:WorkflowViewState.IdRef="If_776">
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                            <If.Else>
                                              <TryCatch DisplayName="Trimite email cu eroarea" sap:VirtualizedContainerService.HintSize="434,282" sap2010:WorkflowViewState.IdRef="TryCatch_391">
                                                <sap:WorkflowViewStateService.ViewState>
                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                  </scg:Dictionary>
                                                </sap:WorkflowViewStateService.ViewState>
                                                <TryCatch.Try>
                                                  <ui:SendMail Bcc="{x:Null}" Cc="{x:Null}" Email="{x:Null}" MailMessage="{x:Null}" Password="{x:Null}" Body="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot;] Robot UiPath - Eroare in procedura Stergere fisiere vechi. Exception message: &quot;+exception.Message+&quot; at Source: &quot;+exception.Source]" DisplayName="Send SMTP Mail Message" EnableSSL="True" From="[instanta(&quot;EmailSenderRobot&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="SendMail_5" IsBodyHtml="False" Name="[instanta(&quot;EmailSenderRobot&quot;)]" Port="[cint(instanta(&quot;PortSmtp&quot;))]" SecureConnection="None" Server="[instanta(&quot;IPsmtp&quot;)]" Subject="[&quot;[&quot;+ instanta(&quot;NumeInstanta&quot;).ToUpper +&quot;] Robotul UiPath a intalnit o eroare&quot;]" TimeoutMS="3000" To="[instanta(&quot;DestinatariEmailEroare&quot;)]">
                                                    <ui:SendMail.Files>
                                                      <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                                                    </ui:SendMail.Files>
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                  </ui:SendMail>
                                                </TryCatch.Try>
                                                <TryCatch.Catches>
                                                  <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,120" sap2010:WorkflowViewState.IdRef="Catch`1_400">
                                                    <sap:WorkflowViewStateService.ViewState>
                                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                      </scg:Dictionary>
                                                    </sap:WorkflowViewStateService.ViewState>
                                                    <ActivityAction x:TypeArguments="s:Exception">
                                                      <ActivityAction.Argument>
                                                        <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                      </ActivityAction.Argument>
                                                      <TryCatch DisplayName="Trimite email cu eroarea" sap:VirtualizedContainerService.HintSize="434,297" sap2010:WorkflowViewState.IdRef="TryCatch_405">
                                                        <sap:WorkflowViewStateService.ViewState>
                                                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                          </scg:Dictionary>
                                                        </sap:WorkflowViewStateService.ViewState>
                                                        <TryCatch.Try>
                                                          <InvokeMethod DisplayName="Send email Invoke method" sap:VirtualizedContainerService.HintSize="218,132" sap2010:WorkflowViewState.IdRef="InvokeMethod_79" MethodName="Send">
                                                            <InvokeMethod.TargetObject>
                                                              <InArgument x:TypeArguments="snm:SmtpClient">[new SmtpClient(instanta("IPsmtp"), Convert.ToInt32(instanta("PortSmtp")))]</InArgument>
                                                            </InvokeMethod.TargetObject>
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <InArgument x:TypeArguments="x:String">[instanta("EmailSenderRobot")]</InArgument>
                                                            <InArgument x:TypeArguments="x:String">[instanta("DestinatariEmailEroare")]</InArgument>
                                                            <InArgument x:TypeArguments="x:String">Robotul UiPath a intalnit o eroare</InArgument>
                                                            <InArgument x:TypeArguments="x:String">["Robot UiPath - ["+instanta("NumeInstanta")+"] Eroare in procedura de Stergere fisiere vechi. Exception message: "+exception.Message+" at Source: "+exception.Source]</InArgument>
                                                          </InvokeMethod>
                                                        </TryCatch.Try>
                                                        <TryCatch.Catches>
                                                          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,135" sap2010:WorkflowViewState.IdRef="Catch`1_415">
                                                            <sap:WorkflowViewStateService.ViewState>
                                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                              </scg:Dictionary>
                                                            </sap:WorkflowViewStateService.ViewState>
                                                            <ActivityAction x:TypeArguments="s:Exception">
                                                              <ActivityAction.Argument>
                                                                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                              </ActivityAction.Argument>
                                                              <Sequence sap:VirtualizedContainerService.HintSize="242,234" sap2010:WorkflowViewState.IdRef="Sequence_2289">
                                                                <sap:WorkflowViewStateService.ViewState>
                                                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                  </scg:Dictionary>
                                                                </sap:WorkflowViewStateService.ViewState>
                                                                <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_304" Text="Nu am putut trimite e-mail cu eroarea" />
                                                                <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="434,266" sap2010:WorkflowViewState.IdRef="TryCatch_494">
                                                                  <TryCatch.Try>
                                                                    <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_52" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instanta(&quot;id&quot;)+&quot;', '&quot;+instanta(&quot;NumeInstanta&quot;)+&quot;', NOW(), '', '', '', '', 13, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                                                      <ui:ExecuteNonQuery.Parameters>
                                                                        <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                                                      </ui:ExecuteNonQuery.Parameters>
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                                                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                    </ui:ExecuteNonQuery>
                                                                  </TryCatch.Try>
                                                                  <TryCatch.Catches>
                                                                    <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_504">
                                                                      <sap:WorkflowViewStateService.ViewState>
                                                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                                                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                                                        </scg:Dictionary>
                                                                      </sap:WorkflowViewStateService.ViewState>
                                                                      <ActivityAction x:TypeArguments="s:Exception">
                                                                        <ActivityAction.Argument>
                                                                          <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                                                        </ActivityAction.Argument>
                                                                      </ActivityAction>
                                                                    </Catch>
                                                                  </TryCatch.Catches>
                                                                </TryCatch>
                                                              </Sequence>
                                                            </ActivityAction>
                                                          </Catch>
                                                        </TryCatch.Catches>
                                                      </TryCatch>
                                                    </ActivityAction>
                                                  </Catch>
                                                </TryCatch.Catches>
                                              </TryCatch>
                                            </If.Else>
                                          </If>
                                          <Assign sap2010:Annotation.AnnotationText="Noteaza in dictionar data si ora ultimului email trimis pentru instanta respectiva" DisplayName="Marcheaza ora ultimului email" sap:VirtualizedContainerService.HintSize="262,102" sap2010:WorkflowViewState.IdRef="Assign_1683">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("OraUltimulEmail")]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString]</InArgument>
                                            </Assign.Value>
                                            <sap:WorkflowViewStateService.ViewState>
                                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                              </scg:Dictionary>
                                            </sap:WorkflowViewStateService.ViewState>
                                          </Assign>
                                        </Sequence>
                                      </If.Then>
                                    </If>
                                    <Assign sap2010:Annotation.AnnotationText="Pentru a sari 5 min instanta, in variabila instanta(&quot;Offline&quot;) se noteaza data si ora erorii" DisplayName="Marcheaza ora instanta offline" sap:VirtualizedContainerService.HintSize="484,117" sap2010:WorkflowViewState.IdRef="Assign_1322">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("Offline")]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">["da=" + DateTime.Now.ToString]</InArgument>
                                      </Assign.Value>
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                    </Assign>
                                  </Sequence>
                                </ActivityAction>
                              </Catch>
                            </TryCatch.Catches>
                          </TryCatch>
                        </ActivityAction>
                      </ui:ForEach.Body>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:ForEach>
                    <ui:ForEach x:TypeArguments="si:FileSystemInfo" CurrentIndex="{x:Null}" DisplayName="Log nou daca logul &gt; 512 KB - For each" sap:VirtualizedContainerService.HintSize="307,200" sap2010:WorkflowViewState.IdRef="ForEach`1_106" Values="[New DirectoryInfo(Path.GetDirectoryName(ConfigGenerale(&quot;FisierLog&quot;))).GetFileSystemInfos(Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;)))]">
                      <ui:ForEach.Body>
                        <ActivityAction x:TypeArguments="si:FileSystemInfo">
                          <ActivityAction.Argument>
                            <DelegateInArgument x:TypeArguments="si:FileSystemInfo" Name="file" />
                          </ActivityAction.Argument>
                          <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="242,143" sap2010:WorkflowViewState.IdRef="Sequence_1537">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <If Condition="[new System.IO.FileInfo(file.FullName).Length &gt;= 524288]" sap:VirtualizedContainerService.HintSize="484,214" sap2010:WorkflowViewState.IdRef="If_497">
                              <If.Then>
                                <Sequence sap:VirtualizedContainerService.HintSize="242,325" sap2010:WorkflowViewState.IdRef="Sequence_1536">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:AppendLine DisplayName="Append in old log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_211" Text="[Environment.NewLine + &quot;Log inchis la &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;)]">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:AppendLine>
                                  <ui:MoveFile ContinueOnError="True" Destination="[Path.GetDirectoryName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;\&quot;+Path.GetFileNameWithoutExtension(ConfigGenerale(&quot;FisierLog&quot;))+&quot;_pana_la_&quot;+DateTime.Now.ToString(&quot;dd-MM-yyyy_HH-mm&quot;)+Path.GetExtension(ConfigGenerale(&quot;FisierLog&quot;))]" DisplayName="Rename file" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="MoveFile_114" Overwrite="True" Path="[file.FullName]" />
                                  <ui:AppendLine DisplayName="Append in new log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_212" Text="[&quot;Log deschis la &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + Environment.NewLine]">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:AppendLine>
                                </Sequence>
                              </If.Then>
                            </If>
                          </Sequence>
                        </ActivityAction>
                      </ui:ForEach.Body>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                    </ui:ForEach>
                  </Sequence>
                </If.Then>
              </If>
              <FlowStep.Next>
                <x:Reference>__ReferenceID60</x:Reference>
              </FlowStep.Next>
            </FlowStep>
          </FlowStep.Next>
        </FlowStep>
      </FlowStep.Next>
    </FlowStep>
    <FlowStep x:Name="__ReferenceID63" sap2010:WorkflowViewState.IdRef="FlowStep_1133">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <av:Point x:Key="ShapeLocation">351,145.04</av:Point>
          <av:Size x:Key="ShapeSize">200,123</av:Size>
          <av:PointCollection x:Key="ConnectorLocation">451,268.04 451,346.04</av:PointCollection>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <TryCatch sap2010:Annotation.AnnotationText="Procedura in care robotul incarca setarile din baza de date si se logheaza in Ecris-urile instantelor" DisplayName="Initializare" sap:VirtualizedContainerService.HintSize="200,123" sap2010:WorkflowViewState.IdRef="TryCatch_219">
        <TryCatch.Variables>
          <Variable x:TypeArguments="scg:Dictionary(x:String, x:String)" Name="instantaExc" />
        </TryCatch.Variables>
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
        <TryCatch.Try>
          <Sequence DisplayName="Initializare" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_1371">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                <x:Boolean x:Key="IsPinned">False</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" sap2010:Annotation.AnnotationText="Robotul apeleaza un workflow separat care incarca setarile in baza de date si le pune la dispozitie astfel: dictionarul ConfigGenerale pentru setarile generale ale robotului si array-ul de dictionare ConfigInstanta, in care fiecare element din array corespunde unei instante si contine un dictionar cu setarile respectivei instante." DisplayName="Initializeaza setari" sap:VirtualizedContainerService.HintSize="200,243" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_5" UnSafe="False" WorkflowFileName="InitSetariMultiple.xaml">
              <ui:InvokeWorkflowFile.Arguments>
                <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:String)[]" x:Key="out_Config">[ConfigInstante]</OutArgument>
                <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" x:Key="out_ConfigGenerale">[ConfigGenerale]</OutArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_InterogareSetariInstanta">SELECT * FROM `setari_instanta_citatii` WHERE `InstantaActiva`='da'</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_InterogareSetariGenerale">SELECT * FROM `setari_generale_citatii`</InArgument>
                <InArgument x:TypeArguments="x:String" x:Key="in_StringConectareMySQL">Dsn=roboti_mysql</InArgument>
              </ui:InvokeWorkflowFile.Arguments>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:InvokeWorkflowFile>
            <ui:AppendLine sap2010:Annotation.AnnotationText="Noteaza initializarea in fisierul jurnal. Robotul tine jurnalul in paralel in fisierul text si in baza de date." DisplayName="Noteaza initializarea in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,123" sap2010:WorkflowViewState.IdRef="AppendLine_179" Text="[Environment.NewLine + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot; Initializare&quot;]">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:AppendLine>
            <TryCatch sap2010:Annotation.AnnotationText="Noteaza initializarea in baza de date." DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,93" sap2010:WorkflowViewState.IdRef="TryCatch_479">
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
              <TryCatch.Try>
                <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_1" ProviderName="System.Data.Odbc" Sql="INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('0', 'Initializare', NOW(), '', '', '', '', 16, '');" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                  <ui:ExecuteNonQuery.Parameters>
                    <scg:Dictionary x:TypeArguments="x:String, Argument" />
                  </ui:ExecuteNonQuery.Parameters>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                </ui:ExecuteNonQuery>
              </TryCatch.Try>
              <TryCatch.Catches>
                <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_489">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                      <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <ActivityAction x:TypeArguments="s:Exception">
                    <ActivityAction.Argument>
                      <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                    </ActivityAction.Argument>
                  </ActivityAction>
                </Catch>
              </TryCatch.Catches>
            </TryCatch>
            <ui:ForEach x:TypeArguments="sd:Process" CurrentIndex="{x:Null}" sap2010:Annotation.AnnotationText="Robotul face curatenie dupa eventualele erori fatale anterioare si inchide toate procesele Chrome. Atentie la ferestrele pe care le aveti deschise. Robotul nu interactioneaza cu Internet Explorer sau cu alt browser.&#xA;" DisplayName="Inchide procesele Chrome" sap:VirtualizedContainerService.HintSize="200,198" sap2010:WorkflowViewState.IdRef="ForEach`1_88" Values="[System.Diagnostics.Process.GetProcesses()]">
              <ui:ForEach.Body>
                <ActivityAction x:TypeArguments="sd:Process">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="sd:Process" Name="process" />
                  </ActivityAction.Argument>
                  <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="486,332" sap2010:WorkflowViewState.IdRef="Sequence_1366">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <If Condition="[process.ProcessName.ToLower.Contains(&quot;chrome&quot;)]" sap:VirtualizedContainerService.HintSize="464,208" sap2010:WorkflowViewState.IdRef="If_430">
                      <If.Then>
                        <ui:KillProcess ProcessName="{x:Null}" ContinueOnError="True" DisplayName="Kill Process" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="KillProcess_29" Process="[process]" />
                      </If.Then>
                    </If>
                  </Sequence>
                </ActivityAction>
              </ui:ForEach.Body>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:ForEach>
            <ui:ForEach x:TypeArguments="scg:Dictionary(x:String, x:String)" CurrentIndex="{x:Null}" DisplayName="Initializeaza fiecare instanta" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ForEach`1_123" Values="[ConfigInstante]">
              <ui:ForEach.Body>
                <ActivityAction x:TypeArguments="scg:Dictionary(x:String, x:String)">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="scg:Dictionary(x:String, x:String)" Name="instanta" />
                  </ActivityAction.Argument>
                  <Sequence DisplayName="Initializeaza instanta" sap:VirtualizedContainerService.HintSize="242,264" sap2010:WorkflowViewState.IdRef="Sequence_2204">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Sequence DisplayName="Pregatiri in caz de eroare" sap:VirtualizedContainerService.HintSize="200,66" sap2010:WorkflowViewState.IdRef="Sequence_2200">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign sap2010:Annotation.AnnotationText="Noteaza numele instantei care este la rand si care ar putea provoca erori" DisplayName="Assign" sap:VirtualizedContainerService.HintSize="262,102" sap2010:WorkflowViewState.IdRef="Assign_1658">
                        <Assign.To>
                          <OutArgument x:TypeArguments="scg:Dictionary(x:String, x:String)">[instantaExc]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="scg:Dictionary(x:String, x:String)">[instanta]</InArgument>
                        </Assign.Value>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </Assign>
                      <Assign sap2010:Annotation.AnnotationText="Marcheaza instanta ca nemaifiind offline pana acum" sap:VirtualizedContainerService.HintSize="262,102" sap2010:WorkflowViewState.IdRef="Assign_1659">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("Offline")]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">["nu="+DateTime.Now.ToString]</InArgument>
                        </Assign.Value>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </Assign>
                      <Assign sap2010:Annotation.AnnotationText="Initializeaza cu data ultimului email trimis administratorului (valoare de initializare)" sap:VirtualizedContainerService.HintSize="262,102" sap2010:WorkflowViewState.IdRef="Assign_1660">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[ConfigInstante(Array.IndexOf(ConfigInstante, instanta))("OraUltimulEmail")]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">1/1/2019 00:00:00</InArgument>
                        </Assign.Value>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </Assign>
                    </Sequence>
                    <Sequence DisplayName="Login Ecris" sap:VirtualizedContainerService.HintSize="526,439" sap2010:WorkflowViewState.IdRef="Sequence_2203">
                      <Sequence.Variables>
                        <Variable x:TypeArguments="x:Boolean" Name="elementExists" />
                      </Sequence.Variables>
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                          <x:Boolean x:Key="IsPinned">False</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:UiElementExists DisplayName="Element Exists - check browser is open" Exists="[elementExists]" sap:VirtualizedContainerService.HintSize="484,51" sap2010:WorkflowViewState.IdRef="UiElementExists_134">
                        <ui:UiElementExists.Target>
                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="d2d3a449290d82e8f55c472d5b5def0c" Selector="&lt;html app='chrome.exe' /&gt;" TimeoutMS="1000" WaitForReady="INTERACTIVE" />
                        </ui:UiElementExists.Target>
                      </ui:UiElementExists>
                      <If Condition="[elementExists]" DisplayName="Daca browser is open" sap:VirtualizedContainerService.HintSize="484,256" sap2010:WorkflowViewState.IdRef="If_730">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            <x:Boolean x:Key="IsPinned">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <If.Then>
                          <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" sap2010:Annotation.AnnotationText="Daca Chrome este deschis, se ataseaza la fereastra si introduce URL Ecris" BrowserType="Chrome" ContinueOnError="True" DisplayName="Login Ecris - Attach Browser 'chrome.exe ECRIS'" sap:VirtualizedContainerService.HintSize="200,108" sap2010:WorkflowViewState.IdRef="BrowserScope_392" InformativeScreenshot="fa34b6cd81728ac7374bb60742a6a110" Selector="&lt;html app='chrome.exe' omit:title='ECRIS*' /&gt;" TimeoutMS="6000">
                            <ui:BrowserScope.Body>
                              <ActivityAction x:TypeArguments="x:Object">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="242,723" sap2010:WorkflowViewState.IdRef="Sequence_2201">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:NavigateTo Browser="{x:Null}" ContinueOnError="True" DisplayName="Navigate to" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="NavigateTo_110" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]" />
                                  <ui:UiElementExists Exists="{x:Null}" sap2010:Annotation.AnnotationText="Acorda timp de asteptare in situatiile in care pagina Ecris se incarca greu" DisplayName="Element Exists 'INPUT  utilizator''" sap:VirtualizedContainerService.HintSize="200,108" sap2010:WorkflowViewState.IdRef="UiElementExists_135">
                                    <ui:UiElementExists.Target>
                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                    </ui:UiElementExists.Target>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:UiElementExists>
                                  <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" sap2010:Annotation.AnnotationText="Introduce numele de utilizator. Pentru majoritatea interactiunilor cu  browserul robotul foloseste injectie de Javascript." ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into 'INPUT  utilizator'" EmptyField="True" sap:VirtualizedContainerService.HintSize="200,138" sap2010:WorkflowViewState.IdRef="TypeInto_934" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;UsernameEcris&quot;)]">
                                    <ui:TypeInto.Target>
                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                    </ui:TypeInto.Target>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:TypeInto>
                                  <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type Into" EmptyField="True" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TypeInto_935" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;PasswordEcris&quot;)]">
                                    <ui:TypeInto.Target>
                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="fca13b00c3148899b8eb6f9bb5589b8d" Selector="&lt;webctrl id='parola' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                    </ui:TypeInto.Target>
                                  </ui:TypeInto>
                                  <ui:Click DelayBefore="{x:Null}" sap2010:Annotation.AnnotationText="Robotul acorda timp dupa apasarea butonului pentru paginile care se incarca mai greu" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayMS="2500" DisplayName="Click 'INPUT'" sap:VirtualizedContainerService.HintSize="200,123" sap2010:WorkflowViewState.IdRef="Click_531" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                    <ui:Click.CursorPosition>
                                      <ui:CursorPosition OffsetX="37" OffsetY="11" Position="TopLeft" />
                                    </ui:Click.CursorPosition>
                                    <ui:Click.Target>
                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="1ca5daac6a8c7a1ea0399caf19fc7557" Selector="&lt;webctrl name='Intra' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                    </ui:Click.Target>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:Click>
                                </Sequence>
                              </ActivityAction>
                            </ui:BrowserScope.Body>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:BrowserScope>
                        </If.Then>
                        <If.Else>
                          <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" sap2010:Annotation.AnnotationText="Daca browserul nu e deschis, il deschide si introduce URL Ecris." BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser Ecris" Hidden="False" sap:VirtualizedContainerService.HintSize="434,614" sap2010:WorkflowViewState.IdRef="OpenBrowser_377" NewSession="False" Private="True" Url="[&quot;http://&quot;+instanta(&quot;IPecris&quot;)+&quot;/ecris_cdms/&quot;]">
                            <ui:OpenBrowser.Body>
                              <ActivityAction x:TypeArguments="x:Object">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="242,488" sap2010:WorkflowViewState.IdRef="Sequence_2202">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:UiElementExists Exists="{x:Null}" DisplayName="Element Exists 'INPUT  utilizator''" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="UiElementExists_136">
                                    <ui:UiElementExists.Target>
                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="15000" WaitForReady="COMPLETE" />
                                    </ui:UiElementExists.Target>
                                  </ui:UiElementExists>
                                  <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into 'INPUT  utilizator'" EmptyField="True" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TypeInto_936" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;UsernameEcris&quot;)]">
                                    <ui:TypeInto.Target>
                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="a3bbc7a01423fcc2156b35b1e19df55e" Selector="&lt;webctrl id='utilizator' tag='INPUT' /&gt;" TimeoutMS="2000" WaitForReady="COMPLETE" />
                                    </ui:TypeInto.Target>
                                  </ui:TypeInto>
                                  <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type Into" EmptyField="True" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TypeInto_937" SendWindowMessages="False" SimulateType="True" Text="[instanta(&quot;PasswordEcris&quot;)]">
                                    <ui:TypeInto.Target>
                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="fca13b00c3148899b8eb6f9bb5589b8d" Selector="&lt;webctrl id='parola' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                    </ui:TypeInto.Target>
                                  </ui:TypeInto>
                                  <ui:Click DelayBefore="{x:Null}" sap2010:Annotation.AnnotationText="Robotul acorda timp dupa apasarea butonului pentru paginile care se incarca mai greu" ClickType="CLICK_SINGLE" ContinueOnError="True" DelayMS="2500" DisplayName="Click 'INPUT'" sap:VirtualizedContainerService.HintSize="200,123" sap2010:WorkflowViewState.IdRef="Click_532" KeyModifiers="None" MouseButton="BTN_LEFT" SendWindowMessages="False" SimulateClick="True">
                                    <ui:Click.CursorPosition>
                                      <ui:CursorPosition OffsetX="37" OffsetY="11" Position="TopLeft" />
                                    </ui:Click.CursorPosition>
                                    <ui:Click.Target>
                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" InformativeScreenshot="1ca5daac6a8c7a1ea0399caf19fc7557" Selector="&lt;webctrl name='Intra' tag='INPUT' /&gt;" TimeoutMS="1000" WaitForReady="COMPLETE" />
                                    </ui:Click.Target>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                  </ui:Click>
                                </Sequence>
                              </ActivityAction>
                            </ui:OpenBrowser.Body>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:OpenBrowser>
                        </If.Else>
                      </If>
                    </Sequence>
                  </Sequence>
                </ActivityAction>
              </ui:ForEach.Body>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:ForEach>
            <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" sap2010:Annotation.AnnotationText="Robotul deschide fisierul log intr-o pagina speciala Chrome si simuleaza tasta End pentru a ajunge la linia cea mai recenta din log" BrowserType="Chrome" DisplayName="Open log window" Hidden="False" sap:VirtualizedContainerService.HintSize="200,138" sap2010:WorkflowViewState.IdRef="OpenBrowser_214" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
              <ui:OpenBrowser.Body>
                <ActivityAction x:TypeArguments="x:Object">
                  <ActivityAction.Argument>
                    <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                  </ActivityAction.Argument>
                  <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="242,143" sap2010:WorkflowViewState.IdRef="Sequence_1370">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">True</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TypeInto_541" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                      <ui:TypeInto.Target>
                        <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" WaitForReady="COMPLETE">
                          <ui:Target.TimeoutMS>
                            <InArgument x:TypeArguments="x:Int32" />
                          </ui:Target.TimeoutMS>
                        </ui:Target>
                      </ui:TypeInto.Target>
                    </ui:TypeInto>
                  </Sequence>
                </ActivityAction>
              </ui:OpenBrowser.Body>
              <sap:WorkflowViewStateService.ViewState>
                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                  <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                  <x:Boolean x:Key="IsPinned">False</x:Boolean>
                  <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                </scg:Dictionary>
              </sap:WorkflowViewStateService.ViewState>
            </ui:OpenBrowser>
          </Sequence>
        </TryCatch.Try>
        <TryCatch.Catches>
          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,237" sap2010:WorkflowViewState.IdRef="Catch`1_228">
            <sap:WorkflowViewStateService.ViewState>
              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                <x:Boolean x:Key="IsPinned">True</x:Boolean>
              </scg:Dictionary>
            </sap:WorkflowViewStateService.ViewState>
            <ActivityAction x:TypeArguments="s:Exception">
              <ActivityAction.Argument>
                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
              </ActivityAction.Argument>
              <Sequence sap2010:Annotation.AnnotationText="Robotul noteaza motivul erorii. Robotul procedeaza diferit in functie de cum eroarea intervenit inainte de incarcarea vreunei instante sau dupa" DisplayName="Logheaza eroarea" sap:VirtualizedContainerService.HintSize="571,770" sap2010:WorkflowViewState.IdRef="Sequence_1375">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <If Condition="[IsNothing(instantaExc(&quot;NumeInstanta&quot;))]" DisplayName="Daca eroarea provine de la incarcarea vreunei instante" sap:VirtualizedContainerService.HintSize="529,636" sap2010:WorkflowViewState.IdRef="If_729">
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                      <x:Boolean x:Key="IsPinned">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <If.Then>
                    <Sequence DisplayName="Daca nu" sap:VirtualizedContainerService.HintSize="242,397" sap2010:WorkflowViewState.IdRef="Sequence_2195">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_281" Text="[&quot;[&quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] Eroare in procedura de Initializare. Exception message: &quot;+exception.Message+&quot; at Source: &quot;+exception.Source]">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:AppendLine>
                      <TryCatch sap2010:Annotation.AnnotationText="Face refresh la pagina Chrome cu jurnalul pentru a se vedea pe ecran ultima intrare introdusa" DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,123" sap2010:WorkflowViewState.IdRef="TryCatch_422">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <TryCatch.Try>
                          <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_428" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                            <ui:BrowserScope.Body>
                              <ActivityAction x:TypeArguments="x:Object">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2350">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_82" />
                                  <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1017" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                    <ui:TypeInto.Target>
                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                    </ui:TypeInto.Target>
                                  </ui:TypeInto>
                                </Sequence>
                              </ActivityAction>
                            </ui:BrowserScope.Body>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:BrowserScope>
                        </TryCatch.Try>
                        <TryCatch.Catches>
                          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_432">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ActivityAction x:TypeArguments="s:Exception">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                              </ActivityAction.Argument>
                              <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_409" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                <ui:OpenBrowser.Body>
                                  <ActivityAction x:TypeArguments="x:Object">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                    </ActivityAction.Argument>
                                    <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2351">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1018" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                        <ui:TypeInto.Target>
                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                        </ui:TypeInto.Target>
                                      </ui:TypeInto>
                                    </Sequence>
                                  </ActivityAction>
                                </ui:OpenBrowser.Body>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:OpenBrowser>
                            </ActivityAction>
                          </Catch>
                        </TryCatch.Catches>
                      </TryCatch>
                      <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_480">
                        <TryCatch.Try>
                          <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_2" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('0', 'Initializare', NOW(), '', '', '', '', 15, 'Eroare in procedura de Initializare. Exception message: &quot;+exception.Message.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot; at Source: &quot;+exception.Source.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                            <ui:ExecuteNonQuery.Parameters>
                              <scg:Dictionary x:TypeArguments="x:String, Argument" />
                            </ui:ExecuteNonQuery.Parameters>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:ExecuteNonQuery>
                        </TryCatch.Try>
                        <TryCatch.Catches>
                          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_490">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ActivityAction x:TypeArguments="s:Exception">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                              </ActivityAction.Argument>
                            </ActivityAction>
                          </Catch>
                        </TryCatch.Catches>
                      </TryCatch>
                    </Sequence>
                  </If.Then>
                  <If.Else>
                    <Sequence DisplayName="Daca da" sap:VirtualizedContainerService.HintSize="242,488" sap2010:WorkflowViewState.IdRef="Sequence_2199">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          <x:Boolean x:Key="IsPinned">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_282" Text="[&quot;[&quot;+ instantaExc(&quot;NumeInstanta&quot;).ToUpper +&quot; &quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy HH:mm:ss&quot;) + &quot;] Eroare in procedura de Initializare. Exception message: &quot;+exception.Message+&quot; at Source: &quot;+exception.Source]">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                      </ui:AppendLine>
                      <TryCatch DisplayName="Refresh log window" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_423">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <TryCatch.Try>
                          <ui:BrowserScope Browser="{x:Null}" SearchScope="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" DisplayName="Attach Browser 'chrome.exe'" sap:VirtualizedContainerService.HintSize="414,428" sap2010:WorkflowViewState.IdRef="BrowserScope_429" InformativeScreenshot="96fcafc8a0c95e11a03460280114461c" Selector="[&quot;&lt;html app='chrome.exe' title='&quot;+Path.GetFileName(ConfigGenerale(&quot;FisierLog&quot;))+&quot;' /&gt;&quot;]" TimeoutMS="3000">
                            <ui:BrowserScope.Body>
                              <ActivityAction x:TypeArguments="x:Object">
                                <ActivityAction.Argument>
                                  <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                </ActivityAction.Argument>
                                <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,282" sap2010:WorkflowViewState.IdRef="Sequence_2352">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <ui:RefreshBrowser Browser="{x:Null}" ContinueOnError="True" DisplayName="Refresh Browser" sap:VirtualizedContainerService.HintSize="314,22" sap2010:WorkflowViewState.IdRef="RefreshBrowser_83" />
                                  <ui:TypeInto DelayBefore="{x:Null}" DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1019" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                    <ui:TypeInto.Target>
                                      <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                    </ui:TypeInto.Target>
                                  </ui:TypeInto>
                                </Sequence>
                              </ActivityAction>
                            </ui:BrowserScope.Body>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:BrowserScope>
                        </TryCatch.Try>
                        <TryCatch.Catches>
                          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="404,21" sap2010:WorkflowViewState.IdRef="Catch`1_433">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ActivityAction x:TypeArguments="s:Exception">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                              </ActivityAction.Argument>
                              <ui:OpenBrowser CommunicationMethod="{x:Null}" UiBrowser="{x:Null}" BrowserType="Chrome" ContinueOnError="True" DisplayName="Open browser" Hidden="False" sap:VirtualizedContainerService.HintSize="414,51" sap2010:WorkflowViewState.IdRef="OpenBrowser_410" NewSession="True" Private="False" Url="[&quot;--chrome-frame --app=file:///&quot;+ConfigGenerale(&quot;FisierLog&quot;).Replace(&quot;\&quot;, &quot;/&quot;)]">
                                <ui:OpenBrowser.Body>
                                  <ActivityAction x:TypeArguments="x:Object">
                                    <ActivityAction.Argument>
                                      <DelegateInArgument x:TypeArguments="x:Object" Name="ContextTarget" />
                                    </ActivityAction.Argument>
                                    <Sequence DisplayName="Do" sap:VirtualizedContainerService.HintSize="336,220" sap2010:WorkflowViewState.IdRef="Sequence_2353">
                                      <sap:WorkflowViewStateService.ViewState>
                                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                        </scg:Dictionary>
                                      </sap:WorkflowViewStateService.ViewState>
                                      <ui:TypeInto DelayBetweenKeys="{x:Null}" DelayMS="{x:Null}" Activate="True" ClickBeforeTyping="False" ContinueOnError="True" DelayBefore="1200" DisplayName="Type into" EmptyField="False" sap:VirtualizedContainerService.HintSize="314,96" sap2010:WorkflowViewState.IdRef="TypeInto_1020" SendWindowMessages="True" SimulateType="False" Text="%[k(end)]">
                                        <ui:TypeInto.Target>
                                          <ui:Target ClippingRegion="{x:Null}" Element="{x:Null}" Selector="{x:Null}" TimeoutMS="10000" WaitForReady="COMPLETE" />
                                        </ui:TypeInto.Target>
                                      </ui:TypeInto>
                                    </Sequence>
                                  </ActivityAction>
                                </ui:OpenBrowser.Body>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:OpenBrowser>
                            </ActivityAction>
                          </Catch>
                        </TryCatch.Catches>
                      </TryCatch>
                      <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="TryCatch_481">
                        <TryCatch.Try>
                          <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_3" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instantaExc(&quot;id&quot;)+&quot;', '&quot;+instantaExc(&quot;NumeInstanta&quot;)+&quot;', NOW(), '', '', '', '', 15, 'Eroare in procedura de Initializare. Exception message: &quot;+exception.Message.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot; at Source: &quot;+exception.Source.Replace(&quot;\&quot;, &quot;\\&quot;)+&quot;');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                            <ui:ExecuteNonQuery.Parameters>
                              <scg:Dictionary x:TypeArguments="x:String, Argument" />
                            </ui:ExecuteNonQuery.Parameters>
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                          </ui:ExecuteNonQuery>
                        </TryCatch.Try>
                        <TryCatch.Catches>
                          <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_491">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <ActivityAction x:TypeArguments="s:Exception">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                              </ActivityAction.Argument>
                            </ActivityAction>
                          </Catch>
                        </TryCatch.Catches>
                      </TryCatch>
                      <If sap2010:Annotation.AnnotationText="Robotul trimite email cu eroarea administratorului numai in intervalul L-V 7:30-16" Condition="[DateTime.Now.DayOfWeek = DayOfWeek.Saturday OR DateTime.Now.DayOfWeek = DayOfWeek.Sunday OR DateTime.Now.TimeOfDay &lt; New TimeSpan(7, 30, 0) OR DateTime.Now.TimeOfDay &gt; New TimeSpan(16, 0, 0)]" DisplayName="Trimite email cu eroarea in zilele lucratoare" sap:VirtualizedContainerService.HintSize="579,472" sap2010:WorkflowViewState.IdRef="If_772">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsPinned">False</x:Boolean>
                            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <If.Else>
                          <TryCatch DisplayName="Trimite email cu eroarea" sap:VirtualizedContainerService.HintSize="434,297" sap2010:WorkflowViewState.IdRef="TryCatch_403">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">True</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <TryCatch.Try>
                              <ui:SendMail Bcc="{x:Null}" Cc="{x:Null}" Email="{x:Null}" MailMessage="{x:Null}" Password="{x:Null}" sap2010:Annotation.AnnotationText="Trimite email cu detaliile exceptiei, inclusiv mesajul exceptiei" Body="[&quot;[&quot;+ instantaExc(&quot;NumeInstanta&quot;).ToUpper +&quot;] Robot UiPath - Eroare in procedura de Initializare. Exception message: &quot;+exception.Message+&quot; at Source: &quot;+exception.Source]" DisplayName="Send SMTP Mail Message" EnableSSL="True" From="[instantaExc(&quot;EmailSenderRobot&quot;)]" sap:VirtualizedContainerService.HintSize="200,108" sap2010:WorkflowViewState.IdRef="SendMail_1" IsBodyHtml="False" Name="[instantaExc(&quot;EmailSenderRobot&quot;)]" Port="[cint(instantaExc(&quot;PortSmtp&quot;))]" SecureConnection="None" Server="[instantaExc(&quot;IPsmtp&quot;)]" Subject="[&quot;[&quot;+ instantaExc(&quot;NumeInstanta&quot;).ToUpper +&quot;] Robotul UiPath a intalnit o eroare&quot;]" TimeoutMS="3000" To="[instantaExc(&quot;DestinatariEmailEroare&quot;)]">
                                <ui:SendMail.Files>
                                  <scg:List x:TypeArguments="InArgument(x:String)" Capacity="0" />
                                </ui:SendMail.Files>
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                              </ui:SendMail>
                            </TryCatch.Try>
                            <TryCatch.Catches>
                              <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,135" sap2010:WorkflowViewState.IdRef="Catch`1_412">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ActivityAction x:TypeArguments="s:Exception">
                                  <ActivityAction.Argument>
                                    <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                  </ActivityAction.Argument>
                                  <Sequence sap:VirtualizedContainerService.HintSize="242,234" sap2010:WorkflowViewState.IdRef="Sequence_2285">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <ui:AppendLine DisplayName="Append in log" FileName="[ConfigGenerale(&quot;FisierLog&quot;)]" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="AppendLine_300" Text="Nu am putut trimite e-mail cu eroarea" />
                                    <TryCatch DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="434,266" sap2010:WorkflowViewState.IdRef="TryCatch_482">
                                      <TryCatch.Try>
                                        <ui:ExecuteNonQuery AffectedRecords="{x:Null}" ExistingDbConnection="{x:Null}" CommandType="Text" ContinueOnError="True" DisplayName="Log in database" sap:VirtualizedContainerService.HintSize="200,51" sap2010:WorkflowViewState.IdRef="ExecuteNonQuery_48" ProviderName="System.Data.Odbc" Sql="[&quot;INSERT INTO `log_robot_citatii` (`id_instanta`, `nume_instanta`, `timestamp`, `nume_fisier`, `numar_dosar`, `id_dosar`, `id_document`, `id_eroare`, `mesaj_special`) VALUES ('&quot;+instantaExc(&quot;id&quot;)+&quot;', '&quot;+instantaExc(&quot;NumeInstanta&quot;)+&quot;', NOW(), '', '', '', '', 13, '');&quot;]" TimeoutMS="1000" ConnectionString="Dsn=roboti_mysql">
                                          <ui:ExecuteNonQuery.Parameters>
                                            <scg:Dictionary x:TypeArguments="x:String, Argument" />
                                          </ui:ExecuteNonQuery.Parameters>
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">False</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                        </ui:ExecuteNonQuery>
                                      </TryCatch.Try>
                                      <TryCatch.Catches>
                                        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="400,104" sap2010:WorkflowViewState.IdRef="Catch`1_492">
                                          <sap:WorkflowViewStateService.ViewState>
                                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                              <x:Boolean x:Key="IsPinned">True</x:Boolean>
                                            </scg:Dictionary>
                                          </sap:WorkflowViewStateService.ViewState>
                                          <ActivityAction x:TypeArguments="s:Exception">
                                            <ActivityAction.Argument>
                                              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
                                            </ActivityAction.Argument>
                                          </ActivityAction>
                                        </Catch>
                                      </TryCatch.Catches>
                                    </TryCatch>
                                  </Sequence>
                                </ActivityAction>
                              </Catch>
                            </TryCatch.Catches>
                          </TryCatch>
                        </If.Else>
                      </If>
                    </Sequence>
                  </If.Else>
                </If>
              </Sequence>
            </ActivityAction>
          </Catch>
        </TryCatch.Catches>
      </TryCatch>
      <FlowStep.Next>
        <x:Reference>__ReferenceID60</x:Reference>
      </FlowStep.Next>
    </FlowStep>
    <x:Reference>__ReferenceID61</x:Reference>
    <x:Reference>__ReferenceID62</x:Reference>
  </Flowchart>
</Activity>